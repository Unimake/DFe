/*! 28.0.2.0 */
/*! VersionVI: 01F280095g   */
function WDBarreBouton(n,t,i,r){if(arguments.length){this.m_oObjetParent=n;this.m_oBouton=t;this.m_sCommande=i;this.m_oParamCommande=r;var u=this;this.m_oBouton.onmouseover=function(n){u.OnMouseOver(n||event)};this.m_oBouton.onmouseout=function(n){u.OnMouseOut(n||event)};this.m_oBouton.onclick=function(n){u.OnClick(n||event)}}}function WDBarreBoutonOnOff(){arguments.length&&WDBarreBouton.prototype.constructor.apply(this,arguments)}function WDBarreBoutonPopup(n,t,i,r,u){var f;if(arguments.length){WDBarreBouton.prototype.constructor.apply(this,[n,t,i,r]);this.m_oPopup=u;f=this;this.m_oBouton.getElementsByTagName(n.ms_tagBoutonClic)[0].onclick=function(n){f.OnClick(n||event)};for(var s=function(n){return f.OnClickP(n||event),clWDUtil.bStopPropagation(n)},h=f.OnMouseEnter?function(n){return f.OnMouseEnter(n||event),clWDUtil.bStopPropagation(n)}:undefined,c=f.OnMouseLeave?function(n){return f.OnMouseLeave(n||event),clWDUtil.bStopPropagation(n)}:undefined,o=this.m_oPopup.getElementsByTagName("td"),l=o.length,e=0;e<l;e++)o[e].onmousedown=s,o[e].onmouseenter=h,o[e].onmouseleave=c;this.m_bSurvol=!1;this.m_pfMouseOutSimule=function(){f.OnMouseOut(bIE?{toElement:null}:{relatedTarget:null})};this.m_tabZIndex=[]}}function WDBarreBoutonPopupMenu(n,t,i,r,u){var f,o;if(arguments.length){WDBarreBoutonPopup.prototype.constructor.apply(this,[n,t,i,null,r]);this.m_tabOptions=u;for(var h=this,l=function(n){h.OnMouseOverMenu(n||event)},a=function(n){h.OnMouseOutMenu(n||event)},v=this.m_tabOptions.length,e=0;e<v;e++){var c=document.createElement("span"),s=this.m_tabOptions[e].sTexte,y=document.createTextNode(s);c.appendChild(y);f=this.m_tabOptions[e].oTD;f.appendChild(c);f.noWrap="true";f.onmouseover=l;f.onmouseout=a;o=f.getElementsByTagName(n.ms_tagBoutonClic)[0];o&&(o.alt=s,o.title=s)}}}function WDBarreBoutonPopupMenuS(){arguments.length&&WDBarreBoutonPopupMenu.prototype.constructor.apply(this,arguments)}function WDBarre(n,t,i,r,u){if(arguments.length){WDChampParametresHote.prototype.constructor.apply(this,arguments);var f=u[2],e=u[3],o=u[4],s=u[5];this.m_eModeBarre=f;this.m_tabCouleurFond=[];this.m_tabCouleurFond[WDBarreBouton.prototype.ms_eEtatNormal]="";this.m_tabCouleurFond[WDBarreBouton.prototype.ms_eEtatSurvol]=e;this.m_tabCouleurFond[WDBarreBouton.prototype.ms_eEtatActif]=o;this.m_tabBoutonsInfo=s;this.m_tabElementRacineDisplay=[]}}WDBarreBouton.prototype.ms_eEtatNormal=0;WDBarreBouton.prototype.ms_eEtatSurvol=1;WDBarreBouton.prototype.ms_eEtatActif=2;WDBarreBouton.prototype.vPrePlaceBarre=clWDUtil.m_pfVide;WDBarreBouton.prototype.vPostPlaceBarre=clWDUtil.m_pfVide;WDBarreBouton.prototype.OnMouseOver=function(n){this.m_bSurvol=!0;this.RafEtatSimple(n)};WDBarreBouton.prototype.OnMouseOut=function(n){delete this.m_bSurvol;this.RafEtatSimple(n)};WDBarreBouton.prototype.OnClick=function(n){this.ExecuteCommande(n)};WDBarreBouton.prototype.ExecuteCommande=function(n){this.m_oObjetParent[this.m_sCommande]&&this.m_oObjetParent[this.m_sCommande](n,this.m_oParamCommande)};WDBarreBouton.prototype.RafEtatSimple=function(n){this.RafEtat(n,this.m_oObjetParent.oGetParamEtat(n,!1))};WDBarreBouton.prototype.RafEtat=function(n,t){var i=this.__eGetEtatSurvol(this.m_bSurvol);i=this._veGetEtatSpecifique(n,i,t);this.__DessineEtat(i,this,this.m_oBouton,t)};WDBarreBouton.prototype.__eGetEtatSurvol=function(n){return n?this.ms_eEtatSurvol:this.ms_eEtatNormal};WDBarreBouton.prototype.__DessineEtat=function(n,t,i){n!=t.m_eEtat&&(n!=this.ms_eEtatNormal?t.m_eEtat=n:delete t.m_eEtat,i.style.backgroundColor=this.m_oObjetParent.sGetCouleurFond(n))};WDBarreBouton.prototype._veGetEtatSpecifique=function(n,t){return t};WDBarreBoutonOnOff.prototype=new WDBarreBouton;WDBarreBoutonOnOff.prototype.constructor=WDBarreBoutonOnOff;WDBarreBoutonOnOff.prototype._veGetEtatSpecifique=function(n,t,i){return this.bActif(n,i)?this.ms_eEtatActif:WDBarreBouton.prototype._veGetEtatSpecifique.apply(this,arguments)};WDBarreBoutonOnOff.prototype.bEtatSurcharge=function(){return!1};WDBarreBoutonPopup.prototype=new WDBarreBouton;WDBarreBoutonPopup.prototype.constructor=WDBarreBoutonPopup;WDBarreBoutonPopup.prototype.ms_tagBoutonClic="img";WDBarreBoutonPopup.prototype.OnMouseOver=function(){this.m_bSurvol||WDBarreBouton.prototype.OnMouseOver.apply(this,arguments)};WDBarreBoutonPopup.prototype.OnMouseOut=function(n){var t=bIE?n.toElement:n.relatedTarget;clWDUtil.bEstFils(t,this.m_oBouton)||(this.__SetDisplayPopup(!1),WDBarreBouton.prototype.OnMouseOut.apply(this,arguments))};WDBarreBoutonPopup.prototype.ExecuteCommande=function(){this.__SetDisplayPopup(!0)};WDBarreBoutonPopup.prototype.OnClickP=function(n){this.__SetDisplayPopup(!1);WDBarreBouton.prototype.OnMouseOut.apply(this,[n]);clWDUtil.nSetTimeout(this.m_pfMouseOutSimule,clWDUtil.ms_nTimeoutNonImmediat100)};WDBarreBoutonPopup.prototype.__SetDisplayPopup=function(n){var r,t,u,i;if(clWDUtil.SetDisplay(this.m_oPopup,n),r=this.m_oObjetParent.m_oBarre,t=r,n){if(!this.m_tabZIndex.length)while(t=t.parentNode){if(t==document.body||clWDUtil.bBaliseEstTag(t,"form"))break;this.m_tabZIndex.push(t.style.zIndex);t.style.zIndex="991"}}else if(this.m_tabZIndex.length){for(u=0;t=t.parentNode;){if(i=this.m_tabZIndex[u++],t==document.body||clWDUtil.bBaliseEstTag(t,"form")||undefined==i)break;t.style.zIndex=i}this.m_tabZIndex.length=0}};WDBarreBoutonPopupMenu.prototype=new WDBarreBoutonPopup;WDBarreBoutonPopupMenu.prototype.constructor=WDBarreBoutonPopupMenu;WDBarreBoutonPopupMenu.prototype.m_nOptionSurvol=-1;WDBarreBoutonPopupMenu.prototype.OnMouseOverMenu=function(n){var t=this.__nGetOptionEvent(n);this.m_nOptionSurvol!=t&&(this.m_nOptionSurvol=t);this.__RafEtatOptions(n)};WDBarreBoutonPopupMenu.prototype.OnMouseOutMenu=function(n){var t=this.__nGetOptionEvent(n);this.m_nOptionSurvol==t&&delete this.m_nOptionSurvol;this.__RafEtatOptions(n)};WDBarreBoutonPopupMenu.prototype.__nGetOptionEvent=function(n){for(var i=clWDUtil.oGetTarget(n),r=this.m_tabOptions.length,t=0;t<r;t++)if(clWDUtil.bEstFils(i,this.m_tabOptions[t].oTD))return t;return-1};WDBarreBoutonPopupMenu.prototype.ExecuteCommande=function(n){WDBarreBoutonPopup.prototype.ExecuteCommande.apply(this,arguments);this.__RafEtatOptions(n)};WDBarreBoutonPopupMenu.prototype.__RafEtatOptions=function(n){for(var i=this.m_tabOptions.length,t=0;t<i;t++)this.__RafEtatOption(n,t,this.m_nOptionSurvol)};WDBarreBoutonPopupMenu.prototype.__RafEtatOption=function(n,t,i){var r=this.m_tabOptions[t],u=this.__eGetEtatSurvol(t==i);u=this.__eGetEtatSpecifiqueOption(n,u,r);this.__DessineEtat(u,r,r.oTD)};WDBarreBoutonPopupMenu.prototype.__eGetEtatSpecifiqueOption=function(n,t,i){return this.m_oObjetParent.bActifOption(n,i.oParamCommande)?this.ms_eEtatActif:t};WDBarreBoutonPopupMenu.prototype.OnClickP=function(n){var t=this.__nGetOptionEvent(n);t!=-1&&(this.m_oParamCommande=this.m_tabOptions[t].oParamCommande);WDBarreBouton.prototype.ExecuteCommande.apply(this,[n]);WDBarreBoutonPopup.prototype.OnClickP.apply(this,arguments)};WDBarreBoutonPopupMenuS.prototype=new WDBarreBoutonPopupMenu;WDBarreBoutonPopupMenuS.prototype.constructor=WDBarreBoutonPopupMenuS;WDBarreBoutonPopupMenuS.prototype._veGetEtatSpecifique=function(n){for(var i=this.m_tabOptions.length,t=0;t<i;t++)if(this.m_oObjetParent.bActifOption(n,this.m_tabOptions[t].oParamCommande))return this.ms_eEtatActif;return WDBarreBoutonPopupMenu.prototype._veGetEtatSpecifique.apply(this,arguments)};WDBarre.prototype=new WDChampParametresHote;WDBarre.prototype.constructor=WDBarre;WDBarre.prototype.ms_eModeBarreAutomatique=0;WDBarre.prototype.ms_eModeBarreToujours=1;WDBarre.prototype.ms_eModeBarreJamais=2;WDBarre.prototype.ms_nBoutonOnOff=0;WDBarre.prototype.ms_nBoutonPopup=1;WDBarre.prototype.ms_nBoutonAction=2;WDBarre.prototype.ms_nCombo=3;WDBarre.prototype.ms_nBoutonPopupMenu=4;WDBarre.prototype.ms_nBoutonPopupMenuS=5;WDBarre.prototype.ms_sSuffixeCommande="_COM";WDBarre.prototype.ms_nMarqueBordureGauche=1;WDBarre.prototype.ms_nMarqueBordureDroite=2;WDBarre.prototype.ms_bAvecFixed=function(n){function t(n){for(var i=n.firstChild;i;i=i.nextSibling)switch(i.nodeName){case"#comment":case"#text":break;default:if(i.style&&"fixed"==i.style.position||t(i))return!0}return!1}return 0<clWDUtil.tabGetElementsByClass(n,"fixedcoulisse").length||t(n)}(document.body);WDBarre.prototype.ms_sZIndexDefautDefaut="988";WDBarre.prototype.ms_sZIndexDefautFixed="799";WDBarre.prototype.ms_sZIndexDefaut=WDBarre.prototype.ms_bAvecFixed?WDBarre.prototype.ms_sZIndexDefautFixed:WDBarre.prototype.ms_sZIndexDefautDefaut;WDBarre.prototype.ms_sZIndexPopup="991";WDBarre.prototype.Init=function(){WDChampParametresHote.prototype.Init.apply(this,arguments);this._InitBarre()};WDBarre.prototype._vLiaisonHTML=function(){WDChampParametresHote.prototype._vLiaisonHTML.apply(this,arguments);this.m_oBarre=this.oGetElementById(document,this.ms_sSuffixeCommande);this.m_oBarre&&this.__bBarreDeplace()&&(this.m_oBarre.style.zIndex=this.__sGetZIndex(),this.m_oBarre=document.forms[0].appendChild(this.m_oBarre.parentNode.removeChild(this.m_oBarre)),this.m_bBarreDeplacee=!0)};WDBarre.prototype.__bBarreDeplace=function(){if(this.m_bBarreDeplacee)return!1;if(this.bGestionTableZR()){var n=this.oGetTableZRParent();if(!n||!(n instanceof WDTable)||n.bGetSansLimite())return!1}return!0};WDBarre.prototype.OnDisplay=function(n,t){WDChampParametresHote.prototype.OnDisplay.apply(this,arguments);clWDUtil.SupprimeDansTableau(this.m_tabElementRacineDisplay,n);t&&this.m_tabElementRacineDisplay.push(n);this.m_bBarreDeplacee&&this.m_oBarre&&this.m_oHote&&clWDUtil.bEstFils(this.m_oHote,n)&&(this.m_oBarre.style.zIndex=this.__sGetZIndex(),this.m_eModeBarre==this.ms_eModeBarreToujours&&this.RafBarre(null,t))};WDBarre.prototype.__sGetZIndex=function(){var t=this.m_tabElementRacineDisplay,n;return this.m_tabElementRacineDisplay=[],n=this.m_oHote,clWDUtil.bForEach(t,function(t){return!clWDUtil.bEstFils(n,t)})?this.ms_bAvecFixed&&this.m_oHote&&function(n){for(var t=document.body;n&&n!=t;n=n.parentNode)if("fixed"==n.style.position||clWDUtil.bAvecClasse(n,"fixedcoulisse"))return!0;return!1}(this.m_oHote)?this.ms_sZIndexDefautDefaut:this.ms_sZIndexDefaut:this.ms_sZIndexPopup};WDBarre.prototype._InitBarre=function(){var n=!1;switch(this.m_eModeBarre){case this.ms_eModeBarreToujours:clWDUtil.SetDisplay(this.m_oBarre,this.m_bBarreDeplacee?clWDUtil.bEstDisplay(this.m_oHote,document,!0):!0);n=!0;break;case this.ms_eModeBarreJamais:break;case this.ms_eModeBarreAutomatique:default:n=!0}this.m_tabBarreElements=[];n&&(this._InitBarreAutomatique(),this._AssocieBarreElements())};WDBarre.prototype._vOnResize=function(){WDChampParametresHote.prototype._vOnResize.apply(this,arguments);this._DeplaceBarreSiBesoinAvecTimeout()};WDBarre.prototype._vOnScroll=function(){WDChampParametresHote.prototype._vOnScroll.apply(this,arguments);this._DeplaceBarreSiBesoinAvecTimeout()};WDBarre.prototype._DeplaceBarreSiBesoinAvecTimeout=function(){if(this.m_bBarreDeplacee&&this.m_oBarre&&this.m_oHote&&clWDUtil.bEstDisplay(this.m_oHote,document,!0)){var n=this;clWDUtil.nSetTimeout(function(){n._DeplaceBarre()},clWDUtil.ms_oTimeoutImmediat)}};WDBarre.prototype._AssocieBarreElements=function(){for(var f=this.m_tabDescBarre.length,n,i,t,r,u=0;u<f;u++)if(n=this.m_tabDescBarre[u],n){if(i=null,t=this.oGetElementByIdBarre(document,n.sSuf),!t)continue;switch(n.nType){case this.ms_nBoutonOnOff:i=this._voNewBoutonOnOff(t,n);break;case this.ms_nBoutonPopup:i=this._voNewBoutonPopup(t,n);break;case this.ms_nBoutonAction:i=this._voNewBoutonAction(t,n);break;case this.ms_nCombo:i=this._voNewBoutonCombo(t,n);break;case this.ms_nBoutonPopupMenu:i=this._voNewBoutonMenu(t,n);break;case this.ms_nBoutonPopupMenuS:i=this._voNewBoutonMenuS(t,n)}i&&(this.m_tabBarreElements.push(i),r=this.m_tabBoutonsInfo[n.sSuf],r&&(n.nType==this.ms_nCombo&&(t=t.parentNode),r.bVisible!==undefined&&clWDUtil.SetDisplay(t,r.bVisible),r.nSeparateurs!==undefined&&(clWDUtil.ActiveDesactiveClassName(t,"WDBordGauche",!!(r.nSeparateurs&1)),clWDUtil.ActiveDesactiveClassName(t,"WDBordDroit",!!(r.nSeparateurs&2)))),n.sTitle&&(t.title=n.sTitle))}};WDBarre.prototype._voNewBoutonOnOff=function(){return null};WDBarre.prototype._voNewBoutonPopup=function(){return null};WDBarre.prototype._voNewBoutonAction=function(){return null};WDBarre.prototype._voNewBoutonCombo=function(){return null};WDBarre.prototype._voNewBoutonMenu=function(){return null};WDBarre.prototype._voNewBoutonMenuS=function(){return null};WDBarre.prototype.oGetElementByIdBarre=function(n,t){var i=this.oGetElementById(n,this.ms_sSuffixeCommande+"_"+t);return i&&this.__sAppliqueBulle(i,t),i};WDBarre.prototype.RafBarre=function(n,t){this.eGetEtat()!=WDChamp.prototype.ms_eEtatActif&&(t=!1);switch(this.m_eModeBarre){case this.ms_eModeBarreJamais:break;case this.ms_eModeBarreAutomatique:default:if(clWDUtil.SetDisplay(this.m_oBarre,t),!t)break;case this.ms_eModeBarreToujours:this._DeplaceBarre();this.m_bBarreDeplacee&&clWDUtil.SetDisplay(this.m_oBarre,clWDUtil.bEstDisplay(this.m_oHote,document,!0));for(var r=this.oGetParamEtat(n,!1),u=this.m_tabBarreElements.length,i=0;i<u;i++)this.m_tabBarreElements[i].RafEtat(n,r)}};WDBarre.prototype._DeplaceBarre=function(){if(this.m_bBarreDeplacee){var n=this.m_oBarre,t=n.offsetParent,i=t==(n.document?n.document.body:document.body),r=i,u=!i;n.style.left=clWDUtil.nGetBoundingClientRectLeft(this.m_oHote,!0,!1)-clWDUtil.nGetBoundingClientRectLeft(t,u,r)+"px";n.style.top=clWDUtil.nGetBoundingClientRectTop(this.m_oHote,!0,!1)-23-clWDUtil.nGetBoundingClientRectTop(t,u,r)+"px"}};WDBarre.prototype.oGetParamEtat=function(){return null};WDBarre.prototype.sGetCouleurFond=function(n){return this.m_tabCouleurFond[n]};WDBarre.prototype.__sAppliqueBulle=function(n,t){var r=this.sGetAltText(t),i;r&&(i=n.getElementsByTagName("img"),i.length&&(i[0].alt=r,i[0].title=r),i=n.getElementsByTagName("select"),i.length&&(i[0].title=r))};WDBarre.prototype.sGetAltText=function(){return null};WDBarre.prototype._vMasqueBarre=function(){WDChampParametresHote.prototype._vMasqueBarre.apply(this,arguments);this.m_eModeBarre==this.ms_eModeBarreAutomatique&&clWDUtil.SetDisplay(this.m_oBarre,!1)};WDBarre.prototype.DeplaceBarre=function(n){if(this.m_bBarreDeplacee)this._DeplaceBarre();else if(n&&this.m_oBarre){for(var i=this.m_tabBarreElements.length,t=0;t<i;t++)this.m_tabBarreElements[t].vPrePlaceBarre();for(this.m_oBarre=n.insertBefore(this.m_oBarre,null),t=0;t<i;t++)this.m_tabBarreElements[t].vPostPlaceBarre()}}