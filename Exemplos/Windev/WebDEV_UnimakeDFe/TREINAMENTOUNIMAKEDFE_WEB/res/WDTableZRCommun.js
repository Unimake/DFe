/*! 28.0.2.0 */
/*! VersionVI: 01F280095g   */
function WDRupture(n,t,i,r,u){arguments.length&&(clWDUtil.WDObjet.prototype.constructor.apply(this,[n]),this.m_sAliasBas=t,this.m_nColonne=i,this.m_bVisibleHaut=r,this.m_bVisibleBas=u)}function WDColonne(n,t,i){arguments.length&&(clWDUtil.WDObjet.prototype.constructor.apply(this,[n]),this.m_eTypeWL=undefined!==t?t:16,this._CalculeConversion(WDChamp.prototype.XML_CHAMP_PROP_NUM_VALEUR,n,i))}function WDAttribut(n,t,i){if(arguments.length){var r=i[1],u=r&&r.length?r:n;WDColonne.prototype.constructor.apply(this,[n,t,u]);this.m_eProprieteAssocie=WDTableZRNavigateur.prototype.s_eGetProprietePrincipale(i[0],i[2]);this.m_sAliasChampAssocie=r;this.m_eTypeChampAssocie=i[2];this.m_eProprieteAssocie!==WDChamp.prototype.XML_CHAMP_PROP_NUM_VALEUR&&this._CalculeConversion(this.m_eProprieteAssocie,n,u)}}function WDTableColonne(n,t,i){if(arguments.length){WDColonne.prototype.constructor.apply(this,[n,t,n]);this.m_eTypeIDObjet=i[0];this.m_bTri=i[1];this.m_nRecherche=i[2];this.m_nFiltre=i[3];var r=i[4];this.m_tabVisible="boolean"==typeof r?[r]:function(){var n=String(r),t=new Array(n.length);return clWDUtil.bForEach(n.split(";"),function(n,i){return t[i]="1"===n,!0}),t}();this.m_bSaisissable=i[5];this.m_eDeplaceInsere=i[6];this.m_nRangCreation=i[7];this.m_nPositionAffichage=i[8];this.m_nLargeur=i[9];this.m_tabOptions=i[10];this.m_bAjustable=i[11];this.m_sCouleur=i[12];this.m_sCouleurFond=i[13];this.m_nModeAffichage=i[14]}}function WDLigne(n,t){arguments.length&&(this.m_oProprietesValeurs={},this.m_oProprietesValeurs[WDChamp.prototype.XML_CHAMP_PROP_NUM_VALEUR]=new Array(n),this.m_nDeroule=this.ms_nTous,this.m_nRupturesHaut=this.ms_nRien,this.m_nRupturesBas=this.ms_nRien,this.m_bPCodeAffichage=!1,this.m_bModifieRuptures=!0,this.m_bVerifieFiltre=!0,this.m_bLigneVirtuelle=t)}function WDCelluleSaisie(n){if(arguments.length){this.m_oChampTable=n;this.m_oEventPCodeSortie=null;var t=this;this.m_pfOnSubmit=function(n){return t.__bOnSubmit(n||event)};this.m_pfOnBlur=function(n){return t.__bOnBlur(n||event)};this.m_pfOnKeyDown=function(n){return t.__bOnKeyDown(n||event)};this.m_pfOnChange=function(n){return t.__bOnChange(n||event)};this.m_nLigne=WDTableZRNavigateur.prototype.ms_nLigneInvalide;this.m_nColonne=WDTableZRNavigateur.prototype.ms_nColonneInvalide}}var clWDTableDefs={ID_POSITION_PIXEL:"POS",ID_TITRE:"TITRES",ID_TRI:"TRI",ID_RECHERCHE:"RECH",ID_FORMAT:"FORMAT",ms_nOptionTAMontreLigne:1,ms_nOptionTAPreserveScroll:2,ms_nOptionTARedessineTitre:4,ms_nSelectionSans:0,ms_nSelectionSimple:1,ms_nSelectionMultiple:2},WDTableZRNavigateur,WDPopupSaisieTRF,WDAffichageColonnes,WDTableZRCommun;WDRupture.prototype=new clWDUtil.WDObjet;WDRupture.prototype.constructor=WDRupture;WDRupture.prototype.RecuperePCode=function(n,t){return clWDUtil.pfGetTraitement(t?this.m_sAlias:this.m_sAliasBas,n)};WDRupture.prototype.bVisible=function(n){return n?this.m_bVisibleHaut:this.m_bVisibleBas};WDRupture.prototype.s_nGetIndice=function(n,t,i,r){var u=r,f,e,o;if(t){for(f=n+"-H-"+i+"-";0<u;u--)if(document.getElementById(f+u))return u}else for(e=n+"-B-"+i+"-",o=WDChamp.prototype.s_nGetTableZROccurrence(n);u<=o;u++)if(document.getElementById(e+u))return u;return r};WDColonne.prototype=new clWDUtil.WDObjet;WDColonne.prototype.constructor=WDColonne;WDColonne.prototype._CalculeConversion=function(n,t,i){var r="_SET_"+i+"_"+n,u="_GET_"+i+"_"+n;t===i&&(r+="_I",u+="_I");r+="_C";u+="_C";this.m_pfConversionVersAffichage=window[r];this.m_pfConversionDepuisAffichage=window[u]};WDColonne.prototype.oGetValeurInterne=function(n,t){return n!==undefined?this._voGetValeurInterne(n):this._voGetValeurDefaut(t)};WDColonne.prototype._voGetValeurInterne=function(n){switch(typeof n){case"boolean":return n;default:return clWDUtil.oConversionType(n,this.m_eTypeWL)}};WDColonne.prototype._voGetValeurDefaut=function(){return""};WDColonne.prototype.fGetCompare=function(n){return clWDUtil.fGetCompare(n)};WDColonne.prototype.vsLitPropriete=function(n,t,i,r,u,f,e){switch(f){default:case WDChamp.prototype.XML_CHAMP_PROP_NUM_VALEUR:return this.oGetValeurAvecLigne(t,u,e)}};WDColonne.prototype.oGetValeurAvecLigne=function(n,t,i){var r=t.tabGetValeurs()[n];return i&&this.m_pfConversionVersAffichage&&(r=this.m_pfConversionVersAffichage(r)),r};WDColonne.prototype.bEstTexte=function(){switch(this.m_eTypeWL){case 16:case 17:case 18:case 19:case 81:case 110:case 134:return!0;default:return!1}};WDColonne.prototype.bEstNumerique=function(){return 2<=this.m_eTypeWL&&this.m_eTypeWL<=15};WDColonne.prototype.bEstDateHeure=function(){switch(this.m_eTypeWL){case 24:case 25:case 26:case 27:case 128:case 129:return!0;default:return!1}};WDAttribut.prototype=new WDColonne;WDAttribut.prototype.constructor=WDAttribut;WDAttribut.prototype._voGetValeurInterne=function(n){switch(this.m_eProprieteAssocie){case WDChamp.prototype.XML_CHAMP_PROP_NUM_VISIBLE:case WDChamp.prototype.XML_CHAMP_PROP_NUM_POLICEGRAS:case WDChamp.prototype.XML_CHAMP_PROP_NUM_POLICEITALIQUE:case WDChamp.prototype.XML_CHAMP_PROP_NUM_POLICESOULIGNE:return clWDUtil.bCastToBoolAvecChaine(n);case WDChamp.prototype.XML_CHAMP_PROP_NUM_ETAT:var t=parseInt(n+"",10);return t!==WDChamp.prototype.ms_eEtatActif&&t!==WDChamp.prototype.ms_eEtatLectureSeule&&t!==WDChamp.prototype.ms_eEtatGrise&&(t=WDChamp.prototype.ms_eEtatActif),t;case WDChamp.prototype.XML_CHAMP_PROP_NUM_POLICETAILLE:default:return WDColonne.prototype._voGetValeurInterne.apply(this,arguments)}};WDAttribut.prototype._voGetValeurDefaut=function(){switch(this.m_eProprieteAssocie){case WDChamp.prototype.XML_CHAMP_PROP_NUM_VISIBLE:return!0;case WDChamp.prototype.XML_CHAMP_PROP_NUM_ETAT:return WDChamp.prototype.ms_eEtatActif;case WDChamp.prototype.XML_CHAMP_PROP_NUM_POLICEGRAS:case WDChamp.prototype.XML_CHAMP_PROP_NUM_POLICEITALIQUE:case WDChamp.prototype.XML_CHAMP_PROP_NUM_POLICESOULIGNE:return!1;case WDChamp.prototype.XML_CHAMP_PROP_NUM_POLICETAILLE:return 0;default:return WDColonne.prototype._voGetValeurDefaut.apply(this,arguments)}};WDAttribut.prototype.vsLitPropriete=function(n,t,i,r,u,f,e){switch(f){case WDChamp.prototype.XML_CHAMP_PROP_NUM_VALEUR:default:var o=this.oGetValeurAvecLigne(t,u,e);if(e)switch(this.m_eProprieteAssocie){case WDChamp.prototype.XML_CHAMP_PROP_NUM_VALEUR:if(WDChamp.prototype.ms_nIDObjetImage!==this.m_eTypeChampAssocie)break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_IMAGE:case WDChamp.prototype.XML_CHAMP_PROP_NUM_VIGNETTE:o=clWDUtil.sGetCheminImage(o)}return o}};WDTableColonne.prototype=new WDColonne;WDTableColonne.prototype.constructor=WDTableColonne;WDTableColonne.prototype.ms_nFiltreRecherche=0;WDTableColonne.prototype.ms_nFiltreEgal=31978;WDTableColonne.prototype.ms_nFiltreCommencePar=31979;WDTableColonne.prototype.ms_nFiltreContient=31980;WDTableColonne.prototype.ms_nFiltreTerminePar=31981;WDTableColonne.prototype.ms_nFiltreDifferent=31982;WDTableColonne.prototype.ms_nFiltreNeCommencePasPar=31983;WDTableColonne.prototype.ms_nFiltreNeContientPas=31984;WDTableColonne.prototype.ms_nFiltreNeTerminePasPar=31985;WDTableColonne.prototype.ms_nFiltreSuperieur=31986;WDTableColonne.prototype.ms_nFiltreSuperieurOuEgal=31987;WDTableColonne.prototype.ms_nFiltreInferieur=31988;WDTableColonne.prototype.ms_nFiltreInferieurOuEgal=31989;WDTableColonne.prototype.ms_nDISans=0;WDTableColonne.prototype.ms_nDIGauche=1;WDTableColonne.prototype.ms_nDIDroite=2;WDTableColonne.prototype.ms_nDIGaucheDroite=3;WDTableColonne.prototype.ms_nDIDeplace=4;WDTableColonne.prototype.ms_eNormal=1;WDTableColonne.prototype.ms_eCentre=2;WDTableColonne.prototype.ms_eEtire=3;WDTableColonne.prototype.ms_eRepete=4;WDTableColonne.prototype.ms_eHomothetique=5;WDTableColonne.prototype.ms_eHomothetiqueCentre=6;WDTableColonne.prototype.ms_eHomothetiqueLarge=7;WDTableColonne.prototype.ms_eHomothetiqueCentreLarge=8;WDTableColonne.prototype.ms_eAdapte=9;WDTableColonne.prototype.ms_eAdapteCentre=10;WDTableColonne.prototype.ms_eNavigateurHomothetiqueLargeur=11;WDTableColonne.prototype.ms_eNavigateurAdapteLargeur=12;WDTableColonne.prototype.ms_eNavigateurHomothetiqueLargeurDebordementHauteur=13;WDTableColonne.prototype.ms_eNavigateurAdapteLargeurDebordementHauteur=14;WDTableColonne.prototype.ms_sEventPourChargementImage=bIE?"onreadystatechange":"onload";WDTableColonne.prototype.ms_sEventPourEchec="onerror";WDTableColonne.prototype.ms_sClasseImage="wbColImage";WDTableColonne.prototype._voGetValeurInterne=function(n){switch(this.m_eTypeIDObjet){case WDChamp.prototype.ms_nIDObjetCombo:switch(typeof n){case"string":case"number":return n}break;case WDChamp.prototype.ms_nIDObjetInterrupteur:return clWDUtil.bCastToBoolAvecChaine(n);case WDChamp.prototype.ms_nIDObjetImage:return n+"";case WDChamp.prototype.ms_nIDObjetSaisie:return clWDUtil.oConversionType(n,this.m_eTypeWL);case WDChamp.prototype.ms_nIDObjetChampAttributTable:return n}return WDColonne.prototype._voGetValeurInterne.apply(this,arguments)};WDTableColonne.prototype._voGetValeurDefaut=function(n){switch(this.m_eTypeIDObjet){case WDChamp.prototype.ms_nIDObjetCombo:return n?0:1;case WDChamp.prototype.ms_nIDObjetInterrupteur:return!1;case WDChamp.prototype.ms_nIDObjetImage:return"";case WDChamp.prototype.ms_nIDObjetSaisie:return clWDUtil.oConversionType("",this.m_eTypeWL)}};WDTableColonne.prototype.s_xfGetFiltre=function(n){switch(n){case this.ms_nFiltreEgal:return clWDUtil.s_bEgal;case this.ms_nFiltreCommencePar:return clWDUtil.s_bCommencePar;case this.ms_nFiltreContient:return clWDUtil.s_bContient;case this.ms_nFiltreTerminePar:return clWDUtil.s_bTerminePar;case this.ms_nFiltreDifferent:return clWDUtil.s_bDifferent;case this.ms_nFiltreNeCommencePasPar:return clWDUtil.s_bNeCommencePasPar;case this.ms_nFiltreNeContientPas:return clWDUtil.s_bNeContientPas;case this.ms_nFiltreNeTerminePasPar:return clWDUtil.s_bNeTerminePasPar;case this.ms_nFiltreSuperieur:return clWDUtil.s_bSuperieur;case this.ms_nFiltreSuperieurOuEgal:return clWDUtil.s_bSuperieurOuEgal;case this.ms_nFiltreInferieur:return clWDUtil.s_bInferieur;case this.ms_nFiltreInferieurOuEgal:return clWDUtil.s_bInferieurOuEgal;default:throw new WDErreur(303,n);}};WDTableColonne.prototype.nGetFiltre=function(){return this.m_nFiltre};WDTableColonne.prototype.SetFiltre=function(n){this.m_nFiltre=n};WDTableColonne.prototype.bGetVisible=function(){var t=clWDUtil.bRWD?$.wb.nGetTrancheActiveIndiceWL(!0)-1:0,n=this.m_tabVisible[t];return undefined!==n?n:!!this.m_tabVisible[0]};WDTableColonne.prototype.bGetSaisissable=function(){if(!this.m_bSaisissable)return!1;switch(this.m_eTypeIDObjet){case WDChamp.prototype.ms_nIDObjetCombo:if(!this.m_tabOptions||0===this.m_tabOptions.length)return!1;break;case WDChamp.prototype.ms_nIDObjetImage:return!1;case WDChamp.prototype.ms_nIDObjetSaisie:if(undefined!==this.m_nLien&&0!==this.m_nLien)return!1}return!0};WDTableColonne.prototype.bColonneInsereGauche=function(){switch(this.m_eDeplaceInsere){case this.ms_nDIGauche:case this.ms_nDIGaucheDroite:case this.ms_nDIDeplace:return!0;default:return!1}};WDTableColonne.prototype.bColonneInsereDroite=function(){switch(this.m_eDeplaceInsere){case this.ms_nDIDroite:case this.ms_nDIGaucheDroite:case this.ms_nDIDeplace:return!0;default:return!1}};WDTableColonne.prototype.bColonneInsereGaucheDroite=function(){return this.ms_nDISans!==this.m_eDeplaceInsere};WDTableColonne.prototype.bColonneDeplace=function(){return this.ms_nDIDeplace===this.m_eDeplaceInsere};WDTableColonne.prototype.nGetModeAffichageImage=function(n){return this.m_nModeAffichage+(n.m_bHauteurLigneVariable?256:0)};WDTableColonne.prototype.vsLitPropriete=function(n,t,i,r,u,f,e,o){switch(f){case WDTableZRNavigateur.prototype.ms_nAttributTriable:return this.m_bTri;case WDTableZRNavigateur.prototype.ms_nAttributRecherchable:return 0<this.m_nRecherche;case WDTableZRNavigateur.prototype.ms_nAttributDerniereVisible:return n.bDerniereColonneVisible(t);case WDChamp.prototype.XML_CHAMP_PROP_NUM_VALEUR:var s=WDColonne.prototype.vsLitPropriete.apply(this,arguments);if(e)switch(this.m_eTypeIDObjet){case WDChamp.prototype.ms_nIDObjetCombo:return this.__sLitValeurCombo(s);case WDChamp.prototype.ms_nIDObjetInterrupteur:return this.__sLitValeurInterrupteur(s,n,t,i);case WDChamp.prototype.ms_nIDObjetImage:return this.__sLitValeurImage(s,n);case WDChamp.prototype.ms_nIDObjetSaisie:return this.__sLitValeurSaiseOuLien(s)}return s;case WDChamp.prototype.XML_CHAMP_PROP_NUM_COULEUR:return this.__sLitCouleurColonneCellule(n,t,u,i,r,!1,e,o);case WDChamp.prototype.XML_CHAMP_PROP_NUM_COULEURFOND:return this.__sLitCouleurColonneCellule(n,t,u,i,r,!0,e,o);case WDChamp.prototype.XML_CHAMP_PROP_NUM_BULLE:if(null===u)return"";default:return u?u.tabGetValeursUnePropriete(f)[t]||"":WDColonne.prototype.vsLitPropriete.apply(this,arguments)}};WDTableColonne.prototype.__sLitValeurCombo=function(n){switch(typeof n){case"string":return n;case"number":return this.m_tabOptions&&1<=n&&n<=this.m_tabOptions.length?this.m_tabOptions[n-1]:""}return n};WDTableColonne.prototype.__sLitValeurInterrupteur=function(n,t,i,r){var u=['<input type="checkbox"'];return n&&u.push(" checked"),this.bGetSaisissable()?(u.push(" onclick=\"oGetObjetChamp('"),u.push(t.m_sAliasChamp),u.push("').OnClickInterrupteur(event,this,"),u.push(r),u.push(","),u.push(i),u.push(');"')):u.push(" disabled"),u.push(">"),u.join("")};WDTableColonne.prototype.__sLitValeurImage=function(n,t){var i=[];return 0<n.length&&(i.push('<img src="'),i.push(clWDUtil.sGetCheminImage(n+"")),i.push('" data-webdev-mode-affichage="'),i.push(this.nGetModeAffichageImage(t)),i.push('" class="'),i.push(this.ms_sClasseImage),i.push('" style="opacity:0" '),i.push(this.ms_sEventPourChargementImage),i.push('="WDTableZRNavigateur.prototype.s_RedimImageChargement(this);">')),i.join("")};WDTableColonne.prototype.__sLitValeurSaiseOuLien=function(n){return clWDUtil.sEncodeInnerHTML(n,!0)};WDTableColonne.prototype.__sLitCouleurColonneCellule=function(n,t,i,r,u,f,e,o){var h=f?this.m_sCouleurFond:this.m_sCouleur,v,c,s,l,y,a;return i?e&&n.m_oSelection&&n.m_oSelection.bGetLigneEstSelectionnee(r)&&(v=n.m_oStyleLigneSelectionne,c=f?v.m_sCouleurFond:v.m_sCouleur,c&&c.length)?c:(s=i.m_oProprietesValeurs[f?WDChamp.prototype.XML_CHAMP_PROP_NUM_COULEURFOND:WDChamp.prototype.XML_CHAMP_PROP_NUM_COULEUR],s&&s[t]&&s[t].length)?s[t]:(l=f?i.m_sCouleurFond:i.m_sCouleur,l&&l.length)?l:h&&h.length?h:!o&&(y=0==u%2?n.m_oStyleLigneImpair:n.m_oStyleLignePair,a=f?y.m_sCouleurFond:y.m_sCouleur,a&&a.length)?a:"":h||""};WDLigne.prototype.ms_nRien=0;WDLigne.prototype.ms_nTous=4294967295|0;WDLigne.prototype.oGetPropriete=function(n,t){var i={};return!i.m_sCouleur&&this.m_sCouleur&&this.m_sCouleur.length&&(i.m_sCouleur=this.m_sCouleur),!i.m_sCouleurFond&&this.m_sCouleurFond&&this.m_sCouleurFond.length&&(i.m_sCouleurFond=this.m_sCouleurFond),!i.m_sCouleur&&t.m_sCouleur&&t.m_sCouleur.length&&(i.m_sCouleur=t.m_sCouleur),!i.m_sCouleurFond&&t.m_sCouleurFond&&t.m_sCouleurFond.length&&(i.m_sCouleurFond=t.m_sCouleurFond),i};WDLigne.prototype.tabGetValeurs=function(){return this.m_oProprietesValeurs[WDChamp.prototype.XML_CHAMP_PROP_NUM_VALEUR]};WDLigne.prototype.tabGetValeursUnePropriete=function(n){var t=this.m_oProprietesValeurs;return Object.prototype.hasOwnProperty.call(t,n)||(t[n]=new Array(this.tabGetValeurs().length)),t[n]};WDLigne.prototype.SetModifieRuptures=function(n){this.m_bModifieRuptures=this.m_bModifieRuptures||n};WDLigne.prototype.bGetClearPCodeAffichage=function(){var n=this.m_bPCodeAffichage;return this.m_bPCodeAffichage=!0,!n};WDLigne.prototype.bGetClearModifieRuptures=function(){var n=this.m_bModifieRuptures;return this.m_bModifieRuptures=!1,n};WDLigne.prototype.nGetRuptures=function(n){return n?this.m_nRupturesHaut:this.m_nRupturesBas};WDLigne.prototype.bGetRupture=function(n,t){return this.bGetRuptureDirect(n,t)||0<n&&this.bGetRupture(n-1,t)};WDLigne.prototype.bGetRuptureDirect=function(n,t){return 0!=(this.nGetRuptures(t)&1<<n)};WDLigne.prototype.bGetRuptureVisible=function(n,t){if(!this.bGetDeroule())if(t){for(var i=n-1;0<=i;i--)if(0==(this.m_nDeroule&1<<i))return!1}else return!1;return this.bGetRupture(n,t)};WDLigne.prototype.bGetDeroule=function(){return this.ms_nTous===this.m_nDeroule};WDLigne.prototype.CopieEnrouleDeroule=function(n,t){var i=1<<t;0==(n.m_nDeroule&i)?this.m_nDeroule&=~i:this.m_nDeroule|=i};WDLigne.prototype.OnSupprime=function(){this.m_oProprietesValeurs={}};WDLigne.prototype.EnrouleDeroule=function(n,t,i){var r=1<<n;t===undefined&&(t=0==(this.m_nDeroule&r));t?(this.m_nDeroule|=r,i&&0<n&&this.EnrouleDeroule(n-1,t,i)):this.m_nDeroule&=~r};WDLigne.prototype.bEstEnroule=function(n){var t=1<<n;return 0==(this.m_nDeroule&t)};WDLigne.prototype.SetRupturesHaut=function(n){var t=this.m_nRupturesHaut^n;this.m_nRupturesHaut=n;this.m_nDeroule|=t};WDLigne.prototype.SetRupturesBas=function(n){this.m_nRupturesBas=n};WDLigne.prototype.bGetVerifieFiltre=function(){return this.m_bVerifieFiltre||this.bGetLigneVirtuelle()};WDLigne.prototype.SetVerifieFiltre=function(n){this.m_bVerifieFiltre=n};WDLigne.prototype.bGetLigneVirtuelle=function(){return this.m_bLigneVirtuelle};WDLigne.prototype.RAZLigneVirtuelle=function(){this.m_bLigneVirtuelle=!1};WDTableZRNavigateur=function(){function n(n,t,r,u,f){if(arguments.length){WDChampParametresHote.prototype.constructor.apply(this,arguments);var e=f[2];this.m_oSelection=new i(this,e);this.m_tabColonnes=[];this.m_tabRuptures=[];this.m_tabLignes=[];this.m_nNbLignesWL=0;this.m_tabTri=[];this.m_tabFiltre=[];this.m_nTAOptions=0;this.m_bDansOnSelectLigneExterne=!1;this.ms_tabTablesZRs.DeclareChamp(this)}}var t=-1,i=function(){function n(n,t){arguments.length&&(this.m_oChampTable=n,this.m_eTypeSelection=t,this.m_tabSelection=[])}return n.prototype.ms_nTsLigne=0,n.prototype.ms_nTsCellule=2,n.prototype.ms_nTsLigneCellule=10,n.prototype.ms_nTsColonneCellule=11,n.prototype.Init=function(){this._MAJValeurChampFormulaire()},n.prototype._MAJValeurChampFormulaire=function(){this.m_oChampTable.m_oChampFormulaire.value=this.m_oChampTable._nLigneLigneWL(this.nGetSelection())},n.prototype._OnChangementSelection=function(n,t,i){this._MAJValeurChampFormulaire();this.m_oChampTable.OnChangementSelection(n,t,i)},n.prototype.nGetSelection=function(){return undefined!==this.m_nForceSelection?this.m_nForceSelection:this.m_tabSelection.length?this.m_tabSelection[0].m_nLigne:t},n.prototype.nGetForceSelection=function(){return this.m_nForceSelection},n.prototype.ForceSelection=function(n){this.m_nForceSelection=n},n.prototype.ReinitSelection=function(n){this.bSelectAucun();clWDTableDefs.ms_nSelectionSans!==this.m_eTypeSelection&&undefined!==n&&this.SelectPlusDirect(n,undefined,!0,null)},n.prototype.ReinitSelectionSansReselection=function(n){this.ms_nTsLigne===this._nGetTypeSelection()&&1===this.m_tabSelection.length&&this.bGetLigneEstSelectionnee(n)||this.ReinitSelection(n)},n.prototype.bGetLigneEstSelectionnee=function(n){return clWDUtil.nElementInconnu!==this._nGetRangLigneSelection(n)},n.prototype._nGetRangLigneSelection=function(n){return clWDUtil.nDansTableauFct(this.m_tabSelection,function(t){return t.m_nLigne===n&&t.m_nColonne===undefined})},n.prototype.bGetCelluleEstSelectionnee=function(n,t){return clWDUtil.nElementInconnu!==this._nGetRangCelluleSelection(n,t)},n.prototype._nGetRangCelluleSelection=function(n,t){return clWDUtil.nDansTableauFct(this.m_tabSelection,function(i){return i.m_nLigne===n&&i.m_nColonne===t})},n.prototype._nGetTypeSelection=function(){return this.m_oChampTable._vbSelectionALaCellule()?this.ms_nTsCellule:this.ms_nTsLigne},n.prototype.xnSelectOccurrence=function(n){var t=undefined===n?this.ms_nTsLigne:n;switch(t){default:throw new WDErreur(303,t);case this.ms_nTsLigne:case this.ms_nTsCellule:return this._nGetTypeSelection()===t?this.m_tabSelection.length:0}},n.prototype.xnSelect=function(n,i){var r=undefined===i?this.ms_nTsLigne:i,u,e,f;switch(r){default:u=r;break;case this.ms_nTsLigneCellule:case this.ms_nTsColonneCellule:u=this.ms_nTsCellule}if(e=this.xnSelectOccurrence(u),n<0||e<=n)return t;f=this.m_tabSelection[n];switch(r){default:return f.m_nLigne;case this.ms_nTsColonneCellule:return f.m_nColonne}},n.prototype.xSelectPlusMoins=function(n,t,i){if(this.ms_nTsLigne===this._nGetTypeSelection())if(i.length)for(var u=i.length,r=0;r<u;r++)n.apply(this,[i[r]]);else t.apply(this,[null])},n.prototype.bSelectMoins=function(n){for(var t=!1,i;clWDUtil.nElementInconnu!==(i=this._nGetRangLigneSelection(n));)this._SelectMoinsRang(i,null),t=!0;return t},n.prototype._SelectMoinsRang=function(n,t){var i=this.m_tabSelection.splice(n,1)[0];this._OnChangementSelection(i.m_nLigne,!1,t)},n.prototype.bSelectPlus=function(n,t,i,r){return this.bGetLigneEstSelectionnee(n)?!1:(this.SelectPlusDirect(n,t,i,r),!0)},n.prototype.SelectPlusDirect=function(n,t,i,r){clWDTableDefs.ms_nSelectionMultiple!==this.m_eTypeSelection&&this.bSelectAucun(r);var u={m_nLigne:n};return this.ms_nTsCellule===this._nGetTypeSelection()&&undefined!==t&&(u.m_nColonne=t),this.m_tabSelection.push(u),this._OnChangementSelection(n,i,r),!0},n.prototype.bSelectAucun=function(n,t,i){for(var f=!1,u=this.m_tabSelection,r=0;r<u.length;)t!==u[r].m_nLigne||this.ms_nTsCellule===this._nGetTypeSelection()&&u[r].m_nColonne!=i?(this._SelectMoinsRang(r,n),f=!0):r++;return f},n.prototype.SelectTous=function(n){if(clWDTableDefs.ms_nSelectionMultiple===this.m_eTypeSelection){this.bSelectAucun(n);for(var i=this.m_oChampTable._nGetNbLignes(),t=0;t<i;t++)this.bSelectPlus(t,undefined,!1,n)}},n.prototype.OnLigneInsere=function(n){1===this.m_oChampTable._nGetNbLignes()?this.ms_nTsLigne===this._nGetTypeSelection()&&this.ReinitSelection(0):clWDUtil.bForEach(this.m_tabSelection,function(t){return n<=t.m_nLigne&&t.m_nLigne++,!0})},n.prototype.OnLigneSupprime=function(n){var r=this.bSelectMoins(n),i;clWDUtil.bForEach(this.m_tabSelection,function(t){return n<t.m_nLigne&&t.m_nLigne--,!0});r&&clWDTableDefs.ms_nSelectionSimple===this.m_eTypeSelection&&(i=this.m_oChampTable.nGetLigneAfficheeAutour(n),t!==i&&this.bSelectPlus(i,undefined,!0))},n.prototype.OnLigneDeplace=function(n,t,i){var f,e,o,u,s,r;if(i)f=this._nGetRangLigneSelection(n),e=this._nGetRangLigneSelection(t),clWDUtil.nElementInconnu!==f&&(this.m_tabSelection[f].m_nLigne=t),clWDUtil.nElementInconnu!==e&&(this.m_tabSelection[e].m_nLigne=n);else for(o=this.m_tabSelection,s=o.length,u=0;u<s;u++)r=o[u],r.m_nLigne===n&&(r.m_nLigne=t),n<r.m_nLigne&&r.m_nLigne<t?r.m_nLigne--:t<=r.m_nLigne&&r.m_nLigne<n&&r.m_nLigne++},n.prototype.OnSelectLigne=function(n,t,i,r){var e;if(clWDTableDefs.ms_nSelectionSans!==this.m_eTypeSelection&&undefined!==n&&this.m_oChampTable.m_oCelluleSaisie&&!this.m_oChampTable.m_oCelluleSaisie.bSaisieEnCoursDansCellule(n,t)){var o=i&&!r?i.ctrlKey:!1,s=i&&!r?i.shiftKey:!1,u=!1,h=this.m_eTypeSelection===clWDTableDefs.ms_nSelectionSimple||r;if(!h&&(o||s)||(u|=this.bSelectAucun(i,n,t)),e=this.ms_nTsCellule===this._nGetTypeSelection()?this._nGetRangCelluleSelection(n,t):this._nGetRangLigneSelection(n),clWDUtil.nElementInconnu!==e)o&&(this._SelectMoinsRang(e,i),u=!0),r&&(u|=this.bSelectPlus(n,t,!0,i));else{if(!h&&s&&this.m_tabSelection.length){var f=this.m_tabSelection[0].m_nLigne,c=f<n?1:-1,l=this.m_oChampTable.m_tabLignes;for(f+=c;f!==n;f+=c)l[n].bGetVerifieFiltre()&&(u|=this.bSelectPlus(f,t,!0,i))}u|=this.bSelectPlus(n,t,!0,i)}this.m_oChampTable.m_oCelluleSaisie&&this.m_oChampTable.m_oCelluleSaisie.OnClickCellule(n,t,u,i)}},n}();return n.prototype=new WDChampParametresHote,n.prototype.constructor=n,n.prototype.ms_nLigneInvalide=t,n.prototype.ms_nColonneInvalide=-1,n.prototype.ms_sDynO="[%",n.prototype.ms_sDynF="%]",n.prototype.ms_sDynSi="[%SI%]",n.prototype.ms_sDynAlors="[%ALORS%]",n.prototype.ms_sDynSinon="[%SINON%]",n.prototype.ms_sDynFin="[%FIN%]",n.prototype.ms_sInclureHautRupture="INCLURE_HAUTRUPTURE",n.prototype.ms_sInclureBasRupture="INCLURE_BASRUPTURE",n.prototype.ms_sCodeHTML30="CODEHTML_30_",n.prototype.ms_sCodeHTML31="CODEHTML_31_",n.prototype.ms_sCodeHTML32="CODEHTML_32",n.prototype.ms_sCodeHTML50="CODEHTML_50_",n.prototype.ms_sCodeHTML51="CODEHTML_51_",n.prototype.ms_sConditionEgal="=",n.prototype.ms_sConditionDifferent="!=",n.prototype.ms_sPropriete="..",n.prototype.ms_sConversion=";",n.prototype.ms_nAttributRuptureLigneDebut=-1,n.prototype.ms_nAttributRuptureLigneFin=-2,n.prototype.ms_nAttributLigneRepliee=-3,n.prototype.ms_nAttributIncludeHautRupture=-4,n.prototype.ms_nAttributIncludeBasRupture=-5,n.prototype.ms_nAttributLignePaire=-6,n.prototype.ms_nAttributTriable=-7,n.prototype.ms_nAttributRecherchable=-8,n.prototype.ms_nAttributSelected=-9,n.prototype.ms_nAttributDerniereVisible=-10,n.prototype.ms_nAttributCodeHTML30=-11,n.prototype.ms_nAttributCodeHTML31=-12,n.prototype.ms_nAttributCodeHTML32=-13,n.prototype.ms_nAttributCodeHTML50=-14,n.prototype.ms_nAttributCodeHTML51=-15,n.prototype.ms_nAttributExiste=-16,n.prototype.ms_nConversionPoliceGras=4,n.prototype.ms_nConversionPoliceItalique=5,n.prototype.ms_nConversionPoliceSouligne=6,n.prototype.ms_nConversionPoliceTaille=7,n.prototype.ms_nConversionBackgroundImage=20,n.prototype.ms_nTdEchange=2147483648,n.prototype.Init=function(){WDChampParametresHote.prototype.Init.apply(this,arguments);this._vAppliqueParametres();this.__HTMLParse();this.m_oSelection.Init()},n.prototype.SetValeur=function(n,t){return WDChampParametresHote.prototype.SetValeur.apply(this,arguments),this.m_oSelection.ReinitSelection(this._xnLigneWLLigne(t)),this._nGetSelection()},n.prototype.GetValeur=function(n,t,i){return t=this._nLigneLigneWL(this._nGetSelection()),WDChampParametresHote.prototype.GetValeur.apply(this,[n,t,i])},n.prototype.GetProp=function(n){switch(n){case this.XML_CHAMP_PROP_NUM_OCCURRENCE:return this._nGetNbLignesWL();default:return WDChampParametresHote.prototype.GetProp.apply(this,arguments)}},n.prototype._vLiaisonHTML=function(n,t){n="";WDChampParametresHote.prototype._vLiaisonHTML.apply(this,[n,t])},n.prototype._vAppliqueParametres=function(){var n=this.m_oParametres,t;clWDUtil.bForEachThis(n.m_tabColonnes,this,function(n){return this.m_tabColonnes.push(new this._vNewColonne(n.m_sAlias,n.m_eTypeWL,n.m_tabProprietesSpecifiques)),!0});clWDUtil.bForEachThis(n.m_tabRuptures,this,function(n){return this.m_tabRuptures.push(new this._vNewRupture(n.m_sAlias,n.m_sAliasBas,this._nGetColonneSelonAlias(n.m_sAliasColonne),n.m_bVisibleHaut,n.m_bVisibleBas)),!0});this.m_tabSurEntetes=n.m_tabSurEntetes;this.m_bSaisieCascade=n.m_bSaisieCascade;this.m_bSaisieCascade&&this.__AjouteLigneVirtuelle();this.m_oStyleLigneImpair=n.m_oStyleLigneImpair;this.m_oStyleLignePair=n.m_oStyleLignePair;this.m_oStyleLigneSelectionne=n.m_oStyleLigneSelectionne;t=this.m_oDonnees;n.m_tabColonnes=null;n.m_tabRuptures=null},n.prototype.AjouteDonnees=function(){var n=this.m_oDonnees;clWDUtil.bForEachThis(n.m_tabLignes,this,function(n){var t=[];return clWDUtil.bForEach(n.m_tabCellules,function(n){return t.push(n.m_oContenu),!0}),this._nLigneInsere(!1,t),!0});n.m_tabLignes=null},n.prototype.__AjouteLigneVirtuelle=function(){this.m_tabLignes.push(new this._vLigne(this._nGetNbColonnes(),!0));this.__LigneModifie([],this.m_tabLignes.length-1,undefined,!0)},n.prototype.vTableZROnSelectLigne=function(n,t){var r,i;try{r=this.m_bDansOnSelectLigneExterne;this.m_bDansOnSelectLigneExterne=!0;this._vSetValeurChampFormulaire(n);i=this._xnLigneWLLigne(n,this._nGetSelection());this.m_oSelection.bSelectAucun(t,i);this.m_oSelection.bSelectPlus(i,undefined,!0,t)}finally{this.m_bDansOnSelectLigneExterne=r}},n.prototype.vTableZROnValideLigne=function(n,t,i){if(t){var r=this._nGetColonneSelonAlias(t.m_sAliasAttribut);undefined!==r&&this.__OnLigneModifieFormulaire(n,[r,this._nGetSelection(),i])}},n.prototype.veGetModeSelection=function(){return this.m_oSelection.m_eTypeSelection},n.prototype.vbSaisieSansSelection=function(n){return clWDTableDefs.ms_nSelectionSans===this.veGetModeSelection()?this._oGetColonne(n).m_bSaisissable:!1},n.prototype.s_tabImageChargement=function(n){if(bIE&&n.readyState!=="complete")return null;var t=(bIEQuirks9Max?0:n.naturalWidth)||n.width||n.offsetWidth,i=(bIEQuirks9Max?0:n.naturalHeight)||n.height||n.offsetHeight;return 0===t||0===i?null:(n.setAttribute("data-webdev-dimensions-initiales",t+","+i),[t,i])},n.prototype.s_RedimImageChargement=function(t){var i=n.prototype.s_tabImageChargement(t),r,u;i&&(r=parseInt(t.getAttribute("data-webdev-mode-affichage"),10),u=!!(r&256),u||(t.parentNode.style.minHeight="10000px"),n.prototype.__s_RedimImage(t,t.parentNode,i,!0,!1))},n.prototype.s_bRedimImageDebutRedimCol=function(n){var i=n.getAttribute("data-webdev-dimensions-initiales"),t,r,u,f;return null!==i&&(t=String(i).split(","),t&&2===t.length&&(r=parseInt(t[1],10),u=parseInt(t[1],10),isNaN(r)||isNaN(u)||(f=n.style,n.style.height="0"))),!0},n.prototype.s_bRedimImageFinRedimCol=function(t){var u=t.getAttribute("data-webdev-dimensions-initiales"),i,r;return null!==u&&(i=String(u).split(","),i&&2===i.length&&(r=[parseInt(i[0],10),parseInt(i[1],10)],isNaN(r[0])||isNaN(r[1])||n.prototype.__s_RedimImage(t,t.parentNode,r,!1,!1))),!0},n.prototype.__s_RedimImage=function(t,i,r,u,f){var l,p,a,e,v,s,w;if(!bIEAvec11||clWDUtil.bEstDansDocument(i)){var b=parseInt(t.getAttribute("data-webdev-mode-affichage"),10),k=b&-257||WDTableColonne.prototype.ms_eAdapteCentre,y=!!(b&256),h=i.parentNode,c=h.clientWidth,o=h.clientHeight;if(y)bIEAvec11&&0===c&&(c=h.parentNode.clientWidth),o=Math.max(h.parentNode.clientHeight,o);else if(1e4===o)for(l=h.parentNode,p=0;l&&p<4;l=l.parentNode,p++)if(a=l.clientHeight,a&&a<o){o=a;break}if(bIEAvec11&&0===c&&0===o){f||clWDUtil.nSetTimeout(function(){n.prototype.__s_RedimImage(t,i,r,u,!0)},clWDUtil.ms_oTimeoutImmediat);return}e=i.style;u&&(e.backgroundRepeat="no-repeat",e.backgroundImage="url('"+t.src+"')",e.backgroundOrigin="content-box",e.boxSizing="border-box",y||(e.minHeight=""));v=n.prototype.__s_nRedimImageInterne(e,k,r,c,o);s=t.style;s.width=c+"px";s.padding=e.padding;s.boxSizing="border-box";s.marginTop="-"+e.paddingTop;s.marginRight="-"+e.paddingRight;s.marginBottom="-"+e.paddingBottom;s.marginLeft="-"+e.paddingLeft;w=o;y&&(1===v||(o=Math.max(i.parentNode.parentNode.clientHeight,i.parentNode.clientHeight)),w=Math.max(o,Math.round(r[1]*v)));s.height=w+"px";t.parentNode||i.appendChild(t)}},n.prototype.__s_nRedimImageInterne=function(t,i,r,u,f){var o=r[0],s=r[1],e=1;switch(i){case WDTableColonne.prototype.ms_eNormal:break;case WDTableColonne.prototype.ms_eCentre:t.backgroundPosition="center center";break;case WDTableColonne.prototype.ms_eEtire:t.backgroundSize="100% 100%";break;case WDTableColonne.prototype.ms_eRepete:t.backgroundRepeat="repeat";break;case WDTableColonne.prototype.ms_eHomothetiqueCentre:t.backgroundPosition="center center";case WDTableColonne.prototype.ms_eHomothetique:t.backgroundSize="contain";u<o&&(e=u/o);break;case WDTableColonne.prototype.ms_eHomothetiqueCentreLarge:t.backgroundPosition="center center";case WDTableColonne.prototype.ms_eHomothetiqueLarge:t.backgroundSize="cover";break;case WDTableColonne.prototype.ms_eAdapte:u<o||f<s?e=n.prototype.__s_nRedimImageInterne(t,WDTableColonne.prototype.ms_eHomothetique,r,u,f):(t.backgroundSize="",e=n.prototype.__s_nRedimImageInterne(t,WDTableColonne.prototype.ms_eNormal,r,u,f));break;default:case WDTableColonne.prototype.ms_eAdapteCentre:u<o||f<s?e=n.prototype.__s_nRedimImageInterne(t,WDTableColonne.prototype.ms_eHomothetiqueCentre,r,u,f):(t.backgroundSize="",e=n.prototype.__s_nRedimImageInterne(t,WDTableColonne.prototype.ms_eCentre,r,u,f))}return e},n.prototype._nGetNbColonnes=function(){return this.m_tabColonnes.length},n.prototype._nGetNbRuptures=function(){return this.m_tabRuptures.length},n.prototype._nGetNbLignes=function(){return this.m_tabLignes.length},n.prototype._nGetNbLignesWL=function(){return this.m_nNbLignesWL},n.prototype._oGetColonne=function(n){return this.m_tabColonnes[n]},n.prototype._nGetColonneSelonAlias=function(n){return clWDUtil.WDObjet.prototype.s_nChercheParAlias(this.m_tabColonnes,n)},n.prototype._nGetRuptureSelonAlias=function(n){return clWDUtil.WDObjet.prototype.s_nChercheParAlias(this.m_tabRuptures,n)},n.prototype.__nGetAttributSelonChampEtPropriete=function(t,i){return clWDUtil.nDansTableauFct(this.m_tabColonnes,function(r){return r instanceof WDAttribut&&r.m_sAliasChampAssocie===t&&r.m_eProprieteAssocie===n.prototype.s_eGetProprietePrincipale(i,r.m_eTypeChampAssocie)||r instanceof WDTableColonne&&r.m_sAlias===t&&WDChamp.prototype.XML_CHAMP_PROP_NUM_VALEUR===i})},n.prototype.s_eGetProprietePrincipale=function(n,t){switch(t){case WDChamp.prototype.ms_nIDObjetLibelle:switch(n){case WDChamp.prototype.XML_CHAMP_PROP_NUM_LIBELLE:return WDChamp.prototype.XML_CHAMP_PROP_NUM_VALEUR}break;case WDChamp.prototype.ms_nIDObjetBouton:switch(n){case WDChamp.prototype.XML_CHAMP_PROP_NUM_LIBELLE:return WDChamp.prototype.XML_CHAMP_PROP_NUM_VALEUR}break;case WDChamp.prototype.ms_nIDObjetImage:case this.XML_CHAMP_TYPE_MAPAREA:case this.XML_CHAMP_TYPE_VIGNETTE:case this.XML_CHAMP_TYPE_GRAPHE:case this.XML_CHAMP_TYPE_CAPTCHA:case WDChamp.prototype.ms_nIDObjetCodeBarre:switch(n){case WDChamp.prototype.XML_CHAMP_PROP_NUM_IMAGE:return WDChamp.prototype.XML_CHAMP_PROP_NUM_VALEUR;case WDChamp.prototype.XML_CHAMP_PROP_NUM_LIBELLE:return WDChamp.prototype.XML_CHAMP_PROP_NUM_TEXTEALTERNATIF}}return n},n.prototype.__RupturesEntreLignes=function(n,t,i,r){var u=WDLigne.prototype.ms_nTous,h=this.m_tabRuptures,o,e;if(n&&t){u=WDLigne.prototype.ms_nRien;for(var c=n.tabGetValeurs(),l=t.tabGetValeurs(),a=this._nGetNbRuptures(),s=!1,f=0;f<a;f++)o=h[f].m_nColonne,(s||c[o]!==l[o])&&(u|=1<<f,s=!0)}else u=WDLigne.prototype.ms_nTous;n&&(e=n.nGetRuptures(!1),n.SetRupturesBas(u),this.__AppelPCodeAffichageRuptures(i,u,e,!1));t&&(e=t.nGetRuptures(!0),t.SetRupturesHaut(u),this.__AppelPCodeAffichageRuptures(r,u,e,!0))},n.prototype.__AppelPCodeAffichageRuptures=function(n,t,i,r){for(var f=this.m_tabRuptures,e=f.length,u=0;u<e;u++)t&1<<u&&this.__AppelPCodeAffichage(n,f[u].RecuperePCode(this.ms_nEventNavAffichageLigne,r))},n.prototype.__TableAfficheCalculs=function(n){for(var r=this.m_tabLignes,u=this._nGetNbLignes(),e=this.RecuperePCode(this.ms_nEventNavAffichageLigne),i,f,t=n;t<u;t++)r[t].bGetClearPCodeAffichage()&&this.__AppelPCodeAffichage(t,e);if(0<this._nGetNbRuptures())for(t=0<n?n-1:n;t<u;t++)i=r[t],i.bGetClearModifieRuptures()&&(0===t&&this.__RupturesEntreLignes(undefined,i,undefined,0),f=t<u-1?r[t+1]:undefined,this.__RupturesEntreLignes(i,f,t,t+1))},n.prototype.__AppelPCodeAffichage=function(n,t){if(t!==clWDUtil.m_pfVide)try{var i=this.m_bEnPCodeAffichageLigne;return this.m_bEnPCodeAffichageLigne=!0,this.__oAppelPCodeSurLigne(n,t)}finally{this.m_bEnPCodeAffichageLigne=i}},n.prototype.__oAppelPCodeSurLigne=function(n,t,i){if(t!==clWDUtil.m_pfVide)try{var r=this.nGetForceSelection();return this.ForceSelection(n),this._voAppelPCodeSurLigne(n,t,i)}finally{this.m_oSelection.ForceSelection(r)}},n.prototype._voAppelPCodeSurLigne=function(n,t,i){return t(i)},n.prototype.__OnLigneModificationRuptures=function(n){t===n&&(n=0);var i=this.m_tabLignes[n];i&&i.SetModifieRuptures(!0)},n.prototype.__OnLigneModification=function(n,t,i,r){var u=this.m_tabLignes[n],e,f;!r&&u.bGetLigneVirtuelle()&&(u.RAZLigneVirtuelle(),this.__AjouteLigneVirtuelle(),this._OnNbLignesChange());this.__OnLigneModificationRuptures(n-1);this.__OnLigneModificationRuptures(n);this._bAvecFiltre()&&(e=u.bGetVerifieFiltre(),f=this._bVerifieFiltre(u.tabGetValeurs()),u.SetVerifieFiltre(f),e!==f&&this._OnNbLignesChange());this._TableAfficheLigne(n,t,i)},n.prototype.__LigneModifie=function(n,t,i,r){for(var e=this.m_tabLignes[t].tabGetValeurs(),f=this.m_tabColonnes,o=f.length,u=0;u<o;u++)e[u]=f[u].oGetValeurInterne(n[u],r);this.__OnLigneModification(t,undefined,i,r)},n.prototype._HTMLAffiche=function(n,t){if(clWDUtil.SupprimeFilsEtOnFocus(n,!1),bIE&&clWDUtil.bBaliseEstTag(n,"table")){var i=(n.outerHTML+"").split("><");n.outerHTML=i[0]+">"+t.join("")+"<"+i[i.length-1]}else n.innerHTML=t.join("");this._vLiaisonHTML()},n.prototype.__TableAffiche=function(n){var u={},r,i;this._vPreAffiche(u);this.__TableAfficheCalculs(n);for(var f=[],o=this.m_tabLignes,e=0,s=this._nGetNbLignes(),t=0;t<s;t++)(r=o[t],r.bGetVerifieFiltre())&&(this._vHTMLGenereLigne(t,e,r,f),e++);this._HTMLAffiche(this.m_oHote,f);bIEQuirks&&(i=_JGE(this.m_sAliasChamp,document,!0,!1),i&&clWDUtil.oGetCurrentStyle(i).position==="absolute"&&(i.className=i.className));this._vPostAffiche(u);clWDUtil.m_oNotificationsAjoutHTML.LanceNotifications(this,this.m_oHote)},n.prototype._vPreAffiche=function(n){this.__MemoriseFocus(n)},n.prototype.__MemoriseFocus=function(n){var t,i,r;try{t=document.activeElement;t&&clWDUtil.bEstFils(t,this.m_oHote)&&(i=t.name,i&&i.length&&(r=clWDUtil.nDansTableau(document.getElementsByName(i),t),clWDUtil.nElementInconnu===r&&(r=0),n.m_sFocusNom=i,n.m_nFocusIndice=r))}catch(u){}},n.prototype._vPostAffiche=function(n){this.__SetOnBlurChange();this.__OnAffichageLignes();this.__ReplaceFocus(n)},n.prototype.__SetOnBlurChange=function(){for(var f=clWDUtil.tabGetElements(this.m_oHote,!1),o=f.length,n,i,r,u,e,t=0;t<o;t++)n=f[t],i=[],clWDUtil.bEstAliasAttributZR(n,i)&&(r=this._nLigneWLLigne(i[0]),u=this._nGetColonneSelonAlias(i[1]),r!==undefined&&u!==undefined&&(e=undefined!==n.onchange?"onchange":"onblur",clWDUtil.SetOnXxx(n,e,this,this.__OnLigneModifieFormulaire,[u,r],!0),undefined!==n.oninput&&clWDUtil.SetOnXxx(n,"oninput",this,this.__OnLigneModifieFormulaire,[u,r],!0)))},n.prototype.__OnLigneModifieFormulaire=function(n,i){var f=i[0],o=i[1],u,e=this.m_tabColonnes[f],r,s;if(2<i.length)u=e.oGetValeurInterne(i[2]);else{r=clWDUtil.oGetTarget(n);u=r.value;switch(r.type.toLowerCase()){case"checkbox":u=!!r.checked;break;case"radio":if(!r.checked)return;break;case"select-multiple":case"select-one":u=-1!==r.selectedIndex?parseInt(r.options[r.selectedIndex].value,10):-1;break;case"text":e.m_pfConversionDepuisAffichage&&(u=e.m_pfConversionDepuisAffichage(u))}}this.m_tabLignes[o].tabGetValeurs()[f]=u;s=clWDUtil.bForEach(this.m_tabRuptures,function(n){return n.m_nColonne!==f});this.__OnLigneModification(o,t,s)},n.prototype.__OnAffichageLignes=function(){for(var i=this._nGetSelection(),t=0,r=this.m_tabLignes,u=this._nGetNbLignes(),n=0;n<u;n++)r[n].bGetVerifieFiltre()&&(t++,this.m_tabChampsFils._AppelMethodePtr(WDChamp.prototype.OnLigneTableZRAffiche,[t,n===i]))},n.prototype.__ReplaceFocus=function(n){n.m_nFocusIndice!==undefined&&this.nSetTimeoutUnique("__SetFocus",clWDUtil.ms_oTimeoutImmediat,n)},n.prototype.__SetFocus=function(n){if(n.m_nFocusIndice!==undefined)try{document.getElementsByName(n.m_sFocusNom)[n.m_nFocusIndice].focus()}catch(t){}},n.prototype._OnNbLignesChange=function(){var n,i,t,r;if(this._bAvecFiltre())for(n=0,i=this.m_tabLignes,r=this._nGetNbLignes(),t=0;t<r;t++)i[t].bGetVerifieFiltre()&&n++;else n=this._nGetNbLignes();this.m_bSaisieCascade&&n--;this.m_nNbLignesWL=n},n.prototype._bLigneSupprime=function(n){var t=this.m_tabLignes[n];return t.OnSupprime(),this.m_tabLignes.splice(n,1),t.bGetLigneVirtuelle()&&this.__AjouteLigneVirtuelle(),this._OnNbLignesChange(),this.m_oSelection.OnLigneSupprime(n),this.__OnLigneModificationRuptures(n-1),!0},n.prototype._LigneSupprimeTout=function(){this.m_oSelection.bSelectAucun();clWDUtil.bForEach(this.m_tabLignes,function(n){return n.OnSupprime(),!0});this.m_tabLignes.length=0;this.m_bSaisieCascade&&this.__AjouteLigneVirtuelle();this._OnNbLignesChange();this._TableAffiche()},n.prototype.__s_nTriCompare=function(n,t,i){var r,f;if(n.bGetLigneVirtuelle())return 1;if(t.bGetLigneVirtuelle())return-1;for(var e=n.tabGetValeurs(),o=t.tabGetValeurs(),s=i.length,u=0;u<s;u++)if(r=i[u],f=r.m_fCompare(e[r.m_nColonne],o[r.m_nColonne]),0!==f)return r.m_bCroissant?f:-f;return 0},n.prototype.__nLigneCherche=function(n,i,r,u){var e,s,h,f,c,o;if(t!==u)for(e=[],s=this.m_tabColonnes,clWDUtil.bForEach(n,function(n){var t=s[n];return e.push({oColonne:t,nColonne:n,oRecherche:t.oGetValeurInterne(i),fCompare:t.fGetCompare(r)}),!0}),h=this.m_tabLignes,c=this._nGetNbLignes(),f=u;f<c;f++)if((o=h[f],o.bGetVerifieFiltre())&&!clWDUtil.bForEach(e,function(n){return 0!==n.fCompare(n.oColonne.oGetValeurAvecLigne(n.nColonne,o,!1),n.oRecherche)}))return f;return t},n.prototype._vsLitPropriete=function(n,t,i,r,u){switch(r){case this.XML_CHAMP_PROP_NUM_VALEUR:return t+1;case this.XML_CHAMP_PROP_NUM_COULEURFOND:return i.m_sCouleurFond!==undefined?i.m_sCouleurFond:"";case this.ms_nAttributRuptureLigneDebut:return 0==t%this.m_nNbLignesLogiquesParLignePhysique;case this.ms_nAttributRuptureLigneFin:return t%this.m_nNbLignesLogiquesParLignePhysique==this.m_nNbLignesLogiquesParLignePhysique-1;case this.ms_nAttributLigneRepliee:return!this.m_tabLignes[n].bGetDeroule();case this.ms_nAttributIncludeHautRupture:return this.__bGetRuptureVisible(n,u,!0);case this.ms_nAttributIncludeBasRupture:return this.__bGetRuptureVisible(n,u,!1);case this.ms_nAttributLignePaire:return 1==t%2;case this.ms_nAttributSelected:return this.m_oSelection.bGetLigneEstSelectionnee(n)?"SELECTED":"";case this.ms_nAttributCodeHTML30:return this.__nGetNbCOLPSANPourCelluleSurEntete(u);case this.ms_nAttributCodeHTML31:return this.__nGetColonneRedimPourCelluleSurEntete(u);case this.ms_nAttributCodeHTML32:return this._vnGetColSpanRupture();case this.ms_nAttributExiste:return this.__bGetAttributAutomatiqueExiste(u);default:return""}},n.prototype.__bGetRuptureVisible=function(n,t,i){return this.m_tabRuptures[t].bVisible(i)?this.m_tabLignes[n].bGetRuptureVisible(t,i):!1},n.prototype.__nGetNbCOLPSANPourCelluleSurEntete=function(n){for(var u=this._nGetNbColonnes(),t=n%u,o=(n-t)/u,f=this.m_tabSurEntetes[o][t],e=0,i=0,r;0<f;)r=this._oGetColonne(t),r.bGetVisible()&&(e=i+1,i=i+1,r.m_bAjustable&&i++),t++,f--;return e},n.prototype.__nGetColonneRedimPourCelluleSurEntete=function(n){for(var u,r=this._nGetNbColonnes(),t=n%r,f=(n-t)/r,e=this.m_tabSurEntetes[f][t],i=t+e-1;t<=i;i--)if(u=this._oGetColonne(t),u.bGetVisible())return i;return t},n.prototype._vnGetColSpanRupture=function(){return""},n.prototype.__bGetAttributAutomatiqueExiste=function(n){return!!this._nGetColonneSelonAlias(n)},n.prototype._bVerifieFiltre=function(n){return clWDUtil.bForEach(this.m_tabFiltre,function(t){return t.m_fFiltre(n[t.m_nColonne],t.m_sValeur)})},n.prototype._oGetProprieteColonneAvecIndice=function(n,t,i,r,u){return this._oGetColonne(n).vsLitPropriete(this,n,t,i,this.m_tabLignes[t],r,u,!1)},n.prototype._voGetProprieteColonneAvecIndicePourWL=function(n,t,i){return this._oGetProprieteColonneAvecIndice(n,t,t,i,!1)},n.prototype._xLigneModifie=function(n,t){var i=this._xnLigneWLLigne(t,this._nGetSelection());this.__LigneModifie(n,i)},n.prototype._nLigneInsere=function(n,t,i){var r=this._nLigneWLLigne(i,undefined,undefined,undefined,undefined,3===arguments.length),f,u,e,s,o;if(r===undefined&&this.m_bSaisieCascade&&(r=this._nGetNbLignes()-1),f=new this._vLigne(this._nGetNbColonnes()),r!==undefined?this.m_tabLignes.splice(r,0,f):(this.m_tabLignes.push(f),r=this._nGetNbLignes()-1),this._OnNbLignesChange(),this.__LigneModifie(t,r),this.m_oSelection.OnLigneInsere(r),n){if(this._TriEncore(),this.m_tabLignes[r]!==f)for(e=this._nGetNbLignes(),u=0;u<e;u++)if(this.m_tabLignes[u]===f){r=u;break}this.__LigneModifie(t,r)}if(e=this._nGetNbRuptures(),0<e){if(0<r)for(s=this.m_tabLignes[r-1],u=0;u<e;u++)if(f.bGetRuptureDirect(u,!0))break;else f.CopieEnrouleDeroule(s,u);if(r<this._nGetNbLignes()-1)for(o=this.m_tabLignes[r+1],u=0;u<e;u++)if(o.bGetRuptureDirect(u,!0))break;else f.CopieEnrouleDeroule(o,u)}return this._nLigneLigneWL(r)},n.prototype._TableAffiche=function(n,t){this.m_bEnPCodeAffichageLigne===undefined&&(this.m_nLigneAfficheSuivante=0,undefined!==n&&(this.m_nTAOptions|=n,this.m_nTAParametre=t),this.SetTimeoutUniqueO("_Affiche"))},n.prototype._TableAfficheLigne=function(n,i,r){if(!r&&this.m_bEnPCodeAffichageLigne===undefined){var u=n;0<n&&u--;this.m_nLigneAfficheSuivante=this.m_nLigneAfficheSuivante===undefined?u:Math.min(u,this.m_nLigneAfficheSuivante);undefined!==i&&t!==i&&(this.m_nTAOptions|=clWDTableDefs.ms_nOptionTAMontreLigne,this.m_nTAParametre=i);this.SetTimeoutUniqueO("_Affiche")}},n.prototype._Affiche=function(){this.AnnuleTimeXXX("_Affiche",!1);var n;this.m_nTAOptions&clWDTableDefs.ms_nOptionTAPreserveScroll&&(n=this.m_oHote.parentNode.scrollTop);this.m_nTAOptions&clWDTableDefs.ms_nOptionTARedessineTitre&&this._vTableAfficheTitres();this.__TableAffiche(this.m_nLigneAfficheSuivante);this.m_nTAOptions&clWDTableDefs.ms_nOptionTAMontreLigne&&(n=this.oGetIDElement(this._nLigneLigneWL(this.m_nTAParametre)).offsetTop);undefined!==n&&(this.m_oHote.parentNode.scrollTop=n);this.m_nTAParametre=null;this.m_nTAOptions=0;this.m_oCelluleSaisie&&this.m_oCelluleSaisie.OnMAJDonnees()},n.prototype._vTableAfficheTitres=clWDUtil.m_pfVide,n.prototype.OnChangementSelection=function(n,t,i){if(t&&this.RecuperePCode(this.ms_nEventNavSelectLigne)(i),this.m_bDansSelectionExterne&&this._vbAvecCouleurDeFondSelection()){this._vOnChangementSelectionSansRedessin(n);return}this._TableAfficheLigne(n)},n.prototype._vOnChangementSelectionSansRedessin=clWDUtil.m_pfVide,n.prototype._nLigneDeplace=function(n,i,r,u){var o=i,f=this.m_tabLignes,e=f[n];return r?(f[n]=f[i],f[i]=e,this.__OnLigneModification(n),this.__OnLigneModification(i,u?i:t)):(f.splice(n,1),n<i&&i--,f.splice(i,0,e),this.__OnLigneModification(i,u?i:t),this.__OnLigneModificationRuptures(n-1)),this.m_oSelection.OnLigneDeplace(n,o,r),this._nLigneLigneWL(i)},n.prototype._nGetSelection=function(){return this.m_oSelection.nGetSelection()},n.prototype.nGetForceSelection=function(){return this.m_oSelection.nGetForceSelection()},n.prototype.ForceSelection=function(n){return this.m_oSelection.ForceSelection(n)},n.prototype._nIndiceRupture=function(n,i){var u=this._nGetRuptureSelonAlias(n),f,r;if(u!==undefined)for(f=this.m_tabLignes,r=i;0<=r;r--)if(f[r].bGetRupture(u,!0))return this._nLigneLigneWL(r);return t},n.prototype._xnGetColonneSelonAlias=function(n){var t=this._nGetColonneSelonAlias(n);if(undefined===t)throw new WDErreur(302,n);return t},n.prototype._xoGetColonneSelonAlias=function(n){return this.m_tabColonnes[this._xnGetColonneSelonAlias(n)]},n.prototype._Tri=function(n){var t,i,u,e,f,r;this._TriAnnule();t=!0;switch(n){case"-":t=!1;case"+":for(u=this._nGetNbColonnes(),i=0;i<u;i++)this._ActiveTri(i,t);break;default:for(e=n.split("\t"),u=e.length,f=0;f<u;f++){r=e[f];t=!0;switch(r.substring(0,1)){case"-":t=!1;case"+":r=r.substring(1)}i=this._xnGetColonneSelonAlias(r);this._ActiveTri(i,t)}}this._TriEncore()},n.prototype._ActiveTri=function(n,t){var i=this.m_tabColonnes[n];this.m_tabTri.push({m_fCompare:i.fGetCompare(clWDUtil.nRechercheIdentique),m_nColonne:n,m_bCroissant:t});this._vInvalidePourTRF(n,t)},n.prototype._TriSurUneColonne=function(n,t){this._TriAnnule();this._ActiveTri(n,t);this._TriEncore()},n.prototype._TriEncore=function(){var t=this.m_tabTri;0<t.length&&(this.m_tabLignes.sort(function(){return n.prototype.__s_nTriCompare(arguments[0],arguments[1],t)}),this.m_oSelection.ReinitSelection(0))},n.prototype.SelectExterne=function(n){try{var t=this.m_bDansSelectionExterne;this.m_bDansSelectionExterne=!0;this.m_oSelection.ReinitSelectionSansReselection(this._nLigneWLLigne(n))}finally{this.m_bDansSelectionExterne=t}},n.prototype._vInvalidePourTRF=clWDUtil.m_pfVide,n.prototype._TriAnnule=function(){for(var t=this.m_tabTri,i=t.length,n=0;n<i;n++)this._vInvalidePourTRF(t[n].m_nColonne);this.m_tabTri.length=0},n.prototype._bAvecFiltre=function(){return 0<this.m_tabFiltre.length},n.prototype._bFiltreAnnule=function(){var n=this._bAvecFiltre();return this.m_tabFiltre.length=0,n},n.prototype._xnLigneCherche=function(n,t,i,r){var u=this._xnGetColonneSelonAlias(n),f=this.__nLigneCherche([u],t,i,r);return this._nLigneLigneWL(f)},n.prototype._xnLigneCherchePartout=function(n,t,i){var r=[],u;return clWDUtil.bForEach(this.m_tabColonnes,function(n,t){return function(){if(n instanceof WDAttribut)switch(n.m_eProprieteAssocie){case WDChamp.prototype.XML_CHAMP_PROP_NUM_VALEUR:case WDChamp.prototype.XML_CHAMP_PROP_NUM_LIBELLE:case WDChamp.prototype.XML_CHAMP_PROP_NUM_CONTENU:return!0}else if(n instanceof WDTableColonne)return n.bGetVisible();return!1}()&&r.push(t),!0}),u=this.__nLigneCherche(r,n,t,i),this._nLigneLigneWL(u)},n.prototype._EnrouleDerouleI=function(n,t,i,r,u){var o=this.m_tabLignes[n],s,f,h,e;if(this.__RupturesEntreLignes(this.m_tabLignes[n-1],o,n-1,n),o.bGetRupture(t,!0)){for(o.EnrouleDeroule(t,i,r),s=o,h=this._nGetNbLignes(),f=n+1;f<h;f++)if(e=this.m_tabLignes[f],this.__RupturesEntreLignes(s,e,f-1,f),e.bGetRupture(t,!0))break;else e.EnrouleDeroule(t,i,r),s=e;u&&this._TableAfficheLigne(n)}},n.prototype._xEnrouleDeroule=function(n,t,i){var f=this._xnLigneWLLigne(n,this._nGetSelection()),r,u;t===undefined?(r=0<this._nGetNbRuptures()?0:undefined,u=!0):(r=this._nGetRuptureSelonAlias(t),u=!1);r!==undefined&&0<=r&&this._EnrouleDerouleI(f,r,i,u,!0)},n.prototype._EnrouleDerouleTout=function(n){for(var u=this._nGetNbLignes(),i,r,t=0;t<u;t++)for(r=this._nGetNbRuptures(),i=0;i<r;i++)this._EnrouleDerouleI(t,i,n,!0,!1);this._TableAffiche()},n.prototype._xnSelectPlusMoins=function(n,i,r){for(var f=r.length,u=0;u<f;u++)r[u]=this._xnLigneWLLigne(r[u],this._nGetSelection());return this.m_oSelection.xSelectPlusMoins(n,i,r),r.length?r[0]:t},n.prototype.sGetFiltrePourColonne=function(n){var t=clWDUtil.oDansTableauFct(this.m_tabFiltre,this.__s_bCompareRTFParColonne,n,undefined);return undefined!==t?t.m_sValeur:""},n.prototype._bDesactiveFiltreUneColonne=function(n){var i=clWDUtil.nDansTableauFct(this.m_tabFiltre,this.__s_bCompareRTFParColonne,n),t;return clWDUtil.nElementInconnu!==i?(this.m_tabFiltre.splice(i,1),t=this.m_tabColonnes[n],t.SetFiltre(t.ms_nFiltreRecherche),!0):!1},n.prototype.__s_bCompareRTFParColonne=function(n,t){return n.m_nColonne===t},n.prototype._ActiveFiltre=function(n,t,i){var r=WDTableColonne.prototype.s_xfGetFiltre(t);this._bDesactiveFiltreUneColonne(n);this.m_tabColonnes[n].SetFiltre(t);this.m_tabFiltre.push({m_nColonne:n,m_fFiltre:r,m_nFiltre:t,m_sValeur:i});this._Refiltre(!0,!0)},n.prototype._Refiltre=function(n,t){var u,i,f,r;if(n){for(u=this.m_tabLignes,f=this._nGetNbLignes(),i=0;i<f;i++)r=u[i],r.SetVerifieFiltre(this._bVerifieFiltre(r.tabGetValeurs()));this._OnNbLignesChange();t&&this._TableAffiche();this.m_oSelection.ReinitSelection(0);this._vInvalidePourTRF()}},n.prototype.nGetLigneAfficheeAutour=function(n){for(var r=this.m_tabLignes,u=this._nGetNbLignes(),i=n;i<u;i++)if(r[i].bGetVerifieFiltre())return i;for(i=n-1;0<=i;i--)if(r[i].bGetVerifieFiltre())return i;return t},n.prototype._nLigneWLLigne=function(n,i,r,u,f,e){var o,s,c,h,l;if(n===undefined?o=i:(s=parseInt(n,10),o=u&&s===t?this._nGetSelection():isNaN(s)?s:e&&0===s?1:s-1),o!==undefined){if(!isNaN(o)&&0<=o&&(o<this._nGetNbLignesWL()||f&&this.m_bSaisieCascade&&o===this._nGetNbLignesWL()))if(this._bAvecFiltre()){for(c=this.m_tabLignes,l=c.length,h=0;h<=l;h++)if(c[h].bGetVerifieFiltre()&&0==o--)return h}else return o;return r}return o},n.prototype._xnLigneWLLigne=function(n,t,i,r){var f=this._nGetNbLignes(),u;if(0===f)throw new WDErreur(300,n);if(u=this._nLigneWLLigne(n,t,i,r),u===i)throw new WDErreur(301,n,1,f);return u},n.prototype._nLigneLigneWL=function(n){if(n!==t){if(this._bAvecFiltre()){for(var u=this.m_tabLignes,r=0,i=0;i<=n;i++)u[i].bGetVerifieFiltre()&&r++;return r}return n+1}return t},n.prototype.Ajoute=function(n){return t!==this._nLigneInsere(!0,(""+n).split("\t"))},n.prototype.AjouteLigne=function(){return this._nLigneInsere(!0,this.__tabArgumentsVersTableau(arguments,0))},n.prototype.Modifie=function(n,t){this._xLigneModifie((""+n).split("\t"),t)},n.prototype.ModifieLigne=function(n){this._xLigneModifie(this.__tabArgumentsVersTableau(arguments,1),n)},n.prototype.Insere=function(n,i){return t!==this._nLigneInsere(!1,(""+n).split("\t"),i)},n.prototype.InsereLigne=function(n){this._nLigneInsere(!1,this.__tabArgumentsVersTableau(arguments,1),n)},n.prototype.DeplaceLigne=function(n,t,i){var r=this._xnLigneWLLigne(n,undefined,undefined,!0),u=this._xnLigneWLLigne(t,undefined,undefined,!0);return r!==u?this._nLigneDeplace(r,u,0!=(i&this.ms_nTdEchange),0!=(i&65536)):n},n.prototype.Supprime=function(n){var t=this._xnLigneWLLigne(n,this._nGetSelection());this._bLigneSupprime(t);this._TableAffiche()},n.prototype.SupprimeTout=function(){this._LigneSupprimeTout();this._TableAffiche()},n.prototype.nGetPosition=function(){return this._InfoXY(1,0,0,this.m_oHote.parentNode)},n.prototype.SetPosition=function(n,t){var f=this._xnLigneWLLigne(n,this._nGetSelection()),u=document.getElementById(this.m_sAliasChamp+"_"+(f+1)),r,i;if(u){if(r=!0,undefined!==t)if(i=String(t),"Visible"===i)r={block:"nearest",inline:"nearest"};else if("Premier"!==i)throw new WDErreur(303,i);u.scrollIntoView(r)}},n.prototype.Occurrence=function(n){n===undefined&&(n=1);switch(n){case 1:return this._nGetNbLignesWL();case 2:return this._nGetNbColonnes();default:return t}},n.prototype.IndiceRupture=function(n,t){var i=this._xnLigneWLLigne(t,this._nGetSelection());return this._nIndiceRupture(n,i)},n.prototype.Trie=function(n,t){t?this._Tri(n):this._TriAnnule()},n.prototype.Cherche=function(n,i,r,u){var f=this._nLigneWLLigne(u,0,t);switch(r){default:case clWDUtil.nRechercheDefaut:r=clWDUtil.nRechercheIdentique;break;case!1:r=clWDUtil.nRechercheCommencePar;break;case!0:r=clWDUtil.nRechercheIdentique;break;case clWDUtil.nRechercheCommencePar:case clWDUtil.nRechercheIdentique:case clWDUtil.nRechercheContient:}return this._xnLigneCherche(n,i,r,f)},n.prototype.CherchePartout=function(n,i,r){var u=this._nLigneWLLigne(r,0,t);switch(i){default:case clWDUtil.nRechercheDefaut:i=clWDUtil.nRechercheContient;break;case clWDUtil.nRechercheCommencePar:case clWDUtil.nRechercheIdentique:case clWDUtil.nRechercheContient:}return this._xnLigneCherchePartout(n,i,u)},n.prototype.Enroule=function(n,t){this._xEnrouleDeroule(n,t,!1)},n.prototype.EnrouleTout=function(){this._EnrouleDerouleTout(!1)},n.prototype.Deroule=function(n,t){this._xEnrouleDeroule(n,t,!0)},n.prototype.DerouleTout=function(){this._EnrouleDerouleTout(!0)},n.prototype.EnrouleDeroule=function(n,t,i){if(i)for(var r=i.target,u=i.currentTarget,f=document.body;r&&r!==u&&r!==f;){if(r.hasAttribute&&r.hasAttribute("onclick")||r.onclick)return;r=r.parentNode}this._xEnrouleDeroule(n,t)},n.prototype.bGetEnrouleRupture=function(n,t){for(var i=this._nGetRuptureSelonAlias(n),r=this._xnLigneWLLigne(t,this._nGetSelection()),u=this.m_tabLignes[r];0<=i;i--)if(u.bEstEnroule(i))return!0;return!1},n.prototype.SetEnrouleRupture=function(n,t,i){this._xEnrouleDeroule(t,n,!i)},n.prototype.DesactiveFiltre=function(n){var t,i;undefined!==n?(i=this._xnGetColonneSelonAlias(n),t=this._bDesactiveFiltreUneColonne(i)):t=this._bFiltreAnnule();this._Refiltre(t,!0)},n.prototype.Select=function(n,t){var i=undefined!==n?n-1:0;return this._nLigneLigneWL(this.m_oSelection.xnSelect(i,t))},n.prototype.SelectMoins=function(){this._xnSelectPlusMoins(this.m_oSelection.bSelectMoins,this.m_oSelection.bSelectAucun,arguments)},n.prototype.SelectOccurrence=function(n){var t=undefined===n?this.ms_nTsLigne:n;return this.m_oSelection.xnSelectOccurrence(t)},n.prototype.SelectPlus=function(){var n=this._xnSelectPlusMoins(this.m_oSelection.bSelectPlus,this.m_oSelection.SelectTous,arguments);clWDTableDefs.ms_nSelectionSimple!==this.veGetModeSelection()&&t!==n&&this._TableAfficheLigne(n,n)},n.prototype.SupprimeSelect=function(){for(var t=[],i=this.m_oSelection.xnSelectOccurrence(this.ms_nTsLigne),n=0;n<i;n++)t.push(this.m_oSelection.xnSelect(n));clWDUtil.bForEachThis(t,this,this._bLigneSupprime)},n.prototype.ActiveFiltre=function(n,t,i){this._ActiveFiltre(this._xnGetColonneSelonAlias(n),t,i)},n.prototype.EchangeLigne=function(n,t){this.DeplaceLigne(n,t,this.ms_nTdEchange)},n.prototype.oGetValeurColonne=function(n,t,i){var r=this._xnGetColonneSelonAlias(n),u;return t!==this.XML_CHAMP_PROP_NUM_VALEUR&&undefined===i?this._oGetColonne(r).vsLitPropriete(this,r,undefined,undefined,undefined,t,!1,!1):(u=this._xnLigneWLLigne(i,this._nGetSelection()),this._voGetProprieteColonneAvecIndicePourWL(r,u,t))},n.prototype.oGetProprieteCellule=function(n,t,i){if(n<0||this._nGetNbColonnes()<n)throw new WDErreur(301,n,1,this._nGetNbColonnes());var r=n-1,u=this._xnLigneWLLigne(t,this._nGetSelection());return this._voGetProprieteColonneAvecIndicePourWL(r,u,i)},n.prototype.oSetProprieteColonne=function(n){var t=this._xnGetColonneSelonAlias(n);return this._oGetColonne(t)},n.prototype.oGetLigne=function(n){var t=this._xnLigneWLLigne(n,this._nGetSelection()),i=this.m_oSelection.bGetLigneEstSelectionnee(t)?this.m_oStyleLigneSelectionne:undefined,r=0==t%2?this.m_oStyleLigneImpair:this.m_oStyleLignePair;return this.m_tabLignes[t].oGetPropriete(i,r)},n.prototype.oGetLigneSet=function(n){var t=this._xnLigneWLLigne(n,this._nGetSelection());return this.__OnLigneModification(t),this.m_tabLignes[t]},n.prototype.tabGetLigneSet=function(n,t){var i=this.oGetLigneSet(t);switch(n){case this.XML_CHAMP_PROP_NUM_VALEUR:return i.tabGetValeurs();default:return i.tabGetValeursUnePropriete(n)}},n.prototype.__oGetValeurDefautAttributAutomatique=function(n,t){switch(t){default:case this.XML_CHAMP_PROP_NUM_VALEUR:return"";case this.XML_CHAMP_PROP_NUM_COULEUR:return"#000000";case this.XML_CHAMP_PROP_NUM_COULEURFOND:return"transparent";case this.XML_CHAMP_PROP_NUM_ETAT:return 0;case this.XML_CHAMP_PROP_NUM_VISIBLE:return!0;case this.XML_CHAMP_PROP_NUM_IMAGE:return"";case this.XML_CHAMP_PROP_NUM_POLICEGRAS:return!1;case this.XML_CHAMP_PROP_NUM_POLICEITALIQUE:return!1;case this.XML_CHAMP_PROP_NUM_POLICESOULIGNE:return!1;case this.XML_CHAMP_PROP_NUM_POLICETAILLE:return 12;case this.XML_CHAMP_PROP_NUM_VIGNETTE:return""}},n.prototype.SetAttributAutomatique=function(n,t,i,r,u,f){var e=this.__nGetAttributSelonChampEtPropriete(n,t),o,s;clWDUtil.nElementInconnu===e&&(e=this._nGetNbColonnes(),o=new this._vNewAttributAutomatique("ATT_"+n+"_"+t,u,[t,n,r]),this.m_tabColonnes.push(o),s=this.__oGetValeurDefautAttributAutomatique(n,t),clWDUtil.bForEach(this.m_tabLignes,function(n){return n.tabGetValeurs().push(s),!0}));this.tabGetLigneSet(this.XML_CHAMP_PROP_NUM_VALEUR,i)[e]=f},n.prototype.oGetAttributAutomatique=function(n,t,i){var u=this.__nGetAttributSelonChampEtPropriete(n,t),r;return clWDUtil.nElementInconnu!==u?(r=this._xnLigneWLLigne(i,this._nGetSelection()),this._oGetProprieteColonneAvecIndice(u,r,r,this.XML_CHAMP_PROP_NUM_VALEUR,!1)):this.__oGetValeurDefautAttributAutomatique(n,t)},n.prototype.OnChange=function(){this._TableAffiche()},n.prototype.AfficheImmediat=function(){this.bGetTimeXXXExiste("_Affiche")&&this._Affiche()},n.prototype.__HTMLParse=function(){var n=clWDUtil.sGetHTMLDansCommentaire(this.m_oHote);this.m_oElementsHTML=this._voHTMLParse(n)},n.prototype.__tabHTMLParse=function(n){var t=[];return this.__nHTMLParseInterne(n,0,t),t},n.prototype.__nHTMLParseInterne=function(n,t,i,r){for(;;){var u=n.indexOf(this.ms_sDynO,t);if(t=this.__nHTMLParseFixe(n,t,u,i),-1===u)return t;if(n.substr(u,this.ms_sDynFin.length)===this.ms_sDynFin)return u+this.ms_sDynFin.length;n.substr(u,this.ms_sDynSi.length)===this.ms_sDynSi?t=this.__nHTMLParseSi(n,u,i):n.substr(u,this.ms_sDynSinon.length)===this.ms_sDynSinon?(t+=u+this.ms_sDynSinon.length,i=r):t=this.__nHTMLParsePropriete(n,u,i)}},n.prototype.__nHTMLParseFixe=function(n,t,i,r){var u;return u=-1!==i?n.substring(t,i):n.substring(t),u.length>0&&r.push({vVersHTML:this.VersHTML_Fixe,m_sValeur:u}),t+u.length},n.prototype.__nHTMLParseSi=function(n,t,i){var r={vVersHTML:this.VersHTML_Condition,m_sValeur:"",m_bDifferent:!1,m_tabElementsHTMLSi:[],m_tabElementsHTMLSinon:[],m_oPropriete:null};t+=this.ms_sDynSi.length;var o=n.indexOf(this.ms_sDynAlors,t),f=n.substring(t,o),u=f.indexOf(this.ms_sConditionDifferent),e;return-1===u?(u=f.indexOf(this.ms_sConditionEgal),e=u+this.ms_sConditionEgal.length,r.m_bDifferent=!1):(e=u+this.ms_sConditionDifferent.length,r.m_bDifferent=!0),-1!==e&&(r.m_oPropriete=this.__oParsePropriete(f.substring(0,u)),r.m_sValeur=f.substring(e,o),i.push(r)),this.__nHTMLParseInterne(n,o+this.ms_sDynAlors.length,r.m_tabElementsHTMLSi,r.m_tabElementsHTMLSinon)},n.prototype.__nHTMLParsePropriete=function(n,t,i){t+=this.ms_sDynO.length;var r=n.indexOf(this.ms_sDynF,t);return i.push({vVersHTML:this.VersHTML_Propriete,m_oPropriete:this.__oParsePropriete(n.substring(t,r))}),r+this.ms_sDynF.length},n.prototype.ms_oMatchAttAuto=/^ATT_(\w+)_(\d+)$/,n.prototype.__oParsePropriete=function(n){var t={m_nColonne:undefined,m_oAttributAutomatique:undefined,m_ePropriete:this.XML_CHAMP_PROP_NUM_VALEUR,m_eConversion:undefined},f=n.indexOf(this.ms_sConversion),i,r,u;return-1!==f&&(t.m_eConversion=parseInt(n.substring(f+this.ms_sConversion.length),10),n=n.substring(0,f)),i=n.indexOf(this.ms_sPropriete),-1!==i&&(r=[],t.m_ePropriete=this.__eParsePPPropriete(n.substring(i+this.ms_sPropriete.length),r),r[0]!==undefined&&(t.m_oParametre=r[0]),n=n.substring(0,i)),u=n.match(this.ms_oMatchAttAuto),null!==u?t.m_oAttributAutomatique={m_sAliasChamp:u[1],m_ePropriete:parseInt(u[2],10)}:t.m_nColonne=this._nGetColonneSelonAlias(n),t},n.prototype.__eParsePPPropriete=function(n,t){switch(n){case"COULEUR":return this.XML_CHAMP_PROP_NUM_COULEUR;case"COULEURFOND":return this.XML_CHAMP_PROP_NUM_COULEURFOND;case"BULLE":return this.XML_CHAMP_PROP_NUM_BULLE;case"RUPTURELIGNE_DEBUT":return this.ms_nAttributRuptureLigneDebut;case"RUPTURELIGNE_FIN":return this.ms_nAttributRuptureLigneFin;case"LIGNEREPLIEE":return this.ms_nAttributLigneRepliee;case"LIGNEPAIRE":return this.ms_nAttributLignePaire;case"TRIABLE":return this.ms_nAttributTriable;case"RECHERCHABLE":return this.ms_nAttributRecherchable;case"SELECTED":return this.ms_nAttributSelected;case"DERNIEREVISIBLE":return this.ms_nAttributDerniereVisible;case this.ms_sCodeHTML32:return this.ms_nAttributCodeHTML32;default:return this.__bParsePPProprieteDouble(n,t,this.ms_sInclureHautRupture,!0)?this.ms_nAttributIncludeHautRupture:this.__bParsePPProprieteDouble(n,t,this.ms_sInclureBasRupture,!0)?this.ms_nAttributIncludeBasRupture:this.__bParsePPProprieteDouble(n,t,this.ms_sCodeHTML30,!0)?this.ms_nAttributCodeHTML30:this.__bParsePPProprieteDouble(n,t,this.ms_sCodeHTML31,!0)?this.ms_nAttributCodeHTML31:this.__bParsePPProprieteDouble(n,t,this.ms_sCodeHTML50,!0)?this.ms_nAttributCodeHTML50:this.__bParsePPProprieteDouble(n,t,this.ms_sCodeHTML51,!0)?this.ms_nAttributCodeHTML51:this.__bParsePPProprieteDouble(n,t,"EXISTE_",!1)?this.ms_nAttributExiste:this.XML_CHAMP_PROP_NUM_VALEUR}},n.prototype.__bParsePPProprieteDouble=function(n,t,i,r){if(n.substr(0,i.length)===i){var u=n.substr(i.length);return t[0]=r?parseInt(u,10):u,!0}return!1},n.prototype.__HTMLGenere=function(n,t,i,r,u){for(var e=r.length,f=0;f<e;f++)r[f].vVersHTML.apply(this,[n,t,i,r[f],u])},n.prototype.VersHTML_Fixe=function(n,t,i,r,u){u.push(r.m_sValeur)},n.prototype.VersHTML_Propriete=function(n,t,i,r,u){u.push(this.__sGetPropriete(n,t,i,r.m_oPropriete,!1))},n.prototype.VersHTML_Condition=function(n,t,i,r,u){var f=r.m_sValeur==this.__sGetPropriete(n,t,i,r.m_oPropriete,!0);(r.m_bDifferent?!f:f)?this.__HTMLGenere(n,t,i,r.m_tabElementsHTMLSi,u):r.m_tabElementsHTMLSinon&&this.__HTMLGenere(n,t,i,r.m_tabElementsHTMLSinon,u)},n.prototype.__sGetPropriete=function(n,t,i,r,u){var f,e=r.m_oAttributAutomatique,o;return e&&(o=this.__nGetAttributSelonChampEtPropriete(e.m_sAliasChamp,e.m_ePropriete),clWDUtil.nElementInconnu!==o?(r.m_oAttributAutomatique=undefined,r.m_nColonne=o):f=this.__oGetValeurDefautAttributAutomatique(e.m_sAliasChamp,e.m_ePropriete)),r.m_nColonne!==undefined?f=this.m_tabColonnes[r.m_nColonne].vsLitPropriete(this,r.m_nColonne,n,t,i,r.m_ePropriete,!0,u):undefined===f&&(f=this._vsLitPropriete(n,t,i,r.m_ePropriete,r.m_oParametre,u)),this.__sConversion(f,r.m_eConversion)},n.prototype.__sConversion=function(n,t){if(t!==undefined){var i;switch(t){case this.ms_nConversionPoliceGras:if(typeof n=="boolean")return n?"bold":"normal";break;case this.ms_nConversionPoliceItalique:if(typeof n=="boolean")return n?"italic":"normal";break;case this.ms_nConversionPoliceSouligne:if(typeof n=="boolean")return n?"underline":"none";break;case this.ms_nConversionPoliceTaille:if(typeof n=="string"&&(i=parseInt(n,10),i===n&&(n=i)),typeof n=="number"||0!==n)return n+"pt";break;case this.ms_nConversionBackgroundImage:return clWDUtil.sGetCheminImage(n,"none",!0)}}return n},n}();WDPopupSaisieTRF=function(){"use strict";function n(n,t){arguments.length&&(WDPopupSaisie.prototype.constructor.apply(this,[n,!1]),this.m_tabImages=t,clWDUtil.PrechargeImage(t))}function i(n){n&&(n.onmouseout=null,n.onmouseover=null,n.onclick=null)}var t=function(){function n(n,e,o,s,h,c,l,a){if(arguments.length){var v=[];l&&v.push(u);v.push(t);h&&v.push(i);v[v.length-1].m_bSeparateur=!0;v.push(f);clWDUtil.bForEach(r,function(n){return(h&&n.m_bTexte||c&n.m_bNumDateHeure)&&v.push(n),!0});this.m_oGestionnaire=e;this.m_pfAction=o;this.m_nColonne=s;WDMenuContextuel.prototype.constructor.apply(this,[n,v,this.ms_eOuvreSensAutomatique,TABLE_FILTRE,a])}}n.prototype=new WDMenuContextuel;n.prototype.constructor=n;var u={m_nFiltre:-1,m_oLibelle:{m_sTraduction:"FILTRE_SUPPRIME",sLibelle:"Supprimer le filtre"},m_sImage:"TableFiltre.gif",m_bSeparateur:!0},t={m_nFiltre:0,m_oLibelle:{m_sTraduction:"RECHERCHE",sLibelle:"Rechercher"},m_sImage:"TableCherche.gif"},i={m_nFiltre:WDTableColonne.prototype.ms_nFiltreContient,m_oLibelle:{m_sTraduction:"FILTRE_CONTIENT",sLibelle:"Contient"}},f={m_oLibelle:{m_sTraduction:"FILTRE",sLibelle:"Filtres :"},m_sImage:"TableFiltre.gif",m_bInactif:!0},r=[{m_nFiltre:WDTableColonne.prototype.ms_nFiltreEgal,m_bTexte:!0,m_bNumDateHeure:!0,m_oLibelle:{m_sTraduction:"FILTRE_EGAL",sLibelle:"Est \u00e9gal \u00e0"}},{m_nFiltre:WDTableColonne.prototype.ms_nFiltreCommencePar,m_bTexte:!0,m_oLibelle:{m_sTraduction:"FILTRE_COMMENCE",sLibelle:"Commence par"}},{m_nFiltre:WDTableColonne.prototype.ms_nFiltreTerminePar,m_bTexte:!0,m_oLibelle:{m_sTraduction:"FILTRE_TERMINE",sLibelle:"Se termine par"}},{m_nFiltre:WDTableColonne.prototype.ms_nFiltreDifferent,m_bTexte:!0,m_bNumDateHeure:!0,m_oLibelle:{m_sTraduction:"FILTRE_DIFFERENT",sLibelle:"Est diff\u00e9rent de"}},{m_nFiltre:WDTableColonne.prototype.ms_nFiltreNeCommencePasPar,m_bTexte:!0,m_oLibelle:{m_sTraduction:"FILTRE_COMMENCE_PAS",sLibelle:"Ne commence pas par"}},{m_nFiltre:WDTableColonne.prototype.ms_nFiltreNeContientPas,m_bTexte:!0,m_oLibelle:{m_sTraduction:"FILTRE_CONTIENT_PAS",sLibelle:"Ne contient pas"}},{m_nFiltre:WDTableColonne.prototype.ms_nFiltreNeTerminePasPar,m_bTexte:!0,m_oLibelle:{m_sTraduction:"FILTRE_TERMINE_PAS",sLibelle:"Ne se termine pas par"}},{m_nFiltre:WDTableColonne.prototype.ms_nFiltreSuperieur,m_bNumDateHeure:!0,m_oLibelle:{m_sTraduction:"FILTRE_SUPERIEUR",sLibelle:"Sup\u00e9rieur \u00e0"}},{m_nFiltre:WDTableColonne.prototype.ms_nFiltreSuperieurOuEgal,m_bNumDateHeure:!0,m_oLibelle:{m_sTraduction:"FILTRE_SUPERIEUR_EGAL",sLibelle:"Sup\u00e9rieur ou \u00e9gal \u00e0"}},{m_nFiltre:WDTableColonne.prototype.ms_nFiltreInferieur,m_bNumDateHeure:!0,m_oLibelle:{m_sTraduction:"FILTRE_INFERIEUR",sLibelle:"Inf\u00e9rieur \u00e0"}},{m_nFiltre:WDTableColonne.prototype.ms_nFiltreInferieurOuEgal,m_bNumDateHeure:!0,m_oLibelle:{m_sTraduction:"FILTRE_INFERIEUR_EGAL",sLibelle:"Inf\u00e9rieur ou \u00e9gal \u00e0"}}];return n.prototype._vAction=function(n,t){this.m_pfAction.apply(this.m_oGestionnaire,[n,this.m_nColonne,t.m_nFiltre,""])},n.s_sGetLibelleFiltre=function(n){function e(){function u(t){return t.m_nFiltre===n?t.m_oLibelle:undefined}function f(n){var t;return clWDUtil.bForEach(n,function(n){return t=u(n),undefined===t}),t}return u(t)||u(i)||f(r)}var f=e(),u;return f&&TABLE_FILTRE&&(u=TABLE_FILTRE[f.m_sTraduction],u)?u.sLibelle:undefined},n}();return n.prototype=new WDPopupSaisie,n.prototype.constructor=n,n.prototype.__tabGetImagesRechercheFiltre=function(n){switch(n.m_nRecherche){default:case 1:case 2:case 3:return n.ms_nFiltreRecherche===n.nGetFiltre()?this.m_tabImages[1]:this.m_tabImages[2]}},n.prototype.__AfficheImage=function(n,t,i,r){var u=this.__tabGetImagesRechercheFiltre(i);undefined!==t&&t===this.m_nColonneRecherche&&(r=2);n.src=u[r]},n.prototype.__AjouteOnXxxSurImages=function(n,i,r,u,f){var e=this,o;i&&(r?(o=undefined,i.onclick=function(i){i=i||event;var r=e.m_oChampParent._oGetColonne(n),s=r.nGetFiltre(),h=e.m_oChampParent.sGetFiltrePourColonne(n);if(e.bAvecEtAnnuleTimeoutAnnule()&&e.m_nColonneRecherche===n){o&&o.__Masque();o=new t(i,e,e.OnSaisieLoupe,n,u,f,r.ms_nFiltreRecherche!==s&&""!==h,function(){o=undefined});e.m_oSaisie.focus();return}e.OnSaisieLoupe(i,n,s,h)}):i.onclick=function(t){e.OnRechercheColonne(t||event,n,this)},i.onmouseover=function(){e.OnRechercheSurvol(n,this,1)},i.onmouseout=function(){e.OnRechercheSurvol(n,this,0)})},n.prototype.__Debut=function(n,t,i,r,u){var o=this.m_oChampParent.oGetIDElement(clWDTableDefs.ID_TITRE,clWDTableDefs.ID_TRI,i),l=this.m_oChampParent.oGetIDElement(clWDTableDefs.ID_FORMAT,i),f=t.parentNode,s,h,a=o?o.offsetLeft+o.offsetWidth+2:0,c,e;clWDUtil.bBaliseEstTag(f,"div")&&clWDUtil.bBaliseEstTag(f.parentNode,"td")?(s=f.offsetParent,f=f.parentNode,h=t.offsetParent.offsetWidth-t.offsetLeft):(h=t.offsetWidth,s=t.offsetParent);e=clWDUtil.tabGetElementsByClass(f,"tt"+this.m_oChampParent._oGetColonne(i).m_sAlias);e&&e.length&&e[0]&&(c=clWDUtil.oGetCurrentStyle(e[0]).fontSize);this.Debut(n,f,s,a,h,r,u,l,c,[t,i])},n.prototype.AjouteLienImages=function(n,t){for(var o=n.length,i=0;i<o;i++){var r=n[i],f=this.m_oChampParent.oGetIDElement(clWDTableDefs.ID_TITRE,clWDTableDefs.ID_TRI,i),s=r.m_bTri;f&&clWDUtil.SetDisplay(f,s);var u=this.m_oChampParent.oGetIDElement(clWDTableDefs.ID_TITRE,clWDTableDefs.ID_RECHERCHE,i),e=0<r.m_nRecherche,h=1<r.m_nRecherche;u&&(clWDUtil.SetDisplay(u,e),this.__AfficheImage(u,i,r,0));t||this.__AjouteOnXxxSurImages(i,e?u:null,h,r.bEstTexte(),r.bEstNumerique()||r.bEstDateHeure())}},n.prototype.SupprimeLienImages=function(n){for(var r,t=0;t<n;t++)r=this.m_oChampParent.oGetIDElement(clWDTableDefs.ID_TITRE,clWDTableDefs.ID_RECHERCHE,t),i(r)},n.prototype.AfficheImageTri=function(n,t){var i=this.m_tabImages[0],r=this.m_oChampParent.oGetIDElement(clWDTableDefs.ID_TITRE,clWDTableDefs.ID_TRI,n);r&&(r.src=undefined!==t?t?i[1]:i[2]:i[0])},n.prototype._vDebut=function(n,t,i,r,u,f,e,o){WDPopupSaisie.prototype._vDebut.apply(this,arguments);var h=o[0],s=o[1];this.m_oImage=h;this.m_nColonneRecherche=s;this.__AfficheImage(h,s,this.m_oChampParent._oGetColonne(s),0)},n.prototype._vValide=function(n,t){WDPopupSaisie.prototype._vValide.apply(this,arguments);this.__Valide(n,this.m_nColonneRecherche,t,!1)},n.prototype.__Valide=function(n,t,i,r){var u=this.m_oChampParent._oGetColonne(t),f,e;r||(i=this.__ConversionMasqueModele(i,u.m_sAlias,!0));f=i+"";e=u.nGetFiltre();u.ms_nFiltreRecherche===e?f.length>0&&this.m_oChampParent.OnRecherche(n,t,i):f.length>0?this.m_oChampParent.OnFiltre(n,t,e,i):this.m_oChampParent.OnAnnuleFiltre(n,t)},n.prototype._vAnnule=function(){var n,t;WDPopupSaisie.prototype._vAnnule.apply(this,arguments);n=this.m_oChampParent._oGetColonne(this.m_nColonneRecherche);this.m_nColonneRecherche=null;t=this.m_oImage;this.m_oImage=null;t&&n&&this.__AfficheImage(t,undefined,n,0)},n.prototype.OnRechercheColonne=function(n,t,i){this.__Debut(n,i,t,!0,"")},n.prototype.OnRechercheSurvol=function(n,t,i){this.__AfficheImage(t,n,this.m_oChampParent._oGetColonne(n),i)},n.prototype.OnSaisieLoupe=function(n,i,r,u){var e,f;if(-1===r){this.__Valide(n,i,"",!0);return}this.bAvecEtAnnuleTimeoutAnnule();this.m_oChampParent._oGetColonne(i).SetFiltre(r);e=this.m_oChampParent.oGetIDElement(clWDTableDefs.ID_TITRE,clWDTableDefs.ID_RECHERCHE,i);this.__Debut(n,e,i,!1,u);f=t.s_sGetLibelleFiltre(r);undefined!==f&&this.m_oSaisie&&(this.m_oSaisie.placeholder=f)},n}();WDCelluleSaisie.prototype.ms_nColonneSuivante=-1;WDCelluleSaisie.prototype.ms_nColonnePrecedente=-2;WDCelluleSaisie.prototype.ms_nLigneSuivante=-3;WDCelluleSaisie.prototype.ms_nLignePrecedente=-4;WDCelluleSaisie.prototype.ms_nSaisieSans=0;WDCelluleSaisie.prototype.ms_nSaisieEnCours=1;WDCelluleSaisie.prototype.ms_nSaisieSansDocument=2;WDCelluleSaisie.prototype.ms_nContinueSaisieSans=0;WDCelluleSaisie.prototype.ms_nContinueSaisieLigneCourante=1;WDCelluleSaisie.prototype.ms_nContinueSaisieLignePrecedenteFin=2;WDCelluleSaisie.prototype.ms_nContinueSaisieLigneSuivanteDebut=3;WDCelluleSaisie.prototype.ms_nContinueSaisieLignePrecedente=4;WDCelluleSaisie.prototype.ms_nContinueSaisieLigneSuivante=5;WDCelluleSaisie.prototype.bSaisieEnCours=function(n){switch(this.__eGetSaisieEnCours(n)){case this.ms_nSaisieSans:return!1;case this.ms_nSaisieEnCours:return!0;case this.ms_nSaisieSansDocument:return this.SaisieFin(!1,!1,WDTableZRNavigateur.prototype.ms_nColonneInvalide,null),!1}};WDCelluleSaisie.prototype.bSaisieEnCoursDansCellule=function(n,t){return this.bSaisieEnCours()&&n===this.m_nLigne&&t===this.m_nColonne};WDCelluleSaisie.prototype.__OnMAJDonneesTimeout=function(n){var t=this;clWDUtil.nSetTimeout(function(){t.OnMAJDonnees()},n)};WDCelluleSaisie.prototype.OnMAJDonnees=function(n){var r,t,i,u;if(this.m_bEntreEnSaisieSurProchainAffichage){for(r=this.m_nLigne,t=this.m_oChampTable;window.WDTable&&t instanceof WDTable;){if(i=t.nRelative2Absolue(r),i<0||t.m_nNbLignes<=i){this.m_bEntreEnSaisieSurProchainAffichage=!1;return}if(u=t.__fGetDefilementPourAfficherLigne(i),!u)break;var f=t.m_nDebut,o=t.__fForceDefilement(u,null,!1),e=t.m_nDebut;if(t.__fGetZoom()<Math.abs(o-u)&&f===e&&i===t.m_nNbLignes-1)break;this.m_nLigne=r-e+f;this.__OnMAJDonneesTimeout(clWDUtil.ms_nTimeoutNonImmediat20);return}this.OnClickCellule(r,this.m_nColonne,!1,n)}};WDCelluleSaisie.prototype.OnClickCellule=function(n,t,i,r){this.m_bEntreEnSaisieSurProchainAffichage=!1;switch(this.m_oChampTable.eColonneTypeIDObjet(t)){case WDChamp.prototype.ms_nIDObjetInterrupteur:case WDChamp.prototype.ms_nIDObjetImage:this.bSaisieEnCours()&&this.SaisieFin(!0,!1,undefined,r);return}switch(this.__eGetSaisieEnCours(!1)){case this.ms_nSaisieEnCours:if(this.m_nLigne===n&&this.m_nColonne===t)return;case this.ms_nSaisieSansDocument:this.m_nLigne===n?this.SaisieFin(!0,!0,t,r):this.SaisieFin(!0,!1,undefined,r);return}this._SetEtat(n,t);i?this.m_oChampTable.vbSaisieSansSelection(t)&&(this.m_bEntreEnSaisieSurProchainAffichage=!0):this.SaisieCommence(r)};WDCelluleSaisie.prototype.SaisieCommence=function(n){var s,h,r,w,u,t,b,a,f,k,e,c,i,o,l,v,y,p;if(!this.m_oChampTable.m_bDansOnSelectLigneExterne&&!this.bSaisieEnCours(!0)){if(this.__ClearOnDblClick(),!this.m_oChampTable.bColonneSaisissable(this.m_nColonne)||!this._vbCreeLigneVirtuelle()){this._ClearEtat();return}s=this._voGetCellule();switch(this.m_oChampTable.eColonneTypeIDObjet(this.m_nColonne)){case WDChamp.prototype.ms_nIDObjetInterrupteur:h=s.getElementsByTagName("input")[0];clWDUtil.AttacheDetacheEvent(!0,h,"keydown",this.m_pfOnKeyDown);clWDUtil.DonneFocus(h);this.__bOnXxxPourCodeNav(n,h,WDChamp.prototype.ms_nEventNavFocus,"focus",!1);return}r=document.createElement("form");r.method="post";r.action="javascript:return false;";w=this._vnGetHauteurLigne();u=w-(bIEQuirks?4:0);r.style.width="100%";r.style.height=u+"px";switch(this.m_oChampTable.eColonneTypeIDObjet(this.m_nColonne)){case WDChamp.prototype.ms_nIDObjetCombo:for(b=this.m_oChampTable.nGetValeurCellule(this.m_nLigne,this.m_nColonne),t=document.createElement("select"),a=this.m_oChampTable.tabContenuCellule(this.m_nLigne,this.m_nColonne),k=a.length,f=0;f<k;f++)e=document.createElement("option"),e=t.appendChild(e),e.innerHTML=String(a[f]),e.value=f,b===f&&(e.selected=!0);break;case WDChamp.prototype.ms_nIDObjetSaisie:default:c=this.m_oChampTable.sGetValeurCellule(this.m_nLigne,this.m_nColonne)+"";-1!==c.indexOf("\r")||-1!==c.indexOf("\n")?t=document.createElement("textarea"):(t=document.createElement("input"),t.type="text");t.value=c;this.__SetMasqueModele(t,this.m_oChampTable.oGetIDElement(clWDTableDefs.ID_FORMAT,this.m_nColonne))}for(i=s;clWDUtil.bBaliseEstTag(i,"div")&&i.style.backgroundColor==="";)i=i.parentNode;o=clWDUtil.oGetCurrentStyle(i);t.style.width="100%";t.style.height=u+"px";t.style.borderWidth="0";t.style.borderStyle="solid";t.style.borderColor=o.backgroundColor;t.style.fontFamily=o.fontFamily;t.style.fontWeight=o.fontWeight;t.style.fontStyle=o.fontStyle;l=o.fontSize;t.style.fontSize=l;u<=18&&u>0&&(v=Math.max(u-4,6),y=!0,clWDUtil.s_bTerminePar(l,"px",!1)&&(p=parseFloat(l),y=isNaN(p)||v<p),y&&(t.style.fontSize=v+"px"));clWDUtil.SupprimeFils(s);r.appendChild(t);this.m_oFormulaire=s.appendChild(r);this.m_oSaisie=this.m_oFormulaire.elements[0];clWDUtil.AttacheDetacheEvent(!0,this.m_oFormulaire,"submit",this.m_pfOnSubmit);clWDUtil.AttacheDetacheEvent(!0,this.m_oSaisie,"blur",this.m_pfOnBlur);clWDUtil.AttacheDetacheEvent(!0,this.m_oSaisie,"keydown",this.m_pfOnKeyDown);clWDUtil.AttacheDetacheEvent(!0,this.m_oSaisie,"change",this.m_pfOnChange);this.m_fOldClick=i.onclick;i.onclick=null;this.m_oParentTable=i;clWDUtil.DonneFocus(this.m_oSaisie,!1,!0);this.__bOnXxxPourCodeNav(n,this.m_oSaisie,WDChamp.prototype.ms_nEventNavFocus,"focus",!1)}};WDCelluleSaisie.prototype.bGetPourPCodeSortie=function(){return this.m_oEventPCodeSortie&&!1!==this.__bValideMasqueModele(this.m_oEventPCodeSortie)};WDCelluleSaisie.prototype.SaisieFin=function(n,t,i,r){var e,u,f;this.__ClearOnDblClick();switch(this.__eGetSaisieEnCours(!1)){case this.ms_nSaisieSansDocument:case this.ms_nSaisieEnCours:if(n&&!1!==this.__bValideMasqueModele(r)){switch(this.m_oChampTable.eColonneTypeIDObjet(this.m_nColonne)){case WDChamp.prototype.ms_nIDObjetInterrupteur:e=this._voGetCellule().getElementsByTagName("input")[0]}if(this.m_oChampTable.SetValeurCellule(this.m_nLigne,this.m_nColonne,this.pfGetValeurNouvelle()),t)switch(i){case this.ms_nColonnePrecedente:i=this.__nGetColonneSaisieSuivante(i,-1,clWDUtil.s_bSuperieurOuEgal,0);break;case this.ms_nColonneSuivante:i=this.__nGetColonneSaisieSuivante(i,1,clWDUtil.s_bInferieur,this.m_oChampTable._nGetNbColonnes())}}e&&clWDUtil.AttacheDetacheEvent(!1,e,"keydown",this.m_pfOnKeyDown);this.m_oSaisie&&(clWDUtil.AttacheDetacheEvent(!1,this.m_oSaisie,"change",this.m_pfOnChange),clWDUtil.AttacheDetacheEvent(!1,this.m_oSaisie,"keydown",this.m_pfOnKeyDown),clWDUtil.AttacheDetacheEvent(!1,this.m_oSaisie,"blur",this.m_pfOnBlur),clWDUtil.bHTMLVideDepuisVariable(this,"m_oSaisie"));this.m_oFormulaire&&(clWDUtil.AttacheDetacheEvent(!1,this.m_oFormulaire,"submit",this.m_pfOnSubmit),clWDUtil.bHTMLVideDepuisVariable(this,"m_oFormulaire"));this.m_oParentTable&&(this.m_oParentTable.onclick=this.m_fOldClick,this.m_fOldClick=null,this.m_oParentTable=null);this.__ClearMasqueModele();switch(i){case this.ms_nLigneSuivante:u=t?this.ms_nContinueSaisieLigneSuivante:this.ms_nContinueSaisieSans;break;case this.ms_nLignePrecedente:u=t?this.ms_nContinueSaisieLignePrecedente:this.ms_nContinueSaisieSans;break;default:u=this.__nContinueSaisie(t,i)}f=this._vbMAJLigne(n&&this.ms_nContinueSaisieLigneCourante!==u);switch(u){case this.ms_nContinueSaisieSans:this._ClearEtat();break;case this.ms_nContinueSaisieLigneCourante:this.m_nColonne=i;this.SaisieCommence(r);return;case this.ms_nContinueSaisieLignePrecedenteFin:this.__PrepareSaisieLigneAutre(r,-1,this.m_oChampTable._nGetNbColonnes(),clWDUtil.s_bSuperieurOuEgal,0,f);break;case this.ms_nContinueSaisieLigneSuivanteDebut:this.__PrepareSaisieLigneAutre(r,1,-1,clWDUtil.s_bInferieur,this.m_oChampTable._nGetNbColonnes(),f);break;case this.ms_nContinueSaisieLignePrecedente:this.__PrepareSaisieLigneAutre(r,-1,this.m_nColonne+1,clWDUtil.s_bSuperieurOuEgal,0,f);break;case this.ms_nContinueSaisieLigneSuivante:this.__PrepareSaisieLigneAutre(r,1,this.m_nColonne-1,clWDUtil.s_bInferieur,this.m_oChampTable._nGetNbColonnes(),f)}}this._vSupprimeLignesVirtuelles()};WDCelluleSaisie.prototype.pfGetValeurNouvelle=function(){var n=this;return function(t){return n.__oGetValeurNouvelle(t)}};WDCelluleSaisie.prototype.__oGetValeurNouvelle=function(n){var t;switch(this.m_oChampTable.eColonneTypeIDObjet(this.m_nColonne)){case WDChamp.prototype.ms_nIDObjetCombo:return t=parseInt(this.m_oSaisie.value,10),n?t:this.m_oChampTable.tabContenuCellule(this.m_nLigne,this.m_nColonne)[t];case WDChamp.prototype.ms_nIDObjetInterrupteur:return t=this._voGetCellule().getElementsByTagName("input")[0].checked?1:0,n?t:String(t);case WDChamp.prototype.ms_nIDObjetSaisie:default:return n?-1:this.__ConversionMasqueModele(this.m_oSaisie.value,this.m_oChampTable._oGetColonne(this.m_nColonne).m_sAlias,this._vbAvecMasqueModele())}};WDCelluleSaisie.prototype.bDetacheFormulaire=function(){return this.bSaisieEnCours()&&this.m_oFormulaire?(this.m_oFormulaire=this.m_oFormulaire.parentNode.removeChild(this.m_oFormulaire),!0):!1};WDCelluleSaisie.prototype.AttacheFormulaire=function(n){if(n){var t=this._voGetCellule();clWDUtil.SupprimeFils(t);this.m_oFormulaire=t.appendChild(this.m_oFormulaire)}};WDCelluleSaisie.prototype._voGetCellule=function(){var n=this.m_oChampTable.oGetIDCelluleRel(this.m_nLigne,this.m_nColonne);return n?n.parentNode.parentNode:null};WDCelluleSaisie.prototype._SetEtat=function(n,t){WDTableZRNavigateur.prototype.ms_nLigneInvalide!==this.m_nLigne&&WDTableZRNavigateur.prototype.ms_nColonneInvalide!==this.m_nColonne&&this.__ClearOnDblClick();this.m_nLigne=n;this.m_nColonne=t;this.__SetOnDblClick()};WDCelluleSaisie.prototype._ClearEtat=function(){this.m_nLigne=WDTableZRNavigateur.prototype.ms_nLigneInvalide;this.m_nColonne=WDTableZRNavigateur.prototype.ms_nColonneInvalide};WDCelluleSaisie.prototype._vnGetHauteurLigne=function(){return this._voGetCellule().clientHeight};WDCelluleSaisie.prototype._vbMAJLigne=function(){return this.m_oChampTable.__OnLigneModification(this.m_nLigne),!0};WDCelluleSaisie.prototype._vbCreeLigneVirtuelle=clWDUtil.m_pfVide;WDCelluleSaisie.prototype._vSupprimeLignesVirtuelles=clWDUtil.m_pfVide;WDCelluleSaisie.prototype._vbAvecMasqueModele=clWDUtil.m_pfVide;WDCelluleSaisie.prototype.__nGetColonneSaisieSuivante=function(n,t,i,r){for(var u=this.m_nColonne+t;i(u,r);u+=t)if(this.m_oChampTable.bColonneSaisissable(u))return u;return n};WDCelluleSaisie.prototype.__PrepareSaisieLigneAutre=function(n,t,i,r,u,f){var e=this.m_nLigne+t;this._ClearEtat();this.m_nLigne=e;this.m_nColonne=i;this.m_nColonne=this.__nGetColonneSaisieSuivante(-1,t,r,u);-1!==this.m_nColonne&&(this.m_bEntreEnSaisieSurProchainAffichage=!0);f||this.__OnMAJDonneesTimeout(clWDUtil.ms_oTimeoutImmediat)};WDCelluleSaisie.prototype.__eGetSaisieEnCours=function(n){return this.m_oFormulaire?clWDUtil.bEstDansDocument(this.m_oFormulaire)?this.ms_nSaisieEnCours:this.ms_nSaisieSansDocument:!n&&0<=this.m_nColonne&&WDChamp.prototype.ms_nIDObjetInterrupteur===this.m_oChampTable.eColonneTypeIDObjet(this.m_nColonne)?this.ms_nSaisieEnCours:this.ms_nSaisieSans};bIEQuirks?(WDCelluleSaisie.prototype.__SetOnDblClick=function(){var n=this._voGetCellule(),t;n&&(this.m_pfOnDblClick||(t=this,this.m_pfOnDblClick=function(n){t.SaisieCommence(n||event)}),n.ondblclick=this.m_pfOnDblClick)},WDCelluleSaisie.prototype.__ClearOnDblClick=function(){var n=this._voGetCellule();n&&(n.ondblclick=null)}):(WDCelluleSaisie.prototype.__SetOnDblClick=clWDUtil.m_pfVide,WDCelluleSaisie.prototype.__ClearOnDblClick=clWDUtil.m_pfVide);WDCelluleSaisie.prototype.__bOnSubmit=function(n){return this.SaisieFin(!0,!0,this.ms_nColonneSuivante,n),clWDUtil.bStopPropagation(n)};WDCelluleSaisie.prototype.__bOnBlur=function(n){var t=clWDUtil.oGetTarget(n);return this.__bAppelOnBlur(n,t),this.SaisieFin(!0,!1,undefined,n),clWDUtil.bStopPropagation(n)};WDCelluleSaisie.prototype.__bAppelOnBlur=function(n,t){this.__bOnXxxPourCodeNav(n,t,WDChamp.prototype.ms_nEventNavBlur,"blur",!0)};WDCelluleSaisie.prototype.__bOnKeyDown=function(n){var t=clWDUtil.oGetTarget(n);switch(n.keyCode){case 9:return this.__bOnEnchaineSaisieGD(n,t,!n.shiftKey);case 27:return this.SaisieFin(!1,undefined,undefined,n),clWDUtil.bStopPropagation(n);case 37:return this.__bOnFlecheGaucheDroite(n,t,!1);case 38:return this.__bOnFlecheHautBas(n,t,!1);case 39:return this.__bOnFlecheGaucheDroite(n,t,!0);case 40:return this.__bOnFlecheHautBas(n,t,!0);default:return!0}};WDCelluleSaisie.prototype.__bOnEnchaineSaisieGD=function(n,t,i){if(1){var r=this.__bAppelOnChange(n,t);if(r)return r}return this.__bAppelOnBlur(n,t),this.SaisieFin(!0,!0,i?this.ms_nColonneSuivante:this.ms_nColonnePrecedente,n),clWDUtil.bStopPropagation(n)};WDCelluleSaisie.prototype.__bOnEnchaineSaisieHB=function(n,t,i){if(1){var r=this.__bAppelOnChange(n,t);if(r)return r}return this.__bAppelOnBlur(n,t),this.SaisieFin(!0,!0,i?this.ms_nLigneSuivante:this.ms_nLignePrecedente,n),clWDUtil.bStopPropagation(n)};WDCelluleSaisie.prototype.__bOnChange=function(n){var i=clWDUtil.oGetTarget(n),r=this.__bAppelOnChange(n,i),t;if(clWDUtil.bBaliseEstTag(i,"select")){if(t=n.keyCode,undefined!==t)switch(t){case 9:this.SaisieFin(!0,!0,n.shiftKey?this.ms_nColonnePrecedente:this.ms_nColonneSuivante,n);break;default:return r}return clWDUtil.bStopPropagation(n)}return r};WDCelluleSaisie.prototype.__bAppelOnChange=function(n,t){return!this.__bOnXxxPourCodeNav(n,t,WDChamp.prototype.ms_nEventNavChange,"change",!0)};WDCelluleSaisie.prototype.__bOnFlecheGaucheDroite=function(n,t,i){var u=!1,f,e,r,o;switch(clWDUtil.sGetTagName(t)){case"input":switch(t.type.toLowerCase()){case"checkbox":u=!0;break;case"text":e=i?t.selectionEnd:t.selectionStart;r=t.value.length;typeof e=="number"?f=e:(o=document.selection.createRange(),f=i?r-o.moveEnd("character",r):-o.moveStart("character",-r));u=f===(i?r:0)}break;case"select":u=!0}return u?this.__bOnEnchaineSaisieGD(n,t,i):!0};WDCelluleSaisie.prototype.__bOnFlecheHautBas=function(n,t,i){var r=!1;switch(clWDUtil.sGetTagName(t)){case"input":switch(t.type.toLowerCase()){case"checkbox":r=!0;break;case"text":r=!0}}return r?this.__bOnEnchaineSaisieHB(n,t,i):!0};WDCelluleSaisie.prototype.__bOnXxxPourCodeNav=function(n,t,i,r,u){var o,f,e;o=this.m_oEventPCodeSortie;try{if(this.m_oEventPCodeSortie=u?n:null,f=t.parentNode.parentNode["on"+r],f){const t=f(n);return n&&r===n.type&&clWDUtil.bStopPropagationCond(n,!0,!0),t}return this.m_oChampTable.__oAppelPCodeSurLigne&&(e=this.m_oChampTable._oGetColonne(this.m_nColonne),e&&this.m_oChampTable.__oAppelPCodeSurLigne(this.m_nLigne,clWDUtil.pfGetTraitement(e.m_sAlias,i),n)),!0}finally{this.m_oEventPCodeSortie=o}};WDCelluleSaisie.prototype.__nContinueSaisie=function(n,t){if(n)switch(t){case this.ms_nColonnePrecedente:return 0<this.m_nLigne?this.ms_nContinueSaisieLignePrecedenteFin:this.ms_nContinueSaisieSans;case this.ms_nColonneSuivante:return this.ms_nContinueSaisieLigneSuivanteDebut;case undefined:return this.ms_nContinueSaisieSans;default:return this.m_oChampTable.bColonneSaisissable(t)?this.ms_nContinueSaisieLigneCourante:this.ms_nContinueSaisieSans}else return this.ms_nContinueSaisieSans};WDCelluleSaisie.prototype.__SetMasqueModele=WDPopupSaisie.prototype.__SetMasqueModele;WDCelluleSaisie.prototype.__bValideMasqueModele=WDPopupSaisie.prototype.__bValideMasqueModele;WDCelluleSaisie.prototype.__ClearMasqueModele=WDPopupSaisie.prototype.__ClearMasqueModele;WDCelluleSaisie.prototype.__ConversionMasqueModele=WDPopupSaisie.prototype.__ConversionMasqueModele;WDMenuContextuel.prototype.s_OuvreExport=function(){"use strict";function n(n,i){arguments.length&&(this.m_sAliasChamp=i,WDMenuContextuel.prototype.constructor.apply(this,[n,t,this.ms_eOuvreSensAutomatique,TABLE_EXPORT]))}n.prototype=new WDMenuContextuel;n.prototype.constructor=n;var t=[{m_sExtension:"xls",m_sCommande:"EXPORTXLS",m_oLibelle:{m_sTraduction:"EXCEL",sLibelle:"Exporter vers Excel...",sTitre:"Exporter le contenu vers Excel..."}},{m_sExtension:"rtf",m_sCommande:"EXPORTRTF",m_oLibelle:{m_sTraduction:"WORD",sLibelle:"Exporter vers Word...",sTitre:"Exporter le contenu vers Word..."}},{m_sExtension:"xml",m_sCommande:"EXPORTXML",m_oLibelle:{m_sTraduction:"XML",sLibelle:"Exporter vers XML...",sTitre:"Exporter le contenu vers XML..."}},{m_sExtension:"pdf",m_sCommande:"EXPORTPDF",m_oLibelle:{m_sTraduction:"PDF",sLibelle:"Imprimer en PDF...",sTitre:"Imprimer vers un fichier PDF..."}}];return n.prototype._vAction=function(n,t){_JCL(_PU_+(window._WDR_?"":"/export."+t.m_sExtension)+"?WD_ACTION_="+t.m_sCommande+"&"+this.m_sAliasChamp,bFF?"_blank":"_self","","")},n.prototype._vbFiltre=clWDUtil.m_pfVide,function(t,i){new n(t,i)}}();WDAffichageColonnes=function(){"use strict";function n(n,t,i){arguments.length&&(WDDrag.prototype.constructor.apply(this,[0,50]),this.m_oChampTable=n,this.m_tabFleches=t,this.m_oStyleCacheLargeur=i,this.m_sPrefixe="table .wbcol",this.m_tabPositionAffichage=[])}var t=function(){function n(n,t,i){if(arguments.length){var r=t.bColonneDeplace()?1:0,u=t.bColonneInsereGaucheDroite()?1:0;WDDnDNatif.prototype.constructor.apply(this,[r,u,i,this.ms_nOperationDeplacement]);this.m_oAffichageColonne=n;this.m_oColonne=t}}return n.prototype=new WDDnDNatif,n.prototype.constructor=n,n.prototype._vSetDonneesDnD=function(){WDDnDNatif.prototype._vSetDonneesDnD.apply(this,arguments);this._SetEventDataSelonTypeAvecCorrection(this.ms_tabTypes[0],this.m_oColonne.m_sAlias)},n.prototype._vnGetOperationSurDrop=function(){var t=this.ms_oDnDSource,i;if(t instanceof n&&this.m_oAffichageColonne===t.m_oAffichageColonne){if(i=this.__oPositionAffichageCible(t),!i)return this.ms_nOperationSans}else return this.ms_nOperationSans;return WDDnDNatif.prototype._vnGetOperationSurDrop.apply(this,arguments)},n.prototype._vnOnDragSurvol=function(n,t){return t=WDDnDNatif.prototype._vnOnDragSurvol.apply(this,arguments),this.ms_nDnDEntreeChamp===n&&this!==this.ms_oDnDSource&&this.__AjouteDivsPosition(),t},n.prototype._vOnDragExit=function(){this.__SupprimeDivsPosition();WDDnDNatif.prototype._vOnDragExit.apply(this,arguments)},n.prototype._vOnDrop=function(){var n,t;WDDnDNatif.prototype._vOnDrop.apply(this,arguments);this.__SupprimeDivsPosition();n=this.ms_oDnDSource;this!==n&&(t=this.__oPositionAffichageCible(n),this.m_oAffichageColonne.DeplaceColonne(n.m_oColonne,t.m_nPositionAffichage))},n.prototype._vbEmuleIE9=function(){return bIE&&nIE<10},n.prototype.__oPositionAffichageCible=function(n){var r=n.m_oColonne.m_nPositionAffichage,t=this.m_oColonne,i=t.m_nPositionAffichage;if(r<i)while(t){if(t.bColonneInsereDroite())return t;t=this.m_oAffichageColonne.oGetColonneInvisible(++i)}else if(i<r)while(t){if(t.bColonneInsereGauche())return t;t=this.m_oAffichageColonne.oGetColonneInvisible(--i)}return null},n.prototype.__AjouteDivsPosition=function(){this.__SupprimeDivsPosition();var r=this.ms_oDnDSource.m_oColonne.m_nPositionAffichage,n=this.m_oColonne.m_nPositionAffichage,t,i;r<n?(t=n,i=this.m_oAffichageColonne.nGetPositionAffichageValide(n+1,1)):(t=this.m_oAffichageColonne.nGetPositionAffichageValide(n-1,-1),i=n);this.__AjouteUnDivPosition(t,!0,"m_oDivDroit");this.__AjouteUnDivPosition(i,!1,"m_oDivGauche")},n.prototype.__AjouteUnDivPosition=function(n,t,i){var e,r;if(undefined!==n){var f=this.m_oAffichageColonne.m_oChampTable.oGetIDElement(clWDTableDefs.ID_TITRE,this.m_oAffichageColonne.m_tabPositionAffichage[n].m_oColonne.m_nRangCreation),o=f.clientHeight||f.offsetHeight,u=document.createElement("img");u.src=this.m_oAffichageColonne.m_tabFleches[t?0:1];e=(o-8)/2+"px";u.style.paddingTop=e;u.style.paddingBottom=e;r=document.createElement("div");r.style.position="absolute";r.style.top="0";t?(r.style.right="0",u.style.borderRight="1px solid white",r.style.borderRight="1px solid red"):(r.style.left="0",u.style.borderLeft="1px solid white",r.style.borderLeft="1px solid red");r.appendChild(u);this[i]=f.appendChild(r)}},n.prototype.__SupprimeDivsPosition=function(){clWDUtil.bHTMLVideDepuisVariable(this,"m_oDivDroit");clWDUtil.bHTMLVideDepuisVariable(this,"m_oDivGauche")},n}();return n.prototype=new WDDrag,n.prototype.constructor=n,n.prototype.Init=function(n){var s=this.m_oChampTable,f=this.m_tabPositionAffichage,i,r,o,u,e;for(f.length&&(this.LibereTitres(),f.length=0),f.length=n.length,o=n.length,r=0;r<o;r++)i=n[r],u=this.m_oChampTable.oGetIDElement(clWDTableDefs.ID_TITRE,r),u&&i.m_bTri&&(e=function(){var n=i.m_nRangCreation;return function(t){s.OnTriColonne(n,t)}}(),u.addEventListener("click",e)),f[i.m_nPositionAffichage]={m_oColonne:i,m_oTitreColonne:u,m_oDeplace:new t(this,i,u),m_pfClick:e}},n.prototype.InitTitres=function(){for(var f=this.m_oChampTable,e=this.m_tabPositionAffichage,o=e.length,u,n=0;n<o;n++){var t=e[n],r=t.m_oColonne,i=f.oGetIDElement(clWDTableDefs.ID_TITRE,r.m_nRangCreation);t.m_oTitreColonne=i;i&&(t.m_oDeplace._InitElement(i),r.m_bTri&&(u=function(){var n=r.m_nRangCreation;return function(t){f.OnTriColonne(n,t)}}(),i.addEventListener("click",u),t.m_pfClick=u))}},n.prototype.LibereTitres=function(){for(var u=this.m_tabPositionAffichage,f=u.length,n,i,r,t=0;t<f;t++)n=u[t],i=n.m_oTitreColonne,i&&(r=n.m_pfClick,r&&i.removeEventListener("click",r),n.m_pfClick=undefined,n.m_oDeplace._LibereElement(i))},n.prototype.DeplaceColonne=function(n,t){var r,u,f,i;if(n.bColonneDeplace()&&(r=n.m_nPositionAffichage,t!==r)){if(u=this.m_tabPositionAffichage,f=u.splice(r,1)[0],u.splice(t,0,f),f.m_oColonne.m_nPositionAffichage=t,r<t)for(i=r;i<t;i++)u[i].m_oColonne.m_nPositionAffichage--;else for(i=t+1;i<=r;i++)u[i].m_oColonne.m_nPositionAffichage++;this.m_oChampTable.ChangeOrdreColonne(!0,n)}},n.prototype.nGetPositionAffichageValide=function(n,t){for(var i=this.m_tabPositionAffichage,r=i.length;0<=n&&n<r;n+=t)if(i[n].m_oColonne.bGetVisible())return n;return undefined},n.prototype.oGetColonneInvisible=function(n){var i=this.m_tabPositionAffichage,r=i.length,t;return 0<=n&&n<r&&(t=i[n].m_oColonne,!t.bGetVisible())?t:null},n.prototype.bDerniereColonneVisible=function(n){var t=this.m_tabPositionAffichage,i;if(t[n].m_oColonne.m_bAjustable)return!1;for(i=t.length;n<i;n++)if(t[n].m_oColonne.bGetVisible())return!1;return!0},n.prototype.ColonnesRestaure=function(){this.__bRedimEffectue()&&(this.m_oStyleCacheLargeur.CreationAjout(),this.__RestaureLargeurColonnes_StyleEnCreation(this.m_tabColonnesTaille),this.m_oStyleCacheLargeur.CreationFin(),this.m_oChampTable.m_oHote.style.width=this.m_sTableTaille,this.m_oChampTable.m_oTitrePosPixel&&(this.m_oChampTable.m_oTitrePosPixel.style.width=this.m_sTableTitreTaille),this.m_tabColonnesTaille=null,this.m_sTableTaille=null,this.m_sTableTitreTaille=null)},n.prototype._vbOnMouseDown=function(n,t,i){var r=this.m_oChampTable._oGetColonne(t),u=this.m_oChampTable.oGetIDCelluleRel(0,t).parentNode.offsetWidth;return(r.m_nLargeur=u,!WDDrag.prototype._vbOnMouseDown.apply(this,[n]))?!1:(this.__bRedimEffectue()||(this.m_oStyleCacheLargeur.CreationAjout(),this.__ColonnesFige_StyleEnCreation(),this.__SetDimColonne(r,u),this.m_oStyleCacheLargeur.CreationFin()),this.m_oColonne=r,this.m_nLargeurOriginale=u,this.m_nLargeurMinimale=i,!0)},n.prototype._vOnMouseMove=function(n){var t,r,i;WDDrag.prototype._vOnMouseMove.apply(this,arguments);t=this.nGetOffsetPosX(n)+this.m_nLargeurOriginale;t<8&&(t=8);-1!==this.m_nLargeurMinimale&&t<this.m_nLargeurMinimale&&(t=this.m_nLargeurMinimale);this.m_oColonne.m_nLargeur=t;this.m_oStyleCacheLargeur.CreationAjout();this.__SetDimColonne(this.m_oColonne,t);this.m_oStyleCacheLargeur.CreationFin();this.m_oChampTable.bMAJNbLignesVisibles&&this.m_oChampTable.bMAJNbLignesVisibles(!0,!0)&&(this.m_oStyleCacheLargeur.CreationAjout(),r=this.__tabSauveLargeurColonnes_StyleEnCreation(!1),this.m_oStyleCacheLargeur.CreationFin(),this.m_oChampTable.bMAJNbLignesVisibles(!0,!1)&&(this.m_oStyleCacheLargeur.CreationAjout(),this.__RestaureLargeurColonnes_StyleEnCreation(r),this.m_oStyleCacheLargeur.CreationFin()));bIE&&!clWDUtil.bHTML5&&(this.m_oChampTable.m_oHote.className+="",this.m_oChampTable.m_oTitrePosPixel.className+="");WDChamp.prototype.ms_nIDObjetImage===this.m_oColonne.m_eTypeIDObjet&&(i=clWDUtil.tabGetElementsByClass(this.m_oChampTable.m_oHote,this.m_oColonne.ms_sClasseImage),this.m_oChampTable.m_bHauteurLigneVariable&&clWDUtil.bForEach(i,WDTableZRNavigateur.prototype.s_bRedimImageDebutRedimCol),clWDUtil.bForEach(i,WDTableZRNavigateur.prototype.s_bRedimImageFinRedimCol))},n.prototype._vOnMouseUp=function(){this.m_nLargeurMinimale=null;this.m_nLargeurOriginale=null;this.m_oColonne=null;WDDrag.prototype._vOnMouseUp.apply(this,arguments)},n.prototype.__tabSauveLargeurColonnes_StyleEnCreation=function(n){for(var f=[],i=0,t=this.m_oChampTable.oGetIDCelluleRel(0,i),o=this.m_oChampTable._nGetNbColonnes(),r,e,u;t||i<o;){if(t){while(!clWDUtil.bBaliseEstTag(t,"td"))t=t.parentNode;r=clWDUtil.oGetCurrentStyle(t);e=r.visibility;(e==="visible"||e==="inherit")&&r.display!=="none"&&(-1===(clWDUtil.oGetCurrentStyle(t).width+"").indexOf("%")&&n||(u=t.offsetWidth,bIEQuirks||(u-=WDChamp.prototype.s_nGetOffsetBorderPourWidth(r)),n?(f[i]=clWDUtil.oGetCurrentStyle(t).width,this.__SetDimColonne(this.m_oChampTable._oGetColonne(i),u)):f[i]=u))}i++;t=this.m_oChampTable.oGetIDCelluleRel(0,i)}return f},n.prototype.__RestaureLargeurColonnes_StyleEnCreation=function(n){for(var i=n.length,t=0;t<i;t++)n[t]!==undefined&&this.__SetDimColonne(this.m_oChampTable._oGetColonne(t),n[t])},n.prototype.__bRedimEffectue=function(){return!!this.m_tabColonnesTaille},n.prototype.__ColonnesFige_StyleEnCreation=function(){var n=this.m_oChampTable.m_oHote,t=this.m_oChampTable.m_oTitrePosPixel;this.m_sTableTaille=n.style.width;t&&(this.m_sTableTitreTaille=t.style.width);this.m_tabColonnesTaille=this.__tabSauveLargeurColonnes_StyleEnCreation(!0);n.style.width="";t&&(t.style.width="");clWDUtil.bHTML5||(n.width&&""!==n.width&&(n.width=""),n.parentNode.style.width&&""!==n.parentNode.style.width&&(n.parentNode.style.width=""),t&&t.width&&""!==t.width&&(t.width=""))},n.prototype.__SetDimColonne=function(n,t){var i=String(t),r;r=-1!==i.indexOf("%")?i:"calc("+i+"px - var(--wb-table-padding-horiz-"+n.m_sAlias+",0px))";this.m_oStyleCacheLargeur.Ajoute(this.m_sPrefixe+n.m_sAlias,["width:"+r,"min-width:auto"])},n}();WDTableZRCommun=function(){function n(){arguments.length&&WDChamp.prototype.constructor.apply(this,arguments)}return n.prototype=new WDChamp,n.prototype.constructor=n,n.prototype.s_tabGetStyles=function(n){var t=[];return clWDUtil.bForEach(n,function(n){return t.push(clWDUtil.tabSplitClasses(n)),!0}),t},n.prototype.s_SetStyleSelonSelection=function(n,t,i,r){function f(n,t,i){clWDUtil.bForEach(t,function(t){return clWDUtil.ActiveDesactiveClassName(n,t,i),!0})}function e(t){var i=n.oGetIDElement(t),r;return(clWDUtil.bBaliseEstTag(i,"table")?r=i.getElementsByTagName("td")[0]:clWDUtil.bBaliseEstTag(i,"div")&&(r=i.parentNode),clWDUtil.bBaliseEstTag(r,"td"))?r:null}var u=e(i);u&&(r?f(u,t[2],!0):(f(u,t[2],!1),f(u,t[(i-1)%2],!0)))},n.prototype._InfoXY=function(n,t,i,r){var f;if(!r)return-1;var e=r.getBoundingClientRect(),o=e.x+Number(t),s=e.y+Number(i),h=r.ownerDocument,u;if(bIE){if(u=h.msElementsFromPoint(o,s),null===u)return-1}else u=h.elementsFromPoint(o,s);f=this._xvoGetInfoXY(r,u);switch(Number(n)){case 1:return f.nLigne;case 2:return f.nColonne;default:throw new WDErreur(303,n);}},n.prototype.InfoXY=function(n,t,i){return this._InfoXY(n,t,i,_JGE(this.m_sAliasChamp,document,!0,!1))},n.prototype._pfGetParseurIdLigne=function(n){var t=new RegExp("^"+this.m_sAliasChamp+"_(\\d+)$");return function(i){var r,u;return clWDUtil.bBaliseEstTag(i,n)&&(r=t.exec(i.id),r&&2===r.length&&(u=Number(r[1]),!isNaN(u)))?u:undefined}},n.prototype._pfGetParseurRupture=function(){var n=new RegExp("^"+this.m_sAliasChamp+"-[HB]-\\d+-(\\d+)$");return function(t){var i=n.exec(t.id),r;return i&&2===i.length&&(r=Number(i[1]),!isNaN(r))?r:undefined}},n}();WDTableZRNavigateur.prototype.InfoXY=WDTableZRCommun.prototype.InfoXY;WDTableZRNavigateur.prototype._InfoXY=WDTableZRCommun.prototype._InfoXY;WDTableZRNavigateur.prototype._pfGetParseurIdLigne=WDTableZRCommun.prototype._pfGetParseurIdLigne;WDTableZRNavigateur.prototype._pfGetParseurRupture=WDTableZRCommun.prototype._pfGetParseurRupture;var WDTableZRClassique=function(){function n(n,t,i,r,u){if(arguments.length){WDTableZRCommun.prototype.constructor.apply(this,arguments);var f=u[0];this.m_tabStyles=this.s_tabGetStyles(f)}}return n.prototype=new WDTableZRCommun,n.prototype.constructor=n,n.prototype.OnSelectLigne=function(n,t,i){if(this.m_oChampFormulaire){var r=parseInt(this.m_oChampFormulaire.value,10);r!==n&&(this.s_SetStyleSelonSelection(this,this.m_tabStyles,r,!1),this.s_SetStyleSelonSelection(this,this.m_tabStyles,n,!0),this.m_oChampFormulaire.value=n,this.RecuperePCode(this.ms_nEventNavSelectLigne)(i))}},n}(),WDTableClassique=function(){function n(){arguments.length&&WDTableZRClassique.prototype.constructor.apply(this,arguments)}return n.prototype=new WDTableZRClassique,n.prototype.constructor=n,n.prototype._xvoGetInfoXY=function(n,t){var i={nLigne:-1,nColonne:-1},r=this._pfGetParseurIdLigne("tr"),u=this._pfGetParseurRupture();return clWDUtil.bForEach(t,function(n){var t,f,e,o;return clWDUtil.bBaliseEstTag(n,"td")&&(t=n.parentNode,f=r(t),undefined!==f&&(i.nLigne=f,e=1,!clWDUtil.bForEach(t.children,function(t){return t===n?(i.nColonne=e,!1):(clWDUtil.bBaliseEstTag(t,"td")&&!clWDUtil.bAvecClasse(t,"wbtablesep")&&e++,!0)})))?!1:(o=u(n),undefined!==o)?(i.nLigne=o,i.nColonne=-1,!1):!0}),i},n}(),WDZRClassique=function(){function n(){arguments.length&&WDTableZRClassique.prototype.constructor.apply(this,arguments)}return n.prototype=new WDTableZRClassique,n.prototype.constructor=n,n.prototype.vbZR=function(){return!0},n.prototype._xvoGetInfoXY=function(n,t){var i={nLigne:-1,nColonne:-1},r=this._pfGetParseurIdLigne("div"),u=this._pfGetParseurRupture();return clWDUtil.bForEach(t,function(n){var f=r(n),t;return undefined!==f?(i.nLigne=f,i.nColonne=-1,!1):(t=u(n),undefined!==t)?(i.nLigne=t,i.nColonne=-1,!1):!0}),i},n}()