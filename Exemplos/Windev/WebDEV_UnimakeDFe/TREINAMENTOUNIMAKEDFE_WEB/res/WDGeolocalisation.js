/*! 28.0.1.0 */
/*! VersionVI: 01F280095g   */
function WDGeoPosition(n){WDTypeAvance.prototype.constructor.apply(this,[!0]);n||(n={coords:{latitude:0,longitude:0}});this.m_oPosition=n}function bValDef(n,t){return n!==null&&n!==undefined&&n!==NaN&&(t||n>=0)}function sComplete0(n,t){for(n=""+n;n.length<t;)n="0"+n;return n}function WDGPS(){}function GPSEtat(){return navigator!=null&&navigator.geolocation!=null?gpsActive:gpsDesactive}function GPSPCSAppelProcPosition(n,t){gpsPCSPosition!=null&&(gpsPCSPosition.m_oPosition!=null&&(gpsPCSPosition.m_oPosition.coords!=null&&delete gpsPCSPosition.m_oPosition.coords,delete gpsPCSPosition.m_oPosition),delete gpsPCSPosition);var i=clWDUtil.oCloneObjet(t,t);i.coords=clWDUtil.oCloneObjet(i.coords,i.coords);gpsPCSPosition=new WDGeoPosition(i);n(gpsPCSPosition,gpsErreurOK)}function GPSPCSAppelProcErreur(n,t){n(null,t.code)}function GPSRecuperePosition(n,t){GPSEtat()==gpsActive&&navigator.geolocation.getCurrentPosition(function(t){GPSPCSAppelProcPosition(n,t)},function(t){GPSPCSAppelProcErreur(n,t)},{timeout:undefined===t?6e4:t})}function GPSSuitDeplacement(n,t,i){if(GPSEtat()==gpsActive)return(gpsPCSSuivi!=null&&(WDGPS._RetireEcoute(gpsPCSSuivi),gpsPCSSuivi=null),n==null)?void 0:gpsPCSSuivi=WDGPS._AjouteEcoute({fCallback:n,nDelai:t,nDistance:i})}function GPSArreteDetection(n){WDGPS._RetireEcoute(n)}function GPSTermine(){WDGPS._Term(!0)}function GPSDetectePosition(n,t,i,r,u){if(GPSEtat()==gpsActive)return WDGPS._AjouteEcoute({fCallback:n,nLatitude:t,nLongitude:i,nRayon:r,nDelai:u})}function GPSDernierePosition(){return gpsPCSPosition}function geoAzimut(n,t){var i=new WDDinoMarqueur(n),r=new WDDinoMarqueur(t);return WDGPS._gnAzimutEntreDeuxPoints(i.m_oPosition.GetLatitude(),i.m_oPosition.GetLongitude(),r.m_oPosition.GetLatitude(),r.m_oPosition.GetLongitude())}function geoDistance(n,t,i){var u=new WDDinoMarqueur(n),f=new WDDinoMarqueur(t),r=WDGPS._gnDistanceEnMetreEntreDeuxPoints(u.m_oPosition.GetLatitude(),u.m_oPosition.GetLongitude(),f.m_oPosition.GetLatitude(),f.m_oPosition.GetLongitude()),e=1;typeof i=="number"&&(e=i);switch(e){case 2:return r;case 3:return r*.621371192;default:return r*1e3}}function geoRecupereZone(n){var f=WDCarteGoogleMaps.prototype.clJSONAppelRequeteRecupPositionAdresse(n),t=f.results;if(!t)throw new WDErreur(1300);var i=t[0].geometry.viewport,r=i.northeast,u=i.southwest;return new NSPCS.NSValues.CValeursMultiples([new WDGeoPosition({coords:{latitude:r.lat,longitude:u.lng}}),new WDGeoPosition({coords:{latitude:u.lat,longitude:r.lng}})])}function WDDinoBaseObjetCarte(){arguments.length&&(WDTypeAvance.prototype.constructor.apply(this,[!0]),this.m_sNom=this.sCreerIdentifiant(),this.m_sDescription="",this.m_sActionClic="",this.m_czIDInterne=undefined,this.m_nAltitude=0)}function WDDinoCarteObjetAvecImage(){arguments.length&&(WDDinoBaseObjetCarte.prototype.constructor.apply(this,arguments),this.m_sImage="",this.m_eAlignement=WDCarteAPI.emqHaut,this.m_oPosition=new WDGeoPosition,this.m_nOpacite=100)}function WDDinoMarqueurImage(n){WDTypeAvance.prototype.constructor.apply(this,[!0]);this.m_eForme=WDCarteAPI.nFormeRond;this.m_nTaille=40;this.m_sTexte="";this.m_clCouleur=new clWDUtil.WDDinoCouleur(16777215);this.m_clCouleurFond=new clWDUtil.WDDinoCouleur(15233818);this.Clone(n)}function WDDinoMarqueur(n){WDDinoCarteObjetAvecImage.prototype.constructor.apply(this,[!0]);this.m_bIsDeplacable=!1;this.m_bClusteur=!1;this.m_bAvecPopup=!1;this.m_sActionClicPopup="";this.m_sActionClicDeplacement="";this.m_sNote="";this.m_bMarqueurImage=!1;this.m_clMarqueurImage=new WDDinoMarqueurImage;n instanceof WDGeoPosition?this.SetPosition(n):clWDUtil.isObject(n)?this.Copie(n,!0):clWDUtil.isArray(n)&&(this.SetLatitude(n[0]),this.SetLongitude(n[1]))}function WDDinoAdresse(){WDTypeAvance.prototype.constructor.apply(this,[!0]);this.m_czRue="";this.m_czVille="";this.m_czCodePostal="";this.m_czRegion="";this.m_czPays="";this.m_pclGeoPosition=undefined}function WDDinoCarteForme(){arguments.length&&(this.m_eType=WDDinoCarteForme.eTypeFormeCercle,WDDinoBaseObjetCarte.prototype.constructor.apply(this,arguments),this.m_sTrait=new clWDUtil.WDDinoCouleur(WDDinoCarteForme.nCouleurDefaut),this.m_eTrait=WDCarteAPI.nTypeTraitContinu,this.m_nEpaisseur=2)}function WDDinoCartePolyligne(n,t){n!==!0&&(WDDinoCarteForme.prototype.constructor.apply(this,[!0]),this.m_eType=WDDinoCarteForme.eTypeFormePolyligne,this.m_tabPoints=[],this.m_bGeodesique=!1,n&&this.constructor==WDDinoCartePolyligne&&this.Copie(n,t))}function WDDinoCartePolygone(n,t){WDDinoCartePolyligne.prototype.constructor.apply(this,arguments);this.m_eType=WDDinoCarteForme.eTypeFormePolygone;this.m_sRemplissage=this._oCouleurFondDefaut();this.Copie(n,t)}function WDDinoCarteCercle(n,t){WDDinoCarteForme.prototype.constructor.apply(this,[!0]);this.m_eType=WDDinoCarteForme.eTypeFormeCercle;this.m_sRemplissage=this._oCouleurFondDefaut();this.m_oCentre=new WDGeoPosition;this.m_dRayon=100;this.Copie(n,t)}function WDDinoCarteImage(n,t){WDDinoCarteObjetAvecImage.prototype.constructor.apply(this,[!0]);this.m_eAlignement=WDCarteAPI.emqCentre;this.m_dLargeur=0;this.m_dHauteur=0;this.m_nAngleDegres=0;this.Copie(n,t)}function WDCarte(){if(arguments.length&&(WDChampParametres.prototype.constructor.apply(this,arguments),this.m_oModele={},this.m_oSuitDeplacement=undefined,this.m_bUpdateUI=!1,window.clWDUtil!==undefined&&document.documentMode!==undefined&&document.compatMode!="BackCompat")){var n=this;clWDUtil.AttacheOnScrollResize(function(t,i){var r,u;i||(r=document.getElementById(n.__sGetHote()),r)&&(u=r.clientHeight,n.m_nDerniereHauteur&&n.m_nDerniereHauteur==u||n.m_oModele.UpdateSize&&n.m_oModele.UpdateSize(),n.m_nDerniereHauteur=u)})}}var gpsActive=1,gpsDesactive=2,gpsErreurOK=0,gpsErreurDroit=1,gpsErreurPosition=2,gpsErreurTimeout=3,gpsPCSSuivi=null,gpsPCSPosition=null;typeof Number.prototype.toRad=="undefined"&&(Number.prototype.toRad=function(n){return(n?this%360:this)*Math.PI/180},Number.prototype.toDeg=function(n){return(n?this%360:this)*(180/Math.PI)});WDGeoPosition.prototype=new WDTypeAvance;WDGeoPosition.prototype.constructor=WDGeoPosition;WDGeoPosition.prototype.ms_nIdPropLatitude=0;WDGeoPosition.prototype.ms_nIdPropLongitude=1;WDGeoPosition.prototype.ms_nIdPropAltitude=2;WDGeoPosition.prototype.ms_nIdPropAltitudeValide=3;WDGeoPosition.prototype.ms_nIdPropDirection=4;WDGeoPosition.prototype.ms_nIdPropDirectionValide=5;WDGeoPosition.prototype.ms_nIdPropPrecision=6;WDGeoPosition.prototype.ms_nIdPropPrecisionValide=7;WDGeoPosition.prototype.ms_nIdPropVitesse=8;WDGeoPosition.prototype.ms_nIdPropVitesseValide=9;WDGeoPosition.prototype.ms_nIdPropDateMesure=10;WDGeoPosition.prototype.ms_nIdPropPositionValide=11;WDGeoPosition.prototype.GetLatitude=function(){return this.m_oPosition.coords.latitude};WDGeoPosition.prototype.GetLongitude=function(){return this.m_oPosition.coords.longitude};WDGeoPosition.prototype.SetLatitude=function(n){this.m_oPosition.m_dLatitude=this.m_oPosition.coords.latitude=parseFloat(n)};WDGeoPosition.prototype.SetLongitude=function(n){this.m_oPosition.m_dLongitude=this.m_oPosition.coords.longitude=parseFloat(n)};WDGeoPosition.prototype.GetProp=function(n){switch(n){case this.ms_nIdPropLatitude:return this.GetLatitude();case this.ms_nIdPropLongitude:return this.GetLongitude();case this.ms_nIdPropAltitude:return bValDef(this.m_oPosition.coords.altitude,!0)?this.m_oPosition.coords.altitude:0;case this.ms_nIdPropAltitudeValide:return bValDef(this.m_oPosition.coords.altitude,!0);case this.ms_nIdPropDirection:return bValDef(this.m_oPosition.coords.heading)?this.m_oPosition.coords.heading:0;case this.ms_nIdPropDirectionValide:return bValDef(this.m_oPosition.coords.heading);case this.ms_nIdPropPrecision:return bValDef(this.m_oPosition.coords.accuracy)?this.m_oPosition.coords.accuracy:0;case this.ms_nIdPropPrecisionValide:return bValDef(this.m_oPosition.coords.accuracy);case this.ms_nIdPropVitesse:return bValDef(this.m_oPosition.coords.speed)?this.m_oPosition.coords.speed:0;case this.ms_nIdPropVitesseValide:return bValDef(this.m_oPosition.coords.speed);case this.ms_nIdPropDateMesure:var t=new Date(this.m_oPosition.timestamp);return sComplete0(t.getFullYear(),4)+sComplete0(t.getMonth()+1,2)+sComplete0(t.getDate(),2)+sComplete0(t.getHours(),2)+sComplete0(t.getMinutes(),2)+sComplete0(t.getSeconds(),2)+sComplete0(Math.floor(this.m_oPosition.timestamp%1e3/10),2);case this.ms_nIdPropPositionValide:return bValDef(this.GetLatitude())&&bValDef(this.GetLongitude());default:return WDTypeAvance.prototype.GetProp.apply(this,arguments)}};WDGeoPosition.prototype.vbGetPositionValide=function(){return WDCarteAPI.bValideCoordonnees(this.m_dLatitude,this.m_dLongitude)};WDGeoPosition.prototype.SetProp=function(n,t){var r=this.m_oPosition,i,u;if(r!=null&&(i=r.coords,i!=null))switch(n){case this.ms_nIdPropLatitude:this.SetLatitude(t);break;case this.ms_nIdPropLongitude:this.SetLongitude(t);break;case this.ms_nIdPropAltitude:i.altitude=t;break;case this.ms_nIdPropDirection:i.heading=t;break;case this.ms_nIdPropPrecision:i.accuracy=t;break;case this.ms_nIdPropVitesse:i.speed=t;break;case this.ms_nIdPropDateMesure:u=new Date;clWDUtil.bSetDateHeureFromWL(u,t,!1,!0,!0);r.timestamp=u.getTime();break;default:WDTypeAvance.prototype.SetProp.apply(this,arguments)}};WDGPS.gtabWatch=[];WDGPS.gnIdSurveillancePosition=-1;WDGPS._RetireEcoute=function(n){WDGPS.gtabWatch[n]=undefined;WDGPS._Term()};WDGPS._AjouteEcoute=function(n){return WDGPS._Init(),WDGPS.gtabWatch.push(n)-1};WDGPS._Init=function(){WDGPS.gnIdSurveillancePosition===-1&&WDGPS._SurveillancePosition()};WDGPS._Term=function(n){if(WDGPS.gnIdSurveillancePosition>-1){if(n!==!0)for(var t=0;t<WDGPS.gtabWatch.length;++t)if(WDGPS.gtabWatch[t]!==undefined)return;WDGPS.gtabWatch=[];navigator.geolocation.clearWatch(WDGPS.gnIdSurveillancePosition)}};WDGPS._SurveillancePosition=function(){WDGPS.gnIdSurveillancePosition=navigator.geolocation.watchPosition(function(n){WDGPS._SurveillancePositionSucces(n)},function(n){WDGPS._SurveillancePositionErreur(n)})};WDGPS._gnDistanceEnMetreEntreDeuxPoints=function(n,t,i,r){var o=Number(n).toRad(),s=Number(i).toRad(),u=Number(i-n).toRad(),f=Number(r-t).toRad(),e=Math.sin(u/2)*Math.sin(u/2)+Math.cos(o)*Math.cos(s)*Math.sin(f/2)*Math.sin(f/2),h=2*Math.atan2(Math.sqrt(e),Math.sqrt(1-e));return 6371*h};WDGPS._gnAzimutEntreDeuxPoints=function(n,t,i,r){var f=Number(n).toRad(),u=Number(i).toRad(),e=Number(r-t).toRad(),o=Math.sin(e)*Math.cos(u),s=Math.cos(f)*Math.sin(u)-Math.sin(f)*Math.cos(u)*Math.cos(e);return Math.atan2(o,s).toDeg()};WDGPS._SurveillancePositionSucces=function(n){for(var t,u,r,f,e,i=WDGPS.gtabWatch.length-1;i>-1;--i)if(t=WDGPS.gtabWatch[i],t){if((t.nDelai||-1)>-1)if(t.nPremierTimestamp){if(n.timestamp-t.nPremierTimestamp>t.nDelai*10){WDGPS._RetireEcoute(i);continue}}else t.nPremierTimestamp=n.timestamp;if(t.nLatitude!==undefined){if(u=t.nRayon||50,r=u>=WDGPS._gnDistanceEnMetreEntreDeuxPoints(n.coords.latitude,n.coords.longitude,t.nLatitude,t.nLongitude),t.bEtaitDansZone===undefined&&(t.bEtaitDansZone=!1),r==t.bEtaitDansZone)continue;t.bEtaitDansZone=r}else{if(f=t.nDistance||5,t.oDernierePosition&&(e=WDGPS._gnDistanceEnMetreEntreDeuxPoints(n.coords.latitude,n.coords.longitude,t.oDernierePosition.latitude,t.oDernierePosition.longitude),e<f))continue;t.oDernierePosition=n.coords}GPSPCSAppelProcPosition(t.fCallback,n)}};WDGPS._SurveillancePositionErreur=function(n){for(var i,t=0;t<WDGPS.gtabWatch.length;++t)(i=WDGPS.gtabWatch[t],i)&&GPSPCSAppelProcErreur(i.fCallback,n)};WDDinoBaseObjetCarte.prototype=new WDTypeAvance;WDDinoBaseObjetCarte.prototype.constructor=WDDinoBaseObjetCarte;WDDinoBaseObjetCarte.prototype.RecuperePosition=function(){};WDDinoBaseObjetCarte.prototype.RecuperePositionObjet=function(n,t){if(t){var i=n.m_dLatitude!==undefined&&n.m_dLongitude!==undefined;i&&(this.SetLatitude(n.m_dLatitude),this.SetLongitude(n.m_dLongitude))}};WDDinoBaseObjetCarte.prototype.SetLatitudePosition=function(n,t){n.SetLatitude(t);this.m_dLatitude=t};WDDinoBaseObjetCarte.prototype.SetLongitudePosition=function(n,t){n.SetLongitude(t);this.m_dLongitude=t};WDDinoBaseObjetCarte.prototype.Clone=function(n,t){var u,i,r,f;for(u in n)n.hasOwnProperty(u)&&(i=n[u],r=this[u],(t||typeof r!=typeof i)&&(f=!1,t&&(f=!0,clWDUtil.isArray(i)&&i.length&&i[0].m_dLatitude!==undefined?(r.length=0,clWDUtil.bForEach(i,function(n){return r.push(WDDinoBaseObjetCarte.clRecupPositionDonnerServeur(n)),!0})):r instanceof clWDUtil.WDDinoCouleur?r.SetProp(7,i):r instanceof WDTypeAvance&&!(i instanceof WDTypeAvance)?WDDinoBaseObjetCarte.prototype.Clone.apply(r,[i,t]):f=!1),f||(this[u]=i)));WDTypeAvance.prototype.Clone.apply(this,arguments)};WDDinoBaseObjetCarte.prototype.Copie=function(n,t){if(n&&(t||this.constructor==n.constructor)){var i=this.m_czIDInterne;this.Clone(n,t);this.m_czIDInterne=i;this.RecuperePosition(n,t)}};WDDinoBaseObjetCarte.prototype.clClone=function(){var n=new this.constructor;return n.Clone(this),n};WDDinoBaseObjetCarte.prototype.SetIDInterne=function(n){this.m_czIDInterne=n};WDDinoBaseObjetCarte.prototype.pszGetIDInterne=function(){return this.m_czIDInterne};WDDinoBaseObjetCarte.clClasseObjet=function(n){switch(n.m_eType){case WDDinoCarteForme.eTypeFormeCercle:return WDDinoCarteCercle;case WDDinoCarteForme.eTypeFormePolygone:return WDDinoCartePolygone;case WDDinoCarteForme.eTypeFormePolyligne:return WDDinoCartePolyligne}};WDDinoBaseObjetCarte.SerialisePositionPourJsonServeur=function(n,t){n.m_dLatitude=WDGeoPosition.prototype.GetLatitude.apply(t);n.m_dLongitude=WDGeoPosition.prototype.GetLongitude.apply(t)};WDDinoBaseObjetCarte.clRecupPositionDonnerServeur=function(n){var t=new WDGeoPosition;return t.SetLatitude(n.m_dLatitude),t.SetLongitude(n.m_dLongitude),t};WDDinoBaseObjetCarte.prototype.NettoyagePourJsonServeur=function(){delete this.m_czIDInterne};WDDinoBaseObjetCarte.prototype.clCloneNettoyePourJsonServeur=function(){var n=this.clClone();return n.NettoyagePourJsonServeur(),n};WDDinoBaseObjetCarte.nPropOpaciteCouleur=3;WDDinoBaseObjetCarte.nOpaciteDinoCouleur=function(n){return n.GetProp(WDDinoBaseObjetCarte.nPropOpaciteCouleur)};WDDinoBaseObjetCarte.SetOpaciteDinoCouleur=function(n,t){n.SetProp(WDDinoBaseObjetCarte.nPropOpaciteCouleur,t)};WDDinoBaseObjetCarte.nOpaciteMaxDinoCouleur=WDCarteAPI.nOpaciteCouleurWLMax;WDDinoBaseObjetCarte.sCouleurSansOpaciteDinoCouleur=function(n){var t=WDDinoBaseObjetCarte.nOpaciteDinoCouleur(n),i=t<WDDinoBaseObjetCarte.nOpaciteMaxDinoCouleur,r;return i&&WDDinoBaseObjetCarte.SetOpaciteDinoCouleur(n,WDDinoBaseObjetCarte.nOpaciteMaxDinoCouleur),r=n.toString(),i&&WDDinoBaseObjetCarte.SetOpaciteDinoCouleur(n,t),r};WDDinoCarteObjetAvecImage.prototype=new WDDinoBaseObjetCarte;WDDinoCarteObjetAvecImage.prototype.constructor=WDDinoCarteObjetAvecImage;WDDinoCarteObjetAvecImage.prototype.RecuperePosition=function(n,t){this.RecuperePositionObjet(n,t)};WDDinoCarteObjetAvecImage.prototype.SetPosition=function(n){this.m_oPosition=n;this.m_oPosition&&(this.SetLatitude(this.m_oPosition.GetLatitude()),this.SetLongitude(this.m_oPosition.GetLongitude()))};WDDinoCarteObjetAvecImage.prototype.SetLatitude=function(n){this.SetLatitudePosition(this.m_oPosition,n)};WDDinoCarteObjetAvecImage.prototype.SetLongitude=function(n){this.SetLongitudePosition(this.m_oPosition,n)};WDDinoCarteObjetAvecImage.prototype.NettoyagePourJsonServeur=function(){WDDinoBaseObjetCarte.prototype.NettoyagePourJsonServeur.apply(this,[]);delete this.m_oPosition};WDDinoMarqueurImage.prototype=new WDTypeAvance;WDDinoMarqueurImage.prototype.constructor=WDDinoMarqueurImage;WDDinoMarqueurImage.prototype.ms_sNomPourParam="MARQUEURIMAGE";WDDinoMarqueurImage.prototype.GetProp=function(n){switch(n){case 0:return this.m_eForme;case 1:return this.m_nTaille;case 2:return this.m_sTexte;case 3:return this.m_clCouleur;case 4:return this.m_clCouleurFond;default:return WDTypeAvance.prototype.GetProp.apply(this,arguments)}};WDDinoMarqueurImage.prototype.SetProp=function(n,t){switch(n){case 0:this.m_eForme=t;break;case 1:this.m_nTaille=t;break;case 2:this.m_sTexte=t;break;case 3:this.m_clCouleur=new clWDUtil.WDDinoCouleur(t);break;case 4:this.m_clCouleurFond=new clWDUtil.WDDinoCouleur(t)}};WDDinoMarqueur.prototype=new WDDinoCarteObjetAvecImage;WDDinoMarqueur.prototype.constructor=WDDinoMarqueur;WDDinoMarqueur.prototype.ms_sNomPourParam="MARQUEUR";WDDinoMarqueur.prototype.sCreerIdentifiant=function(){return WDCarteAPI.CreerIdentifiant(WDCarteAPI.nTypeMarqueur)};WDDinoMarqueur.prototype.bModifApiCarte=function(n,t){return n.m_oModele.MAP_ModifieMarqueur(t,this.m_oPosition.GetLatitude(),this.m_oPosition.GetLongitude(),this.m_sDescription,this.m_bMarqueurImage?"":clWDUtil.sGetCheminImage(this.m_sImage,clWDUtil.sGetCheminImage(n.m_oParametres.m_sImage,"")),this.m_eAlignement,undefined,this.m_sActionClic,this.m_nOpacite,this.m_nAltitude,this.m_bIsDeplacable,this.m_sActionClicDeplacement,this.m_bAvecPopup,this.m_sNom,this.m_sActionClicPopup,this.m_bClusteur,this.m_bMarqueurImage?this.m_clMarqueurImage.m_eForme:WDCarteAPI.nFormeNonDefini,this.m_bMarqueurImage?this.m_clMarqueurImage.m_nTaille:0,this.m_bMarqueurImage?this.m_clMarqueurImage.m_sTexte:"",this.m_bMarqueurImage?WDDinoBaseObjetCarte.sCouleurSansOpaciteDinoCouleur(this.m_clMarqueurImage.m_clCouleur):"",this.m_bMarqueurImage?WDDinoBaseObjetCarte.nOpaciteDinoCouleur(this.m_clMarqueurImage.m_clCouleur):0,this.m_bMarqueurImage?WDDinoBaseObjetCarte.sCouleurSansOpaciteDinoCouleur(this.m_clMarqueurImage.m_clCouleurFond):"",this.m_bMarqueurImage?WDDinoBaseObjetCarte.nOpaciteDinoCouleur(this.m_clMarqueurImage.m_clCouleurFond):0,"")};WDDinoMarqueur.prototype.GetProp=function(n){switch(n){case 0:return this.m_sNom;case 1:return this.m_oPosition;case 2:return this.m_sDescription;case 3:return this.m_bMarqueurImage?this.m_clMarqueurImage:this.m_sImage;case 4:return this.m_sActionClic;case 5:return this.m_eAlignement;case 6:return this.m_nOpacite;case 7:return this.m_bIsDeplacable;case 8:return this.m_nAltitude;case 9:return this.m_bClusteur;case 10:return this.m_bAvecPopup;case 11:return this.m_sActionClicPopup;case 12:return this.m_sActionClicDeplacement;case 13:return this.m_sNote;default:return WDTypeAvance.prototype.GetProp.apply(this,arguments)}};WDDinoMarqueur.prototype.SetProp=function(n,t){switch(n){case 0:this.m_sNom=t;break;case 1:this.SetPosition(t);break;case 2:this.m_sDescription=t;break;case 3:(this.m_bMarqueurImage=t instanceof WDDinoMarqueurImage)==!0?this.m_clMarqueurImage=t:this.m_sImage=t;break;case 4:this.m_sActionClic=t;break;case 5:this.m_eAlignement=t;break;case 6:this.m_nOpacite=t;break;case 7:this.m_bIsDeplacable=t;break;case 8:this.m_nAltitude=t;break;case 9:this.m_bClusteur=t;break;case 10:this.m_bAvecPopup=t;break;case 11:this.m_sActionClicPopup=t;break;case 12:this.m_sActionClicDeplacement=t;case 13:this.m_sNote=t;default:WDTypeAvance.prototype.SetProp.apply(this,arguments)}};WDDinoAdresse.prototype=new WDTypeAvance;WDDinoAdresse.prototype.constructor=WDDinoAdresse;WDDinoAdresse.prototype.GetProp=function(n){switch(n){case 0:return this.m_czRue;case 1:return this.m_czVille;case 2:return this.m_czCodePostal;case 3:return this.m_czRegion;case 4:return this.m_czPays;case 5:return this.m_pclGeoPosition||(this.m_pclGeoPosition=new WDGeoPosition),this.m_pclGeoPosition;default:return WDTypeAvance.prototype.GetProp.apply(this,arguments)}};WDDinoAdresse.prototype.SetProp=function(n,t){switch(n){case 0:this.m_czRue=t;break;case 1:this.m_czVille=t;break;case 2:this.m_czCodePostal=t;break;case 3:this.m_czRegion=t;break;case 4:this.m_czPays=t;break;case 5:this.m_pclGeoPosition||(this.m_pclGeoPosition=new WDGeoPosition);this.m_pclGeoPosition.Clone(t);break;default:WDTypeAvance.prototype.SetProp.apply(this,arguments)}};WDDinoAdresse.prototype.vGetAdresseComplete=function(){var n="";return this.m_czRue&&(n+=this.m_czRue),this.m_czVille&&(n&&(n+=", "),n+=this.m_czVille),this.m_czCodePostal&&(n&&(n+=", "),n+=this.m_czCodePostal),this.m_czRegion&&(n&&(n+=", "),n+=this.m_czRegion),this.m_czPays&&(n&&(n+=", "),n+=this.m_czPays),n};WDDinoCarteForme.nCouleurDefaut=15233818;WDDinoCarteForme.nOpaciteDefaut=35;WDDinoCarteForme.eTypeFormeCercle=0;WDDinoCarteForme.eTypeFormePolygone=1;WDDinoCarteForme.eTypeFormePolyligne=2;WDDinoCarteForme.prototype=new WDDinoBaseObjetCarte;WDDinoCarteForme.prototype.constructor=WDDinoCarteForme;WDDinoCarteForme.prototype._oCouleurFondDefaut=function(){var n=new clWDUtil.WDDinoCouleur(WDDinoCarteForme.nCouleurDefaut);return WDDinoBaseObjetCarte.SetOpaciteDinoCouleur(n,WDDinoCarteForme.nOpaciteDefaut),n};WDDinoCartePolyligne.prototype=new WDDinoCarteForme;WDDinoCartePolyligne.prototype.constructor=WDDinoCartePolyligne;WDDinoCartePolyligne.prototype.ms_sNomPourParam="CARTEPOLYLIGNE";WDDinoCartePolyligne.prototype.sCreerIdentifiant=function(){return WDCarteAPI.CreerIdentifiant(WDCarteAPI.nTypePolyligne)};WDDinoCartePolyligne.prototype.NettoyagePourJsonServeur=function(){WDDinoCarteForme.prototype.NettoyagePourJsonServeur.apply(this,[]);clWDUtil.bForEach(this.m_tabPoints,function(n){return WDDinoBaseObjetCarte.SerialisePositionPourJsonServeur(n,n),delete n.m_oPosition,!0})};WDDinoCartePolyligne.prototype._tabPointApi=function(){var n=[];return clWDUtil.bForEach(this.m_tabPoints,function(t){return n.push([t.GetLatitude(),t.GetLongitude()]),!0}),n};WDDinoCartePolyligne.prototype.nAjoutApiCarte=function(n,t){return n.MAP_AjoutePolyligne(this._tabPointApi(),WDDinoBaseObjetCarte.sCouleurSansOpaciteDinoCouleur(this.m_sTrait),this.m_eTrait,this.m_nEpaisseur,WDDinoBaseObjetCarte.nOpaciteDinoCouleur(this.m_sTrait),this.m_sDescription,this.m_sActionClic,this.m_nAltitude,this.m_bGeodesique,t)};WDDinoCartePolyligne.prototype.bModifApiCarte=function(n,t){return n.m_oModele.MAP_ModifiePolyligne(t,this._tabPointApi(),WDDinoBaseObjetCarte.sCouleurSansOpaciteDinoCouleur(this.m_sTrait),this.m_eTrait,this.m_nEpaisseur,WDDinoBaseObjetCarte.nOpaciteDinoCouleur(this.m_sTrait),this.m_sDescription,this.m_sActionClic,this.m_nAltitude,this.m_bGeodesique)};WDDinoCartePolyligne.prototype.GetProp=function(n){switch(n){case 0:return this.m_sNom;case 1:return this.m_sDescription;case 2:return this.m_sTrait;case 3:return this.m_eTrait;case 4:return this.m_nAltitude;case 5:return this.m_sActionClic;case 6:return this.m_nEpaisseur;case 7:return this.m_bGeodesique;case 8:return this.m_tabPoints;default:return WDTypeAvance.prototype.GetProp.apply(this,arguments)}};WDDinoCartePolyligne.prototype.SetProp=function(n,t){switch(n){case 0:this.m_sNom=t;break;case 1:this.m_sDescription=t;break;case 2:this.m_sTrait=new clWDUtil.WDDinoCouleur(t);break;case 3:this.m_eTrait=t;break;case 4:this.m_nAltitude=t;break;case 5:this.m_sActionClic=t;break;case 6:this.m_nEpaisseur=t;break;case 7:this.m_bGeodesique=t;break;case 8:this.m_tabPoints=t;break;default:WDTypeAvance.prototype.SetProp.apply(this,arguments)}};WDDinoCartePolygone.prototype=new WDDinoCartePolyligne(!0);WDDinoCartePolygone.prototype.constructor=WDDinoCartePolygone;WDDinoCartePolygone.prototype.ms_sNomPourParam="CARTEPOLYGONE";WDDinoCartePolygone.prototype.sCreerIdentifiant=function(){return WDCarteAPI.CreerIdentifiant(WDCarteAPI.nTypePolygone)};WDDinoCartePolygone.prototype.nAjoutApiCarte=function(n,t){return n.MAP_AjoutePolygone(this._tabPointApi(),WDDinoBaseObjetCarte.sCouleurSansOpaciteDinoCouleur(this.m_sTrait),this.m_eTrait,this.m_nEpaisseur,WDDinoBaseObjetCarte.nOpaciteDinoCouleur(this.m_sTrait),WDDinoBaseObjetCarte.sCouleurSansOpaciteDinoCouleur(this.m_sRemplissage),WDDinoBaseObjetCarte.nOpaciteDinoCouleur(this.m_sRemplissage),this.m_sDescription,this.m_sActionClic,this.m_nAltitude,this.m_bGeodesique,t)};WDDinoCartePolygone.prototype.bModifApiCarte=function(n,t){return n.m_oModele.MAP_ModifiePolygone(t,this._tabPointApi(),WDDinoBaseObjetCarte.sCouleurSansOpaciteDinoCouleur(this.m_sTrait),this.m_eTrait,this.m_nEpaisseur,WDDinoBaseObjetCarte.nOpaciteDinoCouleur(this.m_sTrait),WDDinoBaseObjetCarte.sCouleurSansOpaciteDinoCouleur(this.m_sRemplissage),WDDinoBaseObjetCarte.nOpaciteDinoCouleur(this.m_sRemplissage),this.m_sDescription,this.m_sActionClic,this.m_nAltitude,this.m_bGeodesique)};WDDinoCartePolygone.prototype.GetProp=function(n){switch(n){case 0:return this.m_sNom;case 1:return this.m_sDescription;case 2:return this.m_sActionClic;case 3:return this.m_sTrait;case 4:return this.m_sRemplissage;case 5:return this.m_eTrait;case 6:return this.m_nEpaisseur;case 7:return this.m_nAltitude;case 8:return this.m_bGeodesique;case 9:return this.m_tabPoints;default:return WDTypeAvance.prototype.GetProp.apply(this,arguments)}};WDDinoCartePolygone.prototype.SetProp=function(n,t){switch(n){case 0:this.m_sNom=t;break;case 1:this.m_sDescription=t;break;case 2:this.m_sActionClic=t;break;case 3:this.m_sTrait=new clWDUtil.WDDinoCouleur(t);break;case 4:this.m_sRemplissage=new clWDUtil.WDDinoCouleur(t);break;case 5:this.m_eTrait=t;break;case 6:this.m_nEpaisseur=t;break;case 7:this.m_nAltitude=t;break;case 8:this.m_bGeodesique=t;break;case 9:this.m_tabPoints=t;break;default:WDTypeAvance.prototype.SetProp.apply(this,arguments)}};WDDinoCarteCercle.prototype=new WDDinoCarteForme;WDDinoCarteCercle.prototype.constructor=WDDinoCarteCercle;WDDinoCarteCercle.prototype.ms_sNomPourParam="CARTECERCLE";WDDinoCarteCercle.prototype.RecuperePosition=function(n,t){this.RecuperePositionObjet(n,t)};WDDinoCarteCercle.prototype.sCreerIdentifiant=function(){return WDCarteAPI.CreerIdentifiant(WDCarteAPI.nTypeCercle)};WDDinoCarteCercle.prototype.NettoyagePourJsonServeur=function(){WDDinoCarteForme.prototype.NettoyagePourJsonServeur.apply(this,[]);WDDinoBaseObjetCarte.SerialisePositionPourJsonServeur(this,this.m_oCentre);delete this.m_oCentre};WDDinoCarteCercle.prototype.SetLatitude=function(n){this.SetLatitudePosition(this.m_oCentre,n)};WDDinoCarteCercle.prototype.SetLongitude=function(n){this.SetLongitudePosition(this.m_oCentre,n)};WDDinoCarteCercle.prototype.nAjoutApiCarte=function(n,t){return n.MAP_AjouteCercle(this.m_oCentre.GetLatitude(),this.m_oCentre.GetLongitude(),this.m_dRayon,WDDinoBaseObjetCarte.sCouleurSansOpaciteDinoCouleur(this.m_sTrait),this.m_eTrait,this.m_nEpaisseur,WDDinoBaseObjetCarte.nOpaciteDinoCouleur(this.m_sTrait),WDDinoBaseObjetCarte.sCouleurSansOpaciteDinoCouleur(this.m_sRemplissage),WDDinoBaseObjetCarte.nOpaciteDinoCouleur(this.m_sRemplissage),this.m_sDescription,this.m_sActionClic,this.m_nAltitude,t)};WDDinoCarteCercle.prototype.bModifApiCarte=function(n,t){return n.m_oModele.MAP_ModifieCercle(t,this.m_oCentre.GetLatitude(),this.m_oCentre.GetLongitude(),this.m_dRayon,WDDinoBaseObjetCarte.sCouleurSansOpaciteDinoCouleur(this.m_sTrait),this.m_eTrait,this.m_nEpaisseur,WDDinoBaseObjetCarte.nOpaciteDinoCouleur(this.m_sTrait),WDDinoBaseObjetCarte.sCouleurSansOpaciteDinoCouleur(this.m_sRemplissage),WDDinoBaseObjetCarte.nOpaciteDinoCouleur(this.m_sRemplissage),this.m_sDescription,this.m_sActionClic,this.m_nAltitude)};WDDinoCarteCercle.prototype.GetProp=function(n){switch(n){case 0:return this.m_sNom;case 1:return this.m_sDescription;case 2:return this.m_oCentre;case 3:return this.m_dRayon;case 4:return this.m_sTrait;case 5:return this.m_sRemplissage;case 6:return this.m_eTrait;case 7:return this.m_nAltitude;case 8:return this.m_nEpaisseur;case 9:return this.m_sActionClic;default:return WDTypeAvance.prototype.GetProp.apply(this,arguments)}};WDDinoCarteCercle.prototype.SetProp=function(n,t){switch(n){case 0:this.m_sNom=t;break;case 1:this.m_sDescription=t;break;case 2:this.m_oCentre=t;break;case 3:this.m_dRayon=t;break;case 4:this.m_sTrait=new clWDUtil.WDDinoCouleur(t);break;case 5:this.m_sRemplissage=new clWDUtil.WDDinoCouleur(t);break;case 6:this.m_eTrait=t;break;case 7:this.m_nAltitude=t;break;case 8:this.m_nEpaisseur=t;break;case 9:this.m_sActionClic=t;break;default:WDTypeAvance.prototype.SetProp.apply(this,arguments)}};WDDinoCarteImage.prototype=new WDDinoCarteObjetAvecImage;WDDinoCarteImage.prototype.constructor=WDDinoCarteImage;WDDinoCarteImage.prototype.ms_sNomPourParam="CARTEIMAGE";WDDinoCarteImage.prototype.sCreerIdentifiant=function(){return WDCarteAPI.CreerIdentifiant(WDCarteAPI.nTypeImage)};WDDinoCarteImage.prototype.nAjoutApiCarte=function(n,t){return n.MAP_AjouteImage(this.m_oPosition.GetLatitude(),this.m_oPosition.GetLongitude(),clWDUtil.sGetCheminImage(this.m_sImage,""),this.m_dLargeur,this.m_dHauteur,this.m_eAlignement,this.m_nOpacite,this.m_sDescription,this.m_sActionClic,this.m_nAltitude,this.m_nAngleDegres,t)};WDDinoCarteImage.prototype.bModifApiCarte=function(n,t){return n.m_oModele.MAP_ModifieImage(t,this.m_oPosition.GetLatitude(),this.m_oPosition.GetLongitude(),clWDUtil.sGetCheminImage(this.m_sImage,""),this.m_dLargeur,this.m_dHauteur,this.m_eAlignement,this.m_nOpacite,this.m_sDescription,this.m_sActionClic,this.m_nAltitude,this.m_nAngleDegres)};WDDinoCarteImage.prototype.GetProp=function(n){switch(n){case 0:return this.m_sNom;case 1:return this.m_sDescription;case 2:return this.m_oPosition;case 3:return this.m_eAlignement;case 4:return this.m_dLargeur;case 5:return this.m_dHauteur;case 6:return this.m_nAngleDegres;case 7:return this.m_sImage;case 8:return this.m_sActionClic;case 9:return this.m_nOpacite;case 10:return this.m_nAltitude;default:return WDTypeAvance.prototype.GetProp.apply(this,arguments)}};WDDinoCarteImage.prototype.SetProp=function(n,t){switch(n){case 0:this.m_sNom=t;break;case 1:this.m_sDescription=t;break;case 2:this.SetPosition(t);break;case 3:this.m_eAlignement=t;break;case 4:this.m_dLargeur=t;break;case 5:this.m_dHauteur=t;break;case 6:this.m_nAngleDegres=t;break;case 7:if(t instanceof WDDinoMarqueurImage)throw new WDErreur(903,"cha\u00eene/string","type avanc\u00e9/advanced type");this.m_sImage=t;break;case 8:this.m_sActionClic=t;break;case 9:this.m_nOpacite=t;break;case 10:this.m_nAltitude=t;break;default:WDTypeAvance.prototype.SetProp.apply(this,arguments)}};WDCarte.prototype=new WDChampParametres;WDCarte.prototype.constructor=WDCarte;WDCarte.prototype.OnDisplay=function(n,t){if((WDChampParametres.prototype.OnDisplay.apply(this,arguments),t)&&(this.m_bUpdateUI===!0||!this.oRecupereAPI())){this.m_bUpdateUI=!1;var i=document.getElementById(this.__sGetHote());i&&clWDUtil.bEstFils(i,n)&&this.__Reinit()}};WDCarte.prototype.GetProp=function(n){switch(n){case this.XML_CHAMP_PROP_NUM_MODECARTE:return this.oRecupereAPI()?this.m_oModele.MAP_GetModeCarte():this.m_oParametres.m_eModeCarte;case this.XML_CHAMP_PROP_NUM_ZOOM:return this.oRecupereAPI()?this.m_oModele.MAP_GetZoom():this.m_oParametres.m_nZoom;case this.XML_CHAMP_PROP_NUM_IMAGE:return this.m_oParametres.m_sImage;case this.XML_CHAMP_PROP_NUM_INFOTRAFIC:return this.oRecupereAPI()?this.m_oModele.MAP_GetInfoTrafic():this.m_oParametres.m_bInfoTrafic;case this.XML_CHAMP_PROP_NUM_BOUSSOLE:return this.oRecupereAPI()?this.m_oModele.MAP_GetBoussole():this.m_oParametres.m_bBoussole;case this.XML_CHAMP_PROP_NUM_AVECZOOM:return this.oRecupereAPI()?this.m_oModele.MAP_GetAvecZoom():this.m_oParametres.m_bAvecZoom;case this.XML_CHAMP_PROP_NUM_AVECROTATION:return this.oRecupereAPI()?this.m_oModele.MAP_GetAvecRotation():this.m_oParametres.m_bAvecRotation;case this.XML_CHAMP_PROP_NUM_AVECSCROLL:return this.oRecupereAPI()?this.m_oModele.MAP_GetAvecScroll():this.m_oParametres.m_bAvecScroll;case this.XML_CHAMP_PROP_NUM_AVECINCLINAISON:return this.oRecupereAPI()?this.m_oModele.MAP_GetAvecInclinaison():this.m_oParametres.m_bAvecInclinaison;case this.XML_CHAMP_PROP_NUM_ANGLEROTATION:return this.oRecupereAPI()?this.m_oModele.MAP_GetAngleRotation():this.m_oParametres.m_nAngleRotation;case this.XML_CHAMP_PROP_NUM_ANGLEINCLINAISON:return this.oRecupereAPI()?this.m_oModele.MAP_GetInclinaison():this.m_oParametres.m_nInclinaison;default:return WDChampParametres.prototype.GetProp.apply(this,arguments)}};WDCarte.prototype.SetProp=function(n,t,i){switch(n){case this.XML_CHAMP_PROP_NUM_MODECARTE:this.m_oParametres.m_eModeCarte=i;this.oRecupereAPI()&&this.m_oModele.MAP_SetModeCarte(i);break;case this.XML_CHAMP_PROP_NUM_ZOOM:this.m_oDonnees.m_nZoom=i;this.oRecupereAPI()&&(i==-1?this.m_oModele.MAP_SetZoomAdapte():this.m_oModele.MAP_SetZoom(i));break;case this.XML_CHAMP_PROP_NUM_INFOTRAFIC:this.m_oParametres.m_bInfoTrafic=i;this.oRecupereAPI()&&this.m_oModele.MAP_SetInfoTrafic(i);break;case this.XML_CHAMP_PROP_NUM_BOUSSOLE:this.m_oParametres.m_bBoussole=i;this.oRecupereAPI()&&this.m_oModele.MAP_SetBoussole(i);break;case this.XML_CHAMP_PROP_NUM_AVECZOOM:this.m_oParametres.m_bAvecZoom=i;this.oRecupereAPI()&&this.m_oModele.MAP_SetAvecZoom(i);break;case this.XML_CHAMP_PROP_NUM_AVECROTATION:this.m_oParametres.m_bAvecRotation=i;this.oRecupereAPI()&&this.m_oModele.MAP_SetAvecRotation(i);break;case this.XML_CHAMP_PROP_NUM_AVECSCROLL:this.m_oParametres.m_bAvecScroll=i;this.oRecupereAPI()&&this.m_oModele.MAP_SetAvecScroll(i);break;case this.XML_CHAMP_PROP_NUM_AVECINCLINAISON:this.m_oParametres.m_bAvecInclinaison=i;this.oRecupereAPI()&&this.m_oModele.MAP_SetAvecInclinaison(i);break;case this.XML_CHAMP_PROP_NUM_ANGLEROTATION:this.m_oParametres.m_nAngleRotation=i;this.oRecupereAPI()&&this.m_oModele.MAP_SetAngleRotation(i);break;case this.XML_CHAMP_PROP_NUM_ANGLEINCLINAISON:this.m_oParametres.m_nInclinaison=i;this.oRecupereAPI()&&this.m_oModele.MAP_SetInclinaison(i);break;case this.XML_CHAMP_PROP_NUM_IMAGE:this.m_oParametres.m_sImage=i;break;case this.XML_CHAMP_PROP_NUM_ETAT:return this.m_oModele&&this.m_oModele.PasseEnLectureSeuleEx(0!=i),i;default:return WDChampParametres.prototype.SetProp.apply(this,arguments)}return this.__UpdateChampCache()};WDCarte.prototype.SetValeur=function(n,t){var i=WDChamp.prototype.SetValeur.apply(this,arguments);return this.AffichePosition(t,undefined,!1),i};WDCarte.prototype.GetValeur=function(){return this.oRecupereAPI()?this.RecuperePosition():undefined};WDCarte.prototype._vLiaisonHTML=function(){WDChampParametres.prototype._vLiaisonHTML.apply(this,arguments)};WDCarte.prototype.Init=function(){WDChampParametres.prototype.Init.apply(this,arguments);this.__Reinit()};WDCarte.prototype.__sGetHote=function(){return this.m_sAliasChamp+"_HTE"};WDCarte.prototype.__AjoutTableauObjet=function(n,t,i){var r=this;clWDUtil.bForEach(n,function(u,f){var e=i;return e||(e=WDDinoBaseObjetCarte.clClasseObjet(u)),u=n[f]=new e(u,!0),t.apply(r,[u]),!0})};WDCarte.prototype.__Reinit=function(){if(!clWDUtil.bEstDisplay(document.getElementById(this.__sGetHote()),document,!0)){this.m_bUpdateUI=!0;return}this.oRecupereAPI()&&(this.m_oModele=undefined);var n=this;WDCarteAPI.s_pclFactory(WDCarteGoogleMaps,this.__sGetHote(),!0,function(t){t.m_nTypeCarte_Initial=n.m_oParametres.m_eModeCarte;t.m_bAfficheControleZoom_Initial=n.m_oParametres.m_bControleZoom;t.m_sImageMarqueur_Initial=n.m_oParametres.m_sImage;t.m_bInfoTrafic_Initial=n.m_oParametres.m_bInfoTrafic;t.m_bBoussole_Initial=n.m_oParametres.m_bBoussole;t.m_bAvecZoom_Initial=n.m_oParametres.m_bAvecZoom;t.m_bAvecRotation_Initial=n.m_oParametres.m_bAvecRotation;t.m_bAvecScroll_Initial=n.m_oParametres.m_bAvecScroll;t.m_bAvecInclinaison_Initial=n.m_oParametres.m_bAvecInclinaison;t.m_nAngleRotation_Initial=n.m_oParametres.m_dAngleRotation;t.m_nInclinaison_Initial=n.m_oParametres.m_dAngleInclinaison;t.m_nLatitude_Initial=n.m_oDonnees.m_dLatitude;t.m_nLongitude_Initial=n.m_oDonnees.m_dLongitude;t.m_nZoom_Initial=n.m_oDonnees.m_nZoom;t.m_sAdresse_Initial=n.m_oDonnees.m_sAdresse},function(t){var h,c,u,e,i,f,o,r,s;for(n.m_bPendantReInit=!0,clWDUtil.bForEachIn(n.m_oModele,function(n,i){return t[n]=i,!0}),n.m_oModele=t,t.m_oChamp=n,h=n.__domGetChampCache(),c=h.outerHTML.toLowerCase(),t.PasseEnLectureSeuleEx(h&&(c.indexOf("disabled")>-1||c.indexOf("readonly")>-1)),u=0;u<n.m_oDonnees.m_tabMarqueurs.length;++u)n.AjouteMarqueur(n.m_oDonnees.m_tabMarqueurs[u]=new WDDinoMarqueur(n.m_oDonnees.m_tabMarqueurs[u]));for(e=0;e<n.m_oDonnees.m_tabItineraires.length;++e){for(i=n.m_oDonnees.m_tabItineraires[e],f=[],o=0;o<i.m_tabPositions.length;++o)r=i.m_tabPositions[o],clWDUtil.isObject(r)?r.m_sAdresse?f.push(r.m_sAdresse):f.push([r.m_dLatitude,r.m_dLongitude]):f.push(r);n.AjouteItineraire(f,i.m_nMode,i.m_cCouleur,i.m_nOpacite/2.55,i.m_nEpaisseur,i.m_nID)}n.__AjoutTableauObjet(n.m_oDonnees.m_tabFormes,n.AjouteForme);n.__AjoutTableauObjet(n.m_oDonnees.m_tabImages,n.AjouteImage,WDDinoCarteImage);n.m_oSuitDeplacement&&n.SuitDeplacement.apply(n,n.m_oSuitDeplacement);n.__UpdateChampCache();s=n.RecuperePCode(n.ms_nEventNavCarteChangePosition);s&&(n.m_oModele.EcouteChangementPosition(s),n.m_oParametres.m_bAppelPCodeModif&&s());n.m_oModele.EcouteAffichageCluster(n.RecuperePCode(n.ms_nEventNavCarteCreationCluster));n.m_bPendantReInit=!1;n.m_oDonnees.m_nZoom==-1&&n.m_oModele.MAP_SetZoomAdapte()})};WDCarte.prototype.__domGetChampCache=function(){return document.getElementById(this.m_sAliasChamp+"_DATA")};WDCarte.prototype.__NettoyageTableauPourJsonServeur=function(n,t){n&&n.length&&clWDUtil.bForEach(n,function(n){var i=t;return i==WDDinoCarteForme&&(i=WDDinoBaseObjetCarte.clClasseObjet(n)),i.prototype.NettoyagePourJsonServeur.apply(n),!0})};WDCarte.clCloneBasNiveau=function(n){return JSON.parse(JSON.stringify(n))};WDCarte.prototype.__UpdateChampCache=function(){var t=WDCarte.clCloneBasNiveau(this.m_oDonnees),r,i,n;for(this.__NettoyageTableauPourJsonServeur(t.m_tabMarqueurs,WDDinoMarqueur),r=0,r=0;r<t.m_tabItineraires.length;++r)for(i=t.m_tabItineraires[r],n=0;n<i.m_tabPositions.length;++n)typeof i.m_tabPositions[n]=="string"?i.m_tabPositions[n]={m_sAdresse:i.m_tabPositions[n]}:delete i.m_tabPositions[n].m_oPosition;return this.__NettoyageTableauPourJsonServeur(t.m_tabFormes,WDDinoCarteForme),this.__NettoyageTableauPourJsonServeur(t.m_tabImages,WDDinoCarteImage),this.__domGetChampCache().value=JSON.stringify(t)};WDCarte.prototype._vAppliqueParametres=function(){WDChampParametres.prototype._vAppliqueParametres.apply(this,arguments);this._vLiaisonHTML();this.__Reinit()};WDCarte.prototype._vsConstruitParam=function(){var n=[],t=WDChampParametres.prototype._vsConstruitParam.apply(this,arguments);return t.length>0&&n.push(t),n.join(",")};WDCarte.prototype.AffichePosition=function(n,t,i){return(n instanceof WDDinoAdresse&&(n=n.m_pclGeoPosition&&n.m_pclGeoPosition.vbGetPositionValide()?n.m_pclGeoPosition:n.vGetAdresseComplete()),n instanceof WDGeoPosition?(this.m_oDonnees.m_dLatitude=n.GetLatitude(),this.m_oDonnees.m_dLongitude=n.GetLongitude()):this.m_oDonnees.m_sAdresse=""+n,this.__UpdateChampCache(),!this.oRecupereAPI())?!0:(i===undefined&&(i=this.m_oDonnees.m_bAnimation),clWDUtil.isObject(n)?this.m_oModele.MAP_SetPosition(n.GetLatitude(),n.GetLongitude(),i,t):this.m_oModele.MAP_SetPositionLieux(n,i,t),!0)};WDCarte.prototype._oGetPositionFromLatLng=function(n){var t=new WDGeoPosition,i=(n||"").indexOf(",");return i>0&&(t.SetLatitude(n.substr(0,i)),t.SetLongitude(n.substr(i+1))),t};WDCarte.prototype.RecuperePosition=function(){return this.oRecupereAPI()?this._oGetPositionFromLatLng(this.m_oModele.MAP_GetPosition()):undefined};WDCarte.prototype.InfoXY=function(n,t){return this.oRecupereAPI()?this._oGetPositionFromLatLng(this.m_oModele.MAP_GetPositionFromPoint(n,t)):undefined};WDCarte.prototype.InfoPosition=function(n){return this.oRecupereAPI()?this.m_oModele.MAP_GetPointFromPosition(n.GetLatitude(),n.GetLongitude()).replace(",","\t"):undefined};WDCarte.prototype.__bAjoutObjetPossible=function(n,t){return this.m_bPendantReInit||!this._oFindObjetParNom(n,t.m_sNom)};WDCarte.prototype.__bSortieApresMajChampCache=function(){return this.__UpdateChampCache(),!this.oRecupereAPI()};WDCarte.prototype.__nIdMajApresAjoutObjet=function(n,t,i){var r;if(this.m_bPendantReInit)r=t.pszGetIDInterne();else{if(r=undefined,i.oClone=t.clClone(),n.push(i.oClone),this.__bSortieApresMajChampCache())return i.oClone.SetIDInterne(r||i.oClone.sCreerIdentifiant()),i.bSortie=!0,r;i.oClone.SetIDInterne(r)}return r};WDCarte.prototype.__bInitObjetAvecImageAvantAppelApiCarte=function(n,t){return n.m_sImage&&n.m_sImage.length&&(t.sImage=n.m_sImage),n.m_oPosition!=undefined};WDCarte.prototype.__bAjoutObjetApiCarte=function(n,t,i,r,u){return n===!1?(this.m_bPendantReInit||t.pop(),!1):(i.SetIDInterne(u||n),r&&r.SetIDInterne(u||n),!0)};WDCarte.prototype.AfficheZone=function(n,t){return this.m_oModele.MAP_AfficheZone(n.GetLatitude(),n.GetLongitude(),t.GetLatitude(),t.GetLongitude())};WDCarte.prototype.LimiteZone=function(n,t){return n===undefined?this.m_oModele.MAP_LimiteZone():this.m_oModele.MAP_LimiteZone(n.GetLatitude(),n.GetLongitude(),t.GetLatitude(),t.GetLongitude())};WDCarte.prototype.ChangeStyle=function(n,t){var i;return t&&(i=clWDAJAXMain.JSONExecute(t)),this.m_oModele.MAP_ChangeStyle(n,i)};WDCarte.prototype.RecupereStyle=function(){return this.m_oModele.MAP_RecupereStyle()};WDCarte.prototype.AjouteMarqueur=function(n,t){var i,r,u;if(n instanceof WDDinoMarqueur){if(i=n,!this.__bAjoutObjetPossible(this.m_oDonnees.m_tabMarqueurs,i))return!1}else n instanceof WDGeoPosition?i=new WDDinoMarqueur(n):(i=new WDDinoMarqueur,i.SetLatitude(n),i.SetLongitude(t));return(r=this.__nIdMajApresAjoutObjet(this.m_oDonnees.m_tabMarqueurs,i,oSortie={bSortie:!1}),oSortie.bSortie)?!0:(u={sImage:this.m_oParametres.m_sImage},!this.__bInitObjetAvecImageAvantAppelApiCarte(i,u))?!1:this.__bAjoutObjetApiCarte(this.m_oModele.MAP_AjouteMarqueur(i.m_oPosition.GetLatitude(),i.m_oPosition.GetLongitude(),i.m_sDescription,i.m_sActionClic,this.m_bMarqueurImage?"":clWDUtil.sGetCheminImage(u.sImage,""),r,i.m_eAlignement,undefined,i.m_nOpacite,i.m_nAltitude,i.m_bIsDeplacable,i.m_sActionClicDeplacement,i.m_bAvecPopup,i.m_sNom,i.m_sActionClicPopup,i.m_bClusteur,i.m_bMarqueurImage?i.m_clMarqueurImage.m_eForme:WDCarteAPI.nFormeNonDefini,i.m_bMarqueurImage?i.m_clMarqueurImage.m_nTaille:0,i.m_bMarqueurImage?i.m_clMarqueurImage.m_sTexte:"",i.m_bMarqueurImage?WDDinoBaseObjetCarte.sCouleurSansOpaciteDinoCouleur(i.m_clMarqueurImage.m_clCouleur):"",i.m_bMarqueurImage?WDDinoBaseObjetCarte.nOpaciteDinoCouleur(i.m_clMarqueurImage.m_clCouleur):0,i.m_bMarqueurImage?WDDinoBaseObjetCarte.sCouleurSansOpaciteDinoCouleur(i.m_clMarqueurImage.m_clCouleurFond):"",i.m_bMarqueurImage?WDDinoBaseObjetCarte.nOpaciteDinoCouleur(i.m_clMarqueurImage.m_clCouleurFond):0,""),this.m_oDonnees.m_tabMarqueurs,i,oSortie.oClone,r)};WDCarte.prototype._oFindObjetParNom=function(n,t){for(var r,i=0;i<n.length;++i)if(r=n[i],r.m_sNom==t)return r;return undefined};WDCarte.prototype._oFindObjet=function(n,t,i){if(i instanceof n){if(i.pszGetIDInterne()!==undefined)return i;i=i.m_sNom}return i&&(i=this._oFindObjetParNom(t,i)),i};WDCarte.prototype._oFindMarqueur=function(n){return this._oFindObjet(WDDinoMarqueur,this.m_oDonnees.m_tabMarqueurs,n)};WDCarte.prototype.__bSupprimeObjet=function(n,t,i,r,u,f){var o,e;if(!i)return this.__bSupprimeToutObjet(r,f);if(i=this._oFindObjet(n,t,i),!i)return!1;for(o=[],e=0;e<t.length;++e)t[e].pszGetIDInterne()!=i.pszGetIDInterne()&&o.push(t[e]);return(r.apply(this,[o]),this.__bSortieApresMajChampCache())?!0:u.apply(this.m_oModele,[i.pszGetIDInterne()])};WDCarte.prototype.SetTableauMarqueur=function(n){this.m_oDonnees.m_tabMarqueurs=n};WDCarte.prototype.SupprimeMarqueur=function(n){return this.__bSupprimeObjet(WDDinoMarqueur,this.m_oDonnees.m_tabMarqueurs,n,this.SetTableauMarqueur,this.m_oModele.MAP_SupprimeMarqueur,this.m_oModele.MAP_SupprimeToutMarqueur)};WDCarte.prototype.__bModifieObjet=function(n,t,i){var u=this._oFindObjet(n,t,i),r;return u?(r=u.pszGetIDInterne(),clWDUtil.bForEach(t,function(n){return n.pszGetIDInterne()==r?(n.Clone(i),n.SetIDInterne(r),!1):!0}),this.__bSortieApresMajChampCache())?!0:i.bModifApiCarte(this,r):!1};WDCarte.prototype.ModifieMarqueur=function(n){return this.__bModifieObjet(WDDinoMarqueur,this.m_oDonnees.m_tabMarqueurs,n)};WDCarte.prototype.SupprimeTout=function(){return this.SupprimeToutItineraire()&&this.SupprimeToutMarqueur()&&this.SupprimeToutForme()&&this.SupprimeToutImage()};WDCarte.prototype.AffichePopup=function(n){var t=this._oFindMarqueur(n);return t?this.m_oModele.MAP_AffichePopup(t.pszGetIDInterne()):!1};WDCarte.prototype.FermePopup=function(n){var t=this._oFindMarqueur(n);return t?this.m_oModele.MAP_FermePopup(t.pszGetIDInterne()):!1};WDCarte.prototype.PopupAffichee=function(n){var t=this._oFindMarqueur(n);return t?this.m_oModele.MAP_PopupAffichee(t.pszGetIDInterne()):!1};WDCarte.prototype.__bSupprimeToutObjet=function(n,t){return(n.apply(this,[[]]),this.__bSortieApresMajChampCache())?!0:t.apply(this.m_oModele)};WDCarte.prototype.SupprimeToutMarqueur=function(){return this.__bSupprimeToutObjet(this.SetTableauMarqueur,this.m_oModele.MAP_SupprimeToutMarqueur)};WDCarte.prototype.AjouteItineraire=function(n,t,i,r,u,f){var o,s,e,h;if(!clWDUtil.isArray(n))return this.AjouteItineraireStr.apply(this,arguments);for(o=[],s=0;s<n.length;++s)e=n[s],e instanceof WDDinoAdresse&&(e=e.m_pclGeoPosition&&e.m_pclGeoPosition.vbGetPositionValide()?e.m_pclGeoPosition:e.vGetAdresseComplete()),e instanceof WDDinoMarqueur?o.push([e.m_oPosition.GetLatitude(),e.m_oPosition.GetLongitude()]):e instanceof WDGeoPosition?o.push([e.GetLatitude(),e.GetLongitude()]):clWDUtil.isArray(e)?o.push(e):o.push(e);return!this.m_bPendantReInit&&(this.m_oDonnees.m_tabItineraires.push(h={m_tabPositions:o,m_nMode:t,m_cCouleur:i,m_nOpacite:r*2.55,m_nEpaisseur:u,m_nID:f=f||WDCarteAPI.CreerIdentifiant()}),this.__UpdateChampCache(),!this.oRecupereAPI())?h.m_nID:this.m_oModele.MAP_AjouteItineraireArray(o,t,i,r,u,f)};WDCarte.prototype.AjouteItineraireStr=function(n,t,i,r,u,f,e){if(!this.m_bPendantReInit){var o;if(this.m_oDonnees.m_tabItineraires.push(o={m_tabPositions:[n,t],m_nMode:i,m_cCouleur:r,m_nOpacite:u*2.55,m_nEpaisseur:f,m_nID:WDCarteAPI.CreerIdentifiant()}),this.__UpdateChampCache(),!this.oRecupereAPI())return o.m_nID}return this.m_oModele.MAP_AjouteItineraireArray([n,t],i,r,u,f,e)};WDCarte.prototype.SupprimeItineraire=function(n){for(var i=[],t=0;t<this.m_oDonnees.m_tabItineraires.length;++t)this.m_oDonnees.m_tabItineraires[t].m_nID!=n&&i.push(this.m_oDonnees.m_tabItineraires[t]);return(this.m_oDonnees.m_tabItineraires=i,this.__UpdateChampCache(),!this.oRecupereAPI())?!0:this.m_oModele.MAP_SupprimeItineraire(n)};WDCarte.prototype.SupprimeToutItineraire=function(){return(this.m_oDonnees.m_tabItineraires=[],this.__UpdateChampCache(),!this.oRecupereAPI())?!0:this.m_oModele.MAP_SupprimeToutItineraire()};WDCarte.prototype.__bAjouteDino=function(n,t){if(!this.__bAjoutObjetPossible(n,t))return!1;var i=this.__nIdMajApresAjoutObjet(n,t,oSortie={bSortie:!1});return oSortie.bSortie?!0:this.__bAjoutObjetApiCarte(t.nAjoutApiCarte(this.m_oModele,i),n,t,oSortie.oClone,i)};WDCarte.prototype.AjouteForme=function(n){return this.__bAjouteDino(this.m_oDonnees.m_tabFormes,n)};WDCarte.prototype.SetTableauForme=function(n){this.m_oDonnees.m_tabFormes=n};WDCarte.prototype.SupprimeForme=function(n){return this.__bSupprimeObjet(WDDinoCarteForme,this.m_oDonnees.m_tabFormes,n,this.SetTableauForme,this.m_oModele.MAP_SupprimeForme,this.m_oModele.MAP_SupprimeToutForme)};WDCarte.prototype.ModifieForme=function(n){return this.__bModifieObjet(WDDinoCarteForme,this.m_oDonnees.m_tabFormes,n)};WDCarte.prototype.SupprimeToutForme=function(){return this.__bSupprimeToutObjet(this.SetTableauForme,this.m_oModele.MAP_SupprimeToutForme)};WDCarte.prototype.AjouteImage=function(n){return this.__bAjouteDino(this.m_oDonnees.m_tabImages,n)};WDCarte.prototype.SetTableauImage=function(n){this.m_oDonnees.m_tabImages=n};WDCarte.prototype.SupprimeImage=function(n){return this.__bSupprimeObjet(WDDinoCarteImage,this.m_oDonnees.m_tabImages,n,this.SetTableauImage,this.m_oModele.MAP_SupprimeImage,this.m_oModele.MAP_SupprimeToutImage)};WDCarte.prototype.ModifieImage=function(n){return this.__bModifieObjet(WDDinoCarteImage,this.m_oDonnees.m_tabImages,n)};WDCarte.prototype.SupprimeToutImage=function(){return this.__bSupprimeToutObjet(this.SetTableauImage,this.m_oModele.MAP_SupprimeToutImage)};WDCarte.prototype.SuitDeplacement=function(n,t){return!this.m_bPendantReInit&&(this.m_oSuitDeplacement=arguments,!this.oRecupereAPI())?!0:this.m_oModele.MAP_SuitDeplacement(n,t)};WDCarte.prototype.FinDeplacement=function(){return(this.m_oSuitDeplacement=undefined,!this.oRecupereAPI())?!0:this.m_oModele.MAP_FinDeplacement()};WDCarte.prototype.oRecupereAPI=function(){return this.m_oModele.m_clCarte};WDCarte.prototype.DistanceItineraire=function(n){return this.m_oModele.MAP_DistanceItineraire(n)};typeof JSON!="object"&&(JSON={}),function(){"use strict";function i(n){return n<10?"0"+n:n}function o(n){return u.lastIndex=0,u.test(n)?'"'+n.replace(u,function(n){var t=s[n];return typeof t=="string"?t:"\\u"+("0000"+n.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+n+'"'}function e(i,r){var c,l,s,a,v=n,h,u=r[i];u&&typeof u=="object"&&typeof u.toJSON=="function"&&(u=u.toJSON(i));typeof t=="function"&&(u=t.call(r,i,u));switch(typeof u){case"string":return o(u);case"number":return isFinite(u)?String(u):"null";case"boolean":case"null":return String(u);case"object":if(!u)return"null";if(n+=f,h=[],Object.prototype.toString.apply(u)==="[object Array]"){for(a=u.length,c=0;c<a;c+=1)h[c]=e(c,u)||"null";return s=h.length===0?"[]":n?"[\n"+n+h.join(",\n"+n)+"\n"+v+"]":"["+h.join(",")+"]",n=v,s}if(t&&typeof t=="object")for(a=t.length,c=0;c<a;c+=1)l=t[c],typeof l=="string"&&(s=e(l,u),s&&h.push(o(l)+(n?": ":":")+s));else for(l in u)Object.prototype.hasOwnProperty.call(u,l)&&(s=e(l,u),s&&h.push(o(l)+(n?": ":":")+s));return s=h.length===0?"{}":n?"{\n"+n+h.join(",\n"+n)+"\n"+v+"}":"{"+h.join(",")+"}",n=v,s}}typeof Date.prototype.toJSON!="function"&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+i(this.getUTCMonth()+1)+"-"+i(this.getUTCDate())+"T"+i(this.getUTCHours())+":"+i(this.getUTCMinutes())+":"+i(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var r,u,n,f,s,t;typeof JSON.stringify!="function"&&(u=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,s={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(i,r,u){var o;if(n="",f="",typeof u=="number")for(o=0;o<u;o+=1)f+=" ";else typeof u=="string"&&(f=u);if(t=r,r&&typeof r!="function"&&(typeof r!="object"||typeof r.length!="number"))throw new Error("JSON.stringify");return e("",{"":i})});typeof JSON.parse!="function"&&(r=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,JSON.parse=function(n,t){function u(n,i){var f,e,r=n[i];if(r&&typeof r=="object")for(f in r)Object.prototype.hasOwnProperty.call(r,f)&&(e=u(r,f),e!==undefined?r[f]=e:delete r[f]);return t.call(n,i,r)}var i;if(n=String(n),r.lastIndex=0,r.test(n)&&(n=n.replace(r,function(n){return"\\u"+("0000"+n.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(n.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return i=eval("("+n+")"),typeof t=="function"?u({"":i},""):i;throw new SyntaxError("JSON.parse");})}()