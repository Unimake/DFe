/*! 28.0.2.0 */
/*! VersionVI: 01F280051n   */
var WDTdb=function(){function n(n,t,i,r,u){var f,e;arguments.length&&(WDChampParametresHote.prototype.constructor.apply(this,arguments),f=new WDStyleCache(!0),f.Creation(),f.CreationFin(),this.m_oStyleCacheDimension=f,this.m_oTdbModeEdition=null,this.m_tabCacheDivWidget=[],this.m_eAncrageHauteur=u[2],clWDUtil.bRWD&&(e=this,NSPCS.NSUtil.ms_oNotificationsChangementTranche.AddNotification(function(){e.vOnChangementTranche.apply(e,arguments)})))}function h(n,t,i){return clWDUtil.bForEach(n,function(n){return!(n!==i&&n.m_bVisible&&nt(n,t))})}function nt(n,t){return n.m_nColonne<t.m_nColonne+t.m_nLargeur&&t.m_nColonne<n.m_nColonne+n.m_nLargeur&&n.m_nLigne<t.m_nLigne+t.m_nHauteur&&t.m_nLigne<n.m_nLigne+n.m_nHauteur}function at(n,t){return n.m_nColonne==t.m_nColonne&&n.m_nLigne==t.m_nLigne&&n.m_nHauteur==t.m_nHauteur&&n.m_nLargeur==t.m_nLargeur}function c(n){var t=[];return clWDUtil.bForEachIn(n,function(n,i){var r={};return clWDUtil.bForEachIn(i,function(n,t){return r[n]=t,!0}),t.push(r),!0}),t}function tt(n,t,i,r,u){var f=[a];return n?f.push(v):f.push(y),f.push(p+t),f.push(w+i),f.push(b+r),f.push(k+u),f.join(" ")}function e(n,t){var i=clWDUtil.bRWD?$.wb.nGetTrancheActiveIndiceWL(!0)-1:0;clWDUtil.bForEach(g,function(r){var f=r[0],e=t[f],o,u;return n[f]=e,clWDUtil.bRWD&&(o=r[1],u=n[o],u&&(u[i]=e)),!0})}function it(n){var t={};return e(t,n),t}function u(n,t,i,r){for(var u,e=n.length,f=0;f<e;f++)if(u=n[f],u.m_nLigne<=t&&t<u.m_nLigne+u.m_nHauteur&&u.m_nColonne<=i&&i<u.m_nColonne+u.m_nLargeur&&u.m_bVisible&&r!=f)return f;return clWDUtil.nElementInconnu}function i(n,t,i){if(arguments.length){WDDrag.prototype.constructor.apply(this,[0,50]);this.m_oTdb=n;this.m_bAnnuleOnDragExit=!1;var f=this,u=[];clWDUtil.bForEach(n.m_oDonnees.m_tabConfigCourante,function(n,e){return u.push(new r(f,e,t,i)),!0});this.m_tabElements=u;this.m_tabElementsVides=[];this.m_oRedimensionnement=null;clWDUtil.ActiveDesactiveClassName(n.m_oHote,"wbTdbRedim",i);this.m_tabAffichageCourant=[];this.__Affiche(!0)}}function l(n){while(0<n.length)n.pop().vLibereElement()}function t(n,t,i,r){var u,f;arguments.length&&(bTouch&&new WDDragDnDNatifEmule(this),u=t.cloneNode(!0),u.id=t.id+"_"+r,u=n.m_oTdb.m_oHote.appendChild(u),f=clWDUtil.tabGetElementsByClass(u,"wbTdbME")[0]||u,WDDnDNatif.prototype.constructor.apply(this,[i,1,f,this.ms_nOperationDeplacement]),this.m_oTdbModeEdition=n,this.m_sModeleClasses=t.className,this.m_oElement=u,this.m_oElementDnD=f)}function rt(n,t,i,r){var f=i+r,u=Math.floor(n/f);return u<t?u:n-u*f<i?u:-1}function r(n,i,r,u){var e,f,o;arguments.length&&(e=r?1:0,t.prototype.constructor.apply(this,[n,n.m_oTdb.m_oModeleModeEdition,e,i]),this.m_nWidget=i,this.m_bRedimensionne=u,f=[],o=this.m_oElement,clWDUtil.bForEach(ut,function(n){return f.push({m_fMouseDown:null,m_oDiv:clWDUtil.tabGetElementsByClass(o,n)[0]}),!0}),this.m_tabRedimensionnement=f)}function o(n,t,i,r,u){return n<=0&&0<=t&&n<t?{m_nMin:n*r,m_nMax:t*u,m_bBasOuDroite:i}:null}function f(n,i){arguments.length&&t.prototype.constructor.apply(this,[n,n.m_oTdb.m_oModeleModeEditionVide,0,i])}var ut,ft;n.prototype=new WDChampParametresHote;n.prototype.constructor=n;var a="WDTDB-Base",v="WDTDB-Widget",y="WDTDB-Masque",p="WDTDB-Ligne",w="WDTDB-Colonne",b="WDTDB-Largeur",k="WDTDB-Hauteur",et="TDBAJO",ot="TDBSUP",st="TDBDEP",ht="TDBRED",ct="TDBCI",d=1,lt=2,s=4,g=[["m_bVisible","m_tabVisible"],["m_nLigne","m_tabLigne"],["m_nColonne","m_tabColonne"],["m_nLargeur","m_tabLargeur"],["m_nHauteur","m_tabHauteur"]];return n.prototype.Init=function(){WDChampParametresHote.prototype.Init.apply(this,arguments);this._vAppliqueParametres();this.__Affiche(!0)},n.prototype.OnDisplay=function(n,t){WDChampParametresHote.prototype.OnDisplay.apply(this,arguments);t&&this.m_oHote&&clWDUtil.bEstFils(this.m_oHote,n)&&(this.__AncrageEnHauteur(!0),this.__Affiche(!0))},n.prototype._vOnResize=function(){WDChampParametresHote.prototype._vOnResize.apply(this,arguments);this.m_oHote&&clWDUtil.bEstDisplay(this.m_oHote,document,!1)&&(this.__AncrageEnHauteur(!0),this.__Affiche(!0))},n.prototype._vLiaisonHTML=function(){var n,t;WDChampParametresHote.prototype._vLiaisonHTML.apply(this,arguments);this.m_oParametres.m_sBoutonMenuAlias&&(this.m_oBoutonMenu=_JGE(this.m_oParametres.m_sBoutonMenuAlias,document,!0));this.m_oModeleModeEdition=this.oGetIDElement("ME");this.m_oModeleModeEditionVide=this.oGetIDElement("MEV");clWDUtil.SetDisplay(this.m_oModeleModeEdition,!1);clWDUtil.SetDisplay(this.m_oModeleModeEditionVide,!1);this.__AncrageEnHauteur(!1);n=this.m_tabCacheDivWidget;n.length||(t=this,clWDUtil.bForEach(this.m_oDonnees.m_tabConfigCourante,function(i,r){var u=t.oGetIDElement(r+1);return n[r]={m_oDiv:u,m_sClasses:u?u.className:""},!0}))},n.prototype._vAppliqueParametres=function(){WDChampParametresHote.prototype._vAppliqueParametres.apply(this,arguments);clWDUtil.bRWD&&(this.m_tabConfigCouranteRecue=c(this.m_oDonnees.m_tabConfigCourante))},n.prototype.__nGetNbColonnes=function(){var n=clWDUtil.bRWD?$.wb.nGetTrancheActiveIndiceWL(!0):1;return this.__nGetNbColonnesSelonTranche(n)},n.prototype.__nGetNbColonnesSelonTranche=function(n){var t=this.m_oParametres,i;return t?t.m_tabNbColonnes&&(i=t.m_tabNbColonnes[n-1],undefined!==i)?i:t.m_nNbColonnes:1},n.prototype.vOnChangementTranche=function(n,t){if(1!=this.m_oParametres.m_eMiseEnPage&&undefined!==this.m_nNbColonnesEffectif){var i=this.__nGetNbColonnesSelonTranche(t);i!=this.m_nNbColonnesEffectif&&this.__Affiche(!0)}},n.prototype.__AncrageEnHauteur=function(n){var r,i,u,t,e,f;if(1==this.m_eAncrageHauteur){if(n&&clWDUtil.SetDisplay(this.m_oHote,!1),r=this.m_oHote.parentNode,i=r.clientHeight,0==i&&bIEAvec11&&!bIEQuirks){for(u=r.offsetParent,t=u.offsetParent,e=document.body;t&&t!=e&&!clWDUtil.bBaliseEstTag(t,"td");)t=t.parentNode;f=u.getBoundingClientRect();i=t.clientHeight-(f.bottom-f.top)}0<i&&(this.m_oHote.style.height=i+"px");n&&clWDUtil.SetDisplay(this.m_oHote,!0)}},n.prototype.__Affiche=function(n){this.m_oHote&&clWDUtil.bEstDisplay(this.m_oHote,document,!0)&&this.__AfficheInterne(n)},n.prototype.__AfficheInterne=function(n){if(n|=this.__bCalculeOrganisation(),n&&(this.__AfficheContenu(),this.m_oHote&&2==this.m_eAncrageHauteur)){var t=0;clWDUtil.bForEach(this.m_oDonnees.m_tabConfigCourante,function(n){return n.m_bVisible&&(t=Math.max(t,n.m_nLigne+n.m_nHauteur)),!0});this.m_oHote.style.height=clWDUtil.GetDimensionPxPourStyle(t*(this.m_oParametres.m_nTaille1CaseY+this.m_oParametres.m_nMargeY))}this.__AfficheModeEdition();this.__AfficheBouton()},n.prototype.__PreparePositionnement=function(){this.PreparePositionnement(this.m_oDonnees.m_tabConfigCourante)},n.prototype.__CalculeNbLignesColonnesEffectives=function(n){var t=this.__nGetNbColonnes(),r=this.m_oParametres.m_nTaille1CaseX,u=this.m_oParametres.m_nMargeX,f=r+u,e=this.m_oHote.offsetWidth,o=e+u,s=u/2,i;switch(this.m_oParametres.m_eMiseEnPage){case 0:s=Math.max(0,Math.floor((o-t*f)/2));break;case 1:t=Math.max(t,Math.floor(o/f));break;case 2:r=Math.max(r,Math.floor(e/t)-u)}this.m_nNbColonnesEffectif=t;this.m_nTaille1CaseXEffective=r;this.m_nOffsetCentrage=s;i=0;clWDUtil.bForEach(n,function(n){return n.m_bVisible&&(i=Math.max(i,n.m_nLigne+n.m_nHauteur)),!0});this.m_nNbLignesEffectif=i;this.m_nNbLignesVisiblesEffectif=Math.max(i,Math.ceil((this.m_oHote.offsetHeight-this.m_oParametres.m_nMargeY)/(this.m_oParametres.m_nTaille1CaseY+this.m_oParametres.m_nMargeY)))},n.prototype.__CalculeClassePositionnement=function(){var t=this.m_oStyleCacheDimension,s,h;t.Creation();var i="#"+this.sGetNomElement(this.ms_sSuffixeHote)+" .",c=this.m_oParametres.m_nMargeX,f=this.m_oParametres.m_nMargeY,e=this.m_nTaille1CaseXEffective,o=this.m_oParametres.m_nTaille1CaseY,n,u,r;for(u=this.m_nNbColonnesEffectif,r=c+e,s=this.m_nOffsetCentrage,n=0;n<u;n++)t.Ajoute(i+w+n,["left:"+(s+r*n)+"px"]),t.Ajoute(i+b+(n+1),["width:"+(e+r*n)+"px"]);for(u=this.m_nNbLignesVisiblesEffectif,r=f+o,h=Math.floor(f/2),n=0;n<u;n++)t.Ajoute(i+p+n,["top:"+(h+r*n)+"px"]),t.Ajoute(i+k+(n+1),["height:"+(o+r*n)+"px"]);t.Ajoute(i+a,["position:absolute;box-sizing: border-box;overflow:hidden"]);t.Ajoute(i+v,["z-index:0"]);t.Ajoute(i+y,["z-index:1"]);t.CreationFin()},n.prototype.__bCalculeOrganisation=function(){var n=!1,i,t;return clWDUtil.bRWD&&1!=this.m_oParametres.m_eMiseEnPage&&(i=clWDUtil.bRWD?$.wb.nGetTrancheActiveIndiceWL(!0):1,t=this.__nGetNbColonnesSelonTranche(i),this.m_nNbColonnesEffectif!=t&&(this.m_oDonnees.m_tabConfigCourante=c(this.m_tabConfigCouranteRecue),clWDUtil.bForEachIn(this.m_oDonnees.m_tabConfigCourante,function(n,t){return clWDUtil.bForEach(g,function(n){var u=t[n[1]],r;return undefined!==u&&(r=u[i-1],undefined!==r&&(t[n[0]]=r)),!0}),!0}),this.bFaitDeLaPlace(this.m_oDonnees.m_tabConfigCourante,{m_bVisible:!0,m_nLigne:0,m_nColonne:t,m_nLargeur:100,m_nHauteur:250},clWDUtil.nElementInconnu,t),n=!0)),this.__PreparePositionnement(),clWDUtil.bPageStatique&&(n=this.__bAutoCompacte()||n),n},n.prototype.__bAutoCompacte=function(){var n=!1;return this.m_oParametres.m_bAutoCompacte&&(n=this.__bBoucheTrous(),n&&this.__PreparePositionnement()),n},n.prototype.__bBoucheTrous=function(){for(var t,a,i,r,o,s,p,c,w,f=this.m_oDonnees.m_tabConfigCourante,v=this.m_nNbLignesEffectif,e=this.m_nNbColonnesEffectif,l=!1,y=new Array(v*e),n=0;n<v;n++)for(t=0;t<e;t++)if(!y[n*e+t]&&(a=u(f,n,t,clWDUtil.nElementInconnu),i=null,clWDUtil.nElementInconnu!=a?i=f[a]:(r=null,o=0,clWDUtil.bForEach(f,function(i){var e=i.m_nLargeur*i.m_nHauteur,u;return i.m_bVisible&&o<=e&&(n<i.m_nLigne||n==i.m_nLigne&&t<i.m_nColonne)&&(u={m_nLigne:n,m_nColonne:t,m_nLargeur:i.m_nLargeur,m_nHauteur:i.m_nHauteur},h(f,u,i)&&(o=o,r=i)),!0}),r&&(r.m_nColonne=t,r.m_nLigne=n,l=!0,i=r)),i))for(p=n+i.m_nHauteur,s=n;s<p;s++)for(w=t+i.m_nLargeur,c=t;c<w;c++)y[s*e+c]=!0;return l&&this.__CalculeNbLignesColonnesEffectives(f),l},n.prototype.__AfficheContenu=function(){clWDUtil.bForEachThis(this.m_oDonnees.m_tabConfigCourante,this,this.bAfficheUnWidget)},n.prototype.__AfficheModeEdition=function(){this.m_oTdbModeEdition&&(this.m_oTdbModeEdition.Fin(),this.m_oTdbModeEdition=null);this.m_oDonnees.m_bEnModeEdition&&(this.m_oTdbModeEdition=new i(this,this.m_oDonnees.m_bDeplace,this.m_oDonnees.m_bRedimensionne))},n.prototype.__AfficheBouton=function(){var n=this.m_oBoutonMenu,i,r,u,e,f;if(n){i=!1;r=!1;switch(this.m_oParametres.m_eBoutonMenuPosition){default:case 0:return;case 1:break;case 2:i=!0;break;case 3:r=!0;break;case 4:i=!0;r=!0}var t=this.m_oHote,o=t.parentNode,s=6;i&&(u=t.offsetWidth,0==u&&(u=o.offsetWidth),s=u-6-n.offsetWidth);e=6;r&&(f=t.offsetHeight,0==f&&(f=o.offsetHeight),e=f-6-n.offsetHeight);n.style.left=clWDUtil.nGetBoundingClientRectLeft(t,!1,!1)+s-clWDUtil.nGetBoundingClientRectLeft(n.offsetParent,!1,!1)+"px";n.style.top=clWDUtil.nGetBoundingClientRectTop(t,!1,!1)+e-clWDUtil.nGetBoundingClientRectTop(n.offsetParent,!1,!1)+"px";n.style.right="";n.style.bottom=""}},n.prototype.__AppelPCode=function(n,t,i){this.RecuperePCode(n)(t,this.m_oDonnees.m_tabConfigCourante[i].m_sNomFI)},n.prototype.__ActionServeur=function(n,t){this.m_oChampFormulaire.value=t+","+(this.m_oDonnees.m_bEnModeEdition?"1":"0")+","+this.sSauveConfiguration();try{var i=clWDUtil.sGetPageAction();_PAGE_.action=i+"#"+this.m_oHote.id;_JSL(_PAGE_,this.m_sAliasChamp,"_self",undefined,undefined,n)}finally{_PAGE_.action+=i}},n.prototype.__OnDisplayWidget=function(n,t){var i=this.m_tabCacheDivWidget[n].m_oDiv;i&&AppelMethode(WDChamp.prototype.ms_sOnDisplay,[i,t])},n.prototype.__s_AppelChangeTailleDeplace=function(t,i,r){var u,f;this instanceof n&&clWDUtil.bEstFils(t,this.m_oHote)&&(u=this.m_tabCacheDivWidget,u.length&&(clWDUtil.bForEach(u,function(n,i){return clWDUtil.bEstFils(t,n.m_oDiv)?(f=i,!1):!0})||(r.unshift(f),i.apply(this,r))))},n.prototype.__WLAfficheUnWidget=function(n,t,i){t.m_bVisible&&(clWDUtil.pfGetTraitement(t.m_sAlias,this.ms_nEventNavTdbWidgetRefresh)(n),this.OnAfficheWidget(n,t,i))},n.prototype.s_OnOuvreMenu=function(){function t(n,t){var f,e,u;if(arguments.length){var r=t.m_oDonnees,o=r.m_bEnModeEdition,i=[];r.m_bFAAEdition&&(f={m_oLibelle:{m_sTraduction:"EDITION",sLibelle:"Mode \u00e9dition"},m_pfAction:function(n){t.OnModeEdition(n)}},o&&(f.m_sImage="CocheActif.png"),i.push(f));r.m_bFAARestaureConfigInitiale&&i.push({m_oLibelle:{m_sTraduction:"CONFINIT",sLibelle:"Restaurer la configuration initiale"},m_pfAction:function(n){t.OnConfigurationInitiale(n)}});e=r.m_tabConfigCourante;r.m_bSupprime&&r.m_bFAAAjouteSupprime&&0<e.length&&(i.length&&(i[i.length-1].m_bSeparateur=!0),clWDUtil.bForEach(e,function(n,r){var u={m_oLibelle:{sLibelle:n.m_sLibelle}};return n.m_bVisible?(u.m_pfAction=function(i){t.OnMasqueWidget(i,n,r)},u.m_sImage="CocheActif.png"):u.m_pfAction=function(i){t.OnAfficheWidget(i,n,r)},i.push(u),!0}));u=this.ms_eOuvreBasDroite;switch(t.m_oParametres.m_eBoutonMenuPosition){case 2:u=this.ms_eOuvreBasGauche;break;case 3:u=this.ms_eOuvreHautDroite;break;case 4:u=this.ms_eOuvreHautGauche}WDMenuContextuel.prototype.constructor.apply(this,[n,i,u,TDB_MENU])}}return t.prototype=new WDMenuContextuel,t.prototype.constructor=t,t.prototype._vAction=function(n,t){t.m_pfAction(n)},function(i,r,u){var f=oGetObjetChamp(r);clWDUtil.bForEachIn(clWDUtil.m_oChamps,function(t,i){return i instanceof n&&i.m_oParametres.m_sBoutonMenuAlias==u?(f=i,!1):!0});new t(i,f)}}(),n.prototype.OnModeEdition=function(){this.m_oDonnees.m_bEnModeEdition=!this.m_oDonnees.m_bEnModeEdition;this.m_oDonnees.m_bRedimensionne=!0;this.m_oDonnees.m_bDeplace=!0;this.m_oDonnees.m_bAjoute=!0;this.m_oDonnees.m_bSupprime=!0;this.__AfficheModeEdition()},n.prototype.OnConfigurationInitiale=function(){this.m_oDonnees.m_tabConfigCourante=c(this.m_oParametres.m_tabConfigInitiale);this.m_nNbColonnesEffectif=undefined;this.__AfficheInterne(clWDUtil.bPageStatique);clWDUtil.bPageStatique||this.__ActionServeur(ct,-1)},n.prototype.OnAfficheWidget=function(n,t,i){var r=this.m_oDonnees.m_tabConfigCourante;clWDUtil.bPageStatique&&(h(r,t)||e(t,this.__oGetNouvellePosition(t,r)));t.m_bVisible=!0;this.__AfficheInterne(clWDUtil.bPageStatique);clWDUtil.bPageStatique&&this.__OnDisplayWidget(i,!0);this.__AppelPCode(this.ms_nEventNavTdbAjoute,n,i);clWDUtil.bPageStatique||this.__ActionServeur(et,i)},n.prototype.OnMasqueWidget=function(n,t,i){t.m_bVisible=!1;this.__AfficheInterne(clWDUtil.bPageStatique);clWDUtil.bPageStatique&&this.__OnDisplayWidget(i,!1);this.__AppelPCode(this.ms_nEventNavTdbSupprime,n,i);clWDUtil.bPageStatique||this.__ActionServeur(ot,i)},n.prototype.OnChangementConfiguration=function(n,t,i,r){var u=this.m_oDonnees.m_tabConfigCourante,f;if(at(u[i],t[i]))return!0;clWDUtil.bForEach(u,function(n,i){return e(n,t[i]),!0});this.__bCalculeOrganisation();f=r?ht:st;this.__AppelPCode(r?this.ms_nEventNavTdbRedimensionnement:this.ms_nEventNavTdbDeplacement,n,i);clWDUtil.bPageStatique||this.__ActionServeur(f,i)},n.prototype.bAfficheUnWidget=function(n,t){var r,u,i;return n.m_bVisible&&(r=this.m_tabCacheDivWidget,t<r.length&&(u=r[t],i=u.m_oDiv,i&&(i.style.left="",i.style.top="",i.style.width="",i.style.height="",clWDUtil.SetDisplay(i,!0),i.className=u.m_sClasses+" "+tt(!0,n.m_nLigne,n.m_nColonne,n.m_nLargeur,n.m_nHauteur)))),!0},n.prototype.bMasqueUnWidget=function(n){var i=this.m_tabCacheDivWidget,t;n<i.length&&(t=i[n].m_oDiv,t&&clWDUtil.SetDisplay(t,!1))},n.prototype.PreparePositionnement=function(n){this.__CalculeNbLignesColonnesEffectives(n);this.__CalculeClassePositionnement()},n.prototype.__oGetNouvellePosition=function(n,t,i,r){var c,u,f,l,o;undefined==r&&(r=this.m_nNbColonnesEffectif);var s=!0,a=n.m_bVisible,e=n.m_nLargeur;for(r<e&&(e=r,0==n.m_nColonne&&(s=!1)),c=n.m_nHauteur,l=r-e+1,u=0;u<1024;u++)for(f=0;f<l;f++)if(o={m_bVisible:a,m_nLigne:u,m_nColonne:f,m_nLargeur:e,m_nHauteur:c},(!s||u!=n.m_nLigne||f!=n.m_nColonne)&&(!i||!nt(o,i))&&h(t,o,n))return o;return n},n.prototype.bColonneValidePourLargeur=function(n,t){return n+t<=this.m_nNbColonnesEffectif},n.prototype.bFaitDeLaPlace=function(n,t,i,r){for(var s=!1,e=t.m_nLigne,c=e+t.m_nHauteur,f,h,o;e<c;e++)for(f=t.m_nColonne,h=f+t.m_nLargeur;f<h;f++)o=u(n,e,f,i),clWDUtil.nElementInconnu!=o&&(n[o]=this.__oGetNouvellePosition(n[o],n,t,r),s=!0);return s},n.prototype.Affiche=function(n){var t,i,r=this.m_oDonnees.m_tabConfigCourante;switch(typeof n){case"string":if(clWDUtil.bForEach(r,function(r,u){return r.m_sNomFI==n?(t=r,i=u,!1):!0}))return;break;case"number":t=r[n];i=n;break;default:clWDUtil.bForEachThis(r,this,function(n,t){return this.__WLAfficheUnWidget(null,n,t),!0});return}this.__WLAfficheUnWidget(null,t,i)},n.prototype.bChargeConfiguration=function(n){var r=JSON.parse(n),i=this.m_oDonnees.m_tabConfigCourante,t=new Array(i.length);if(!clWDUtil.bForEach(r,function(n,u){return n?(clWDUtil.bForEach(i,function(n,i){return undefined!==t[i]?!0:n.m_sNomFI!=i.m_sNomFI?(t[i]=u,!1):!0})&&(r[u]=null),!0):!1}))return!1;clWDUtil.bForEach(i,function(n,i){return undefined!==t[i]&&(n.m_bVisible=!1),!0});clWDUtil.bForEach(i,function(n,f){var o,s,h,l,c,a,v;if(undefined!==t[f]){if(o=r[t[f]],s=!0,o.m_bVisible)for(h=o.m_nLigne,l=h+o.m_nHauteur;h<l&&s;h++)for(c=o.m_nColonne,a=c+o.m_nLargeur;c<a&&s;c++)v=u(i,h,c,clWDUtil.nElementInconnu),s&=clWDUtil.nElementInconnu!=v;s&&(e(n,o),t[f]=undefined)}return!0});this.__AfficheInterne(clWDUtil.bPageStatique)},n.prototype.ConfigurationInitiale=function(n,t,i,r,u){var f,e,o=this.m_oDonnees.m_tabConfigCourante;switch(typeof n){case"string":default:if(clWDUtil.bForEach(o,function(t,i){return t.m_sNomFI==n?(f=t,e=i,!1):!0}))return;break;case"number":f=o[n];e=n}undefined!==t&&(f.m_nColonne=Math.max(Math.min(t-1,this.m_nNbColonnesEffectif-1),0));undefined!==i&&(f.m_nLigne=Math.max(i-1,0));undefined!==r&&(f.m_nLargeur=Math.max(Math.min(r,this.m_nNbColonnesEffectif),1));undefined!==u&&(f.m_nHauteur=Math.max(u,1));this.__AfficheInterne(clWDUtil.bPageStatique)},n.prototype.nInfoXY=function(n,t){var i=this.m_oParametres.m_nMargeX,s=this.m_oParametres.m_nMargeY,r=this.m_nTaille1CaseXEffective,u=this.m_oParametres.m_nTaille1CaseY,f=i+r,e=i+u,h=this.m_nOffsetCentrage+i,o=0;return clWDUtil.bForEach(this.m_oDonnees.m_tabConfigCourante,function(i,c){if(i.m_bVisible){var l=(i.m_nColonne-1)*f+h,a=(i.m_nLigne-1)*e+s,v=l+(i.m_nLargeur-1)*f+r,y=a+(i.m_nHauteur-1)*e+u;if(l<=n&&n<=v&&a<=t&&t<=y)return o=c,!1}return!0}),o},n.prototype.SetMode=function(n){var t=this.m_oDonnees;0==n?t.m_bEnModeEdition=!1:(t.m_bRedimensionne=0!=(n&s),t.m_bDeplace=0!=(n&d),t.m_bSupprime=0!=(n&s),t.m_bEnModeEdition=t.m_bRedimensionne||t.m_bDeplace);this.__AfficheModeEdition()},n.prototype.nGetMode=function(){var n=this.m_oDonnees;return(n.m_bRedimensionne?s:0)+(n.m_bDeplace?d:0)+(n.m_bSupprime?lt:0)},n.prototype.nOccurrence=function(n){switch(n){case 1:return this.m_oDonnees.m_tabConfigCourante.length;case 4:var t=0;return clWDUtil.bForEach(this.m_oDonnees.m_tabConfigCourante,function(n){return n.m_bVisible&&t++,!0}),t;default:return 0}},n.prototype.sSauveConfiguration=function(){return JSON.stringify(this.m_oDonnees.m_tabConfigCourante)},n.prototype.s_ChangeTailleWidget=function(t,i,r,u){WDChamp.prototype._AppelMethodePtr(n.prototype.__s_AppelChangeTailleDeplace,[t,n.prototype.__ChangeTailleWidget,[i,r,u]])},n.prototype.ChangeTailleWidget=function(n,t,i,r){this.__ChangeTailleWidget(n-1,t,i,r)},n.prototype.__ChangeTailleWidget=function(n,t,i,r){var c=this.m_oDonnees.m_tabConfigCourante,f,e,o,s,u,h;0!=(r&1)?(f=1,e=1,o=this.m_nTaille1CaseXEffective,o<t&&(f+=Math.round((t-o)/(o+this.m_oParametres.m_nMargeX))),s=this.m_oParametres.m_nTaille1CaseY,s<i&&(e+=Math.round((i-s)/(s+this.m_oParametres.m_nMargeY)))):(f=t,e=i);u=c[n];u.m_nLargeur=Math.max(Math.min(f,this.m_nNbColonnesEffectif-u.m_nColonne),1);u.m_nHauteur=Math.max(e,1);h=clWDUtil.bPageStatique;0==(r&2)&&(h=this.bFaitDeLaPlace(c,u,n)||h);this.__AfficheInterne(h)},n.prototype.s_DeplaceWidget=function(t,i,r,u){WDChamp.prototype._AppelMethodePtr(n.prototype.__s_AppelChangeTailleDeplace,[t,n.prototype.__DeplaceWidget,[i,r,u]])},n.prototype.DeplaceWidget=function(n,t,i,r){this.__DeplaceWidget(n-1,t,i,r)},n.prototype.__DeplaceWidget=function(n,t,i,r){var s=this.m_oDonnees.m_tabConfigCourante,e,o,u,f;0!=(r&1)?(t-=this.m_nOffsetCentrage,t-=this.m_oParametres.m_nMargeX,i-=this.m_oParametres.m_nMargeY,e=Math.round(t/(this.m_nTaille1CaseXEffective+this.m_oParametres.m_nMargeX)),o=Math.round(i/(this.m_oParametres.m_nTaille1CaseY+this.m_oParametres.m_nMargeY))):(e=t-1,o=i-1);u=s[n];u.m_nColonne=Math.max(Math.min(e,this.m_nNbColonnesEffectif-1),0);u.m_nLigne=Math.max(o,0);f=clWDUtil.bPageStatique;0==(r&2)&&(f=this.bFaitDeLaPlace(s,u,n)||f);this.__AfficheInterne(f)},i.prototype=new WDDrag,i.prototype.constructor=i,i.prototype._vbOnMouseDown=function(n,t,i,r,u){if(!WDDrag.prototype._vbOnMouseDown.apply(this,arguments))return!1;this.m_oRedimensionnement&&this.__LibereRedimensionnement();this.m_oRedimensionnement={m_sCurseurBody:document.body.style.cursor,m_nWidget:t,m_oVariationX:i,m_oVariationY:r,m_nOffsetGrilleXDernier:0,m_nOffsetGrilleYDernier:0};document.body.style.cursor=u+" !important"},i.prototype._vbFiltrePremierMouseMove=clWDUtil.m_pfVide,i.prototype._vOnMouseMove=function(n){var c,l,a,v,i;WDDrag.prototype._vOnMouseMove.apply(this,arguments);var t=this.m_oRedimensionnement,f=t.m_oVariationX,o=t.m_oVariationY,s=this.m_oTdb,h=s.m_oParametres,r=0,u=0;f&&(c=Math.max(Math.min(this.nGetOffsetPosX(n),f.m_nMax),f.m_nMin),l=h.m_nMargeX+s.m_nTaille1CaseXEffective,r=Math.round(c/l));o&&(a=Math.max(Math.min(this.nGetOffsetPosY(n),o.m_nMax),o.m_nMin),v=h.m_nMargeY+h.m_nTaille1CaseY,u=Math.round(a/v));(r!=t.m_nOffsetGrilleXDernier||u!=t.m_nOffsetGrilleYDernier)&&(this.__RAZAffichageCourant(),i=it(this.m_tabAffichageCourant[t.m_nWidget]),f&&(f.m_bBasOuDroite?i.m_nLargeur+=r:(i.m_nLargeur-=r,i.m_nColonne+=r),t.m_nOffsetGrilleXDernier=r),o&&(o.m_bBasOuDroite?i.m_nHauteur+=u:(i.m_nHauteur-=u,i.m_nLigne+=u),t.m_nOffsetGrilleYDernier=u),s.bFaitDeLaPlace(this.m_tabAffichageCourant,i,t.m_nWidget),e(this.m_tabAffichageCourant[t.m_nWidget],i),this.__Affiche(!1,!0))},i.prototype._vOnMouseUp=function(n){this.m_oTdb.OnChangementConfiguration(n,this.m_tabAffichageCourant,this.m_oRedimensionnement.m_nWidget,!0);this.__LibereRedimensionnement();this.__Affiche(!0);WDDrag.prototype._vOnMouseUp.apply(this,arguments)},i.prototype.__RAZAffichageCourant=function(){var n=this.m_tabAffichageCourant;clWDUtil.VideTableau(n);clWDUtil.bForEach(this.m_oTdb.m_oDonnees.m_tabConfigCourante,function(t){return n.push(it(t)),!0})},i.prototype.__Affiche=function(n,t){var o,p,h,c,w,r,s,e,v,nt,y,tt,b,k;n&&this.__RAZAffichageCourant();o=this.m_oTdb;p=this.m_tabAffichageCourant;o.PreparePositionnement(p);h=this.m_tabElementsVides;this.m_tabElementsVides=[];c=this.m_tabElementsVides;w=this.m_tabElements;t||clWDUtil.bForEach(w,function(n){return n.vMasque(),o.bMasqueUnWidget(n.m_nWidget),!0});for(var d=o.m_nNbLignesVisiblesEffectif,a=o.m_nNbColonnesEffectif,g=new Array(d*a),i=0;i<d;i++)for(r=0;r<a;r++)if(!g[i*a+r])if(s=u(this.m_tabAffichageCourant,i,r,clWDUtil.nElementInconnu),clWDUtil.nElementInconnu!=s)for(e=p[s],w[s].vAffiche(e.m_nLigne,e.m_nColonne,e.m_nLargeur,e.m_nHauteur,t),o.bAfficheUnWidget(e,s),nt=i+e.m_nHauteur,v=i;v<nt;v++)for(tt=r+e.m_nLargeur,y=r;y<tt;y++)g[v*a+y]=!0;else b=u(h,i,r,clWDUtil.nElementInconnu),clWDUtil.nElementInconnu!=b?c.push(h.splice(b,1)[0]):(k=new f(this,c.length),k.vAffiche(i,r,1,1,t),c.push(k));l(h)},i.prototype.__LibereRedimensionnement=function(){document.body.style.cursor=this.m_oRedimensionnement.m_sCurseurBody;this.m_oRedimensionnement=null},i.prototype.__bOnDragSurvolWidget=function(n,t){var i=n.m_nWidget,f=t.m_nWidget,r=this.m_tabAffichageCourant[i],e={m_bVisible:!0,m_nLigne:t.m_nLigne,m_nColonne:t.m_nColonne,m_nLargeur:r.m_nLargeur,m_nHauteur:r.m_nHauteur},u=!0;return i!=f?r.m_bVisible=!1:u=!1,this.m_oTdb.bFaitDeLaPlace(this.m_tabAffichageCourant,e,i),this.__Affiche(!1),this.m_bAnnuleOnDragExit=!0,u},i.prototype.__bOnDragSurvolVide=function(n,t){var r=!1,u=n.m_nWidget,i=this.m_tabAffichageCourant[u],f;return i.m_bVisible&&(i.m_bVisible=!1,r=!0),f={m_nLigne:t.m_nLigne,m_nColonne:t.m_nColonne,m_nLargeur:i.m_nLargeur,m_nHauteur:i.m_nHauteur},this.m_oTdb.bFaitDeLaPlace(this.m_tabAffichageCourant,f,u)&&(r=!0),r&&this.__Affiche(!1),!0},i.prototype.__OnDnDAnnule=function(){this.m_bAnnuleOnDragExit=!1;this.__Affiche(!0)},i.prototype.__tabGetPositionsCibleReelle=function(n,t){var i,r,s,f;if(undefined===t.m_oOffsetDernierDnDDest)return[];var v=this.m_oTdb,e=n.m_oOffsetDernierDnDSrc,o=t.m_oOffsetDernierDnDDest;var y=o.m_nCelluleX-e.m_nCelluleX,p=o.m_nCelluleY-e.m_nCelluleY,h=Math.min(Math.max(0,t.m_nColonne+y),v.m_nNbColonnesEffectif-1),c=Math.max(0,t.m_nLigne+p),w=h+n.m_nLargeur,b=c+n.m_nHauteur,l=[],a=[];for(i=c;i<b;i++)for(r=h;r<w;r++)s={m_nLigne:i,m_nColonne:r,m_nLargeur:1,m_nHauteur:1},f=u(this.m_tabAffichageCourant,i,r,clWDUtil.nElementInconnu),clWDUtil.nElementInconnu==f||clWDUtil.bDansTableau(a,f)||(s.m_nWidget=f,a.push(f)),l.push(s);return l},i.prototype.Fin=function(){l(this.m_tabElements);l(this.m_tabElementsVides)},i.prototype.fAttacheUnRedimensionnement=function(n,t,i,r,u){var f=this,e=function(n){return f.bOnMouseDown(n||event,t,i,r,u)?f._bStopPropagation(n):!0};return this._AttacheDetacheMouseDown(!0,n,e),e},i.prototype.DetacheUnRedimensionnement=function(n,t){this._AttacheDetacheMouseDown(!1,n,t)},i.prototype.OnOperationSurDropSans=function(n,t){var i=this.__tabGetPositionsCibleReelle(n,t);this.__OnDnDAnnule(n,i)},i.prototype.bColonneValidePourLargeur=function(n,t){var i=this.__tabGetPositionsCibleReelle(n,t),r=i[0],u=this.m_tabAffichageCourant[n.m_nWidget];return this.m_oTdb.bColonneValidePourLargeur(r.m_nColonne,u.m_nLargeur)},i.prototype.OnDragSurvol=function(n,t){var i=this.__tabGetPositionsCibleReelle(n,t);clWDUtil.bForEachThis(i,this,function(t,i){return undefined!==t.m_nWidget?this.__bOnDragSurvolWidget(n,t):0==i?this.__bOnDragSurvolVide(n,t):void 0})},i.prototype.OnDragExit=function(n,t){var i=this.__tabGetPositionsCibleReelle(n,t);this.m_bAnnuleOnDragExit?this.m_bAnnuleOnDragExit=!1:this.__OnDnDAnnule(n,i)},i.prototype.OnDrop=function(n,t){var e=t.m_oEvent,u=this.__tabGetPositionsCibleReelle(n,t),r,i,f;u&&u.length&&(r=u[0],i=this.m_tabAffichageCourant[n.m_nWidget],f=t!==n?!0:i.m_nColonne!=r.m_nColonne||i.m_nLigne!=r.m_nLigne,!1!=f&&(i.m_bVisible=!0,i.m_nColonne=r.m_nColonne,i.m_nLigne=r.m_nLigne,this.m_oTdb.OnChangementConfiguration(e,this.m_tabAffichageCourant,n.m_nWidget,!1)));this.__OnDnDAnnule(n,u)},t.prototype=new WDDnDNatif,t.prototype.constructor=t,t.prototype._vnGetOperationSurDrop=function(n){var i=this.ms_oDnDSource,r;return!(i instanceof t)||this.m_oTdbModeEdition!==i.m_oTdbModeEdition?(this.m_oTdbModeEdition.OnOperationSurDropSans(i,this),this.ms_nOperationSans):(r=this._voGetOffsetAction(),this._bDropPossible(n,r)&&(this.m_oOffsetDernierDnDDest=r,!this.m_oTdbModeEdition.bColonneValidePourLargeur(i,this)))?(this.m_oTdbModeEdition.OnOperationSurDropSans(i,this),this.ms_nOperationSans):WDDnDNatif.prototype._vnGetOperationSurDrop.apply(this,arguments)},t.prototype._vOnDragExit=function(){this.m_oTdbModeEdition.OnDragExit(this.ms_oDnDSource,this);delete this.m_oOffsetDernierDnDDest;WDDnDNatif.prototype._vOnDragExit.apply(this,arguments)},t.prototype._vOnDrop=function(){WDDnDNatif.prototype._vOnDrop.apply(this,arguments);this.m_oTdbModeEdition.OnDrop(this.ms_oDnDSource,this)},t.prototype._vbEmuleIE9=function(){return bIE&&nIE<10},t.prototype.vAffiche=function(n,t,i,r){this.m_oElement.className=this.m_sModeleClasses+" "+tt(!1,n,t,i,r);clWDUtil.SetDisplay(this.m_oElement,!0);this.m_bVisible=!0;this.m_nLigne=n;this.m_nColonne=t;this.m_nLargeur=i;this.m_nHauteur=r},t.prototype.vMasque=function(){clWDUtil.SetDisplay(this.m_oElement,!1)},t.prototype.vLibereElement=function(){this._LibereElement(this.m_oElementDnD);clWDUtil.oSupprimeElement(this.m_oElement);delete this.m_oElementDnD;delete this.m_oElement},t.prototype._bDropPossible=function(n,t){var i=this.ms_oDnDSource;if(this!==i||this.ms_nDnDSortieChamp==n)return!0;var r=i.m_oOffsetDernierDnDSrc,e=r.m_nCelluleX,o=r.m_nCelluleY,u=t.m_nCelluleX,f=t.m_nCelluleY;return-1!=u&&-1!=f&&(e!=u||o!=f)?!0:!1},t.prototype._oGetOffsetAction=function(n,t){var r=this._oGetEvent(),u=this.m_oElement,f=this.m_oTdbModeEdition.m_oTdb,i=f.m_oParametres,e=rt(this.oGetOffsetElementSiAutre(r,u,!1),n,f.m_nTaille1CaseXEffective,i.m_nMargeX),o=rt(this.oGetOffsetElementSiAutre(r,u,!0),t,i.m_nTaille1CaseY,i.m_nMargeY);return{m_nCelluleX:e,m_nCelluleY:o}},r.prototype=new t,r.prototype.constructor=r,ut=["wbTdbHG","wbTdbH","wbTdbHD","wbTdbD","wbTdbBD","wbTdbB","wbTdbBG","wbTdbG"],ft=["SE-resize","N-resize","NE-resize","E-resize","SE-resize","N-resize","NE-resize","E-resize"],r.prototype._vSetDonneesDnD=function(){t.prototype._vSetDonneesDnD.apply(this,arguments);this._SetEventDataSelonTypeAvecCorrection(this.ms_tabTypes[0],this.m_nWidget+"");this.m_oOffsetDernierDnDSrc=this._voGetOffsetAction()},r.prototype._vOnDragEnd=function(){t.prototype._vOnDragEnd.apply(this,arguments);delete this.m_oOffsetDernierDnDSrc;delete this.m_oOffsetDernierDnDDest},r.prototype._vnOnDragSurvol=function(n,i){return i=t.prototype._vnOnDragSurvol.apply(this,arguments),this._bDropPossible(n,this._voGetOffsetAction())&&this.m_oTdbModeEdition.OnDragSurvol(this.ms_oDnDSource,this),i},r.prototype.vAffiche=function(n,i,r,u,f){if(t.prototype.vAffiche.apply(this,arguments),!f&&this.m_bRedimensionne){var h=this.m_oTdbModeEdition.m_oTdb,c=h.m_oParametres,e=c.m_nMargeX+h.m_nTaille1CaseXEffective,s=c.m_nMargeY+c.m_nTaille1CaseY,l=o(-i,r-1,!1,e,s),a=o(-n,u-1,!1,e,s),v=o(1-r,h.m_nNbColonnesEffectif-i-r,!0,e,s),y=o(1-u,1024,!0,e,s);this.__AttacheUnRedimensionnement(0,l,a);this.__AttacheUnRedimensionnement(1,null,a);this.__AttacheUnRedimensionnement(2,v,a);this.__AttacheUnRedimensionnement(3,v,null);this.__AttacheUnRedimensionnement(4,v,y);this.__AttacheUnRedimensionnement(5,null,y);this.__AttacheUnRedimensionnement(6,l,y);this.__AttacheUnRedimensionnement(7,l,null)}},r.prototype.vMasque=function(){this.__DetacheRedimensionnement();t.prototype.vMasque.apply(this,arguments)},r.prototype.vLibereElement=function(){this.__DetacheRedimensionnement();t.prototype.vLibereElement.apply(this,arguments)},r.prototype._voGetOffsetAction=function(){var n=this.m_oTdbModeEdition.m_tabAffichageCourant[this.m_nWidget];return this._oGetOffsetAction(n.m_nLargeur,n.m_nHauteur)},r.prototype.__AttacheUnRedimensionnement=function(n,t,i){var r=this.m_tabRedimensionnement[n],f,e,u,o;if(r.m_oDiv&&!r.m_fMouseDown){if(f=!!t,e=!!i,f&&e)u=n;else if(f)u=3;else if(e)u=1;else{r.m_oDiv.style.cursor="auto";return}o=ft[u];r.m_oDiv.style.cursor=o;r.m_fMouseDown=this.m_oTdbModeEdition.fAttacheUnRedimensionnement(r.m_oDiv,this.m_nWidget,t,i,o)}},r.prototype.__DetacheRedimensionnement=function(){var n=this.m_oTdbModeEdition;clWDUtil.bForEach(this.m_tabRedimensionnement,function(t){return t.m_fMouseDown?(n.DetacheUnRedimensionnement(t.m_oDiv,t.m_fMouseDown),t.m_fMouseDown=null):t.m_oDiv&&(t.m_oDiv.style.cursor=""),!0})},f.prototype=new t,f.prototype.constructor=f,f.prototype._vnOnDragSurvol=function(n,i){return i=t.prototype._vnOnDragSurvol.apply(this,arguments),this.ms_nDnDEntreeChamp==n&&this.m_oTdbModeEdition.OnDragSurvol(this.ms_oDnDSource,this),i},f.prototype._voGetOffsetAction=function(){return this._oGetOffsetAction(1,1)},n}()